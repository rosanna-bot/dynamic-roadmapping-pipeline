<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Miro — Product Intelligence Dashboard</title>
<script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.7/dist/chart.umd.min.js"></script>
<link rel="preconnect" href="https://fonts.googleapis.com">
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&display=swap" rel="stylesheet">
<style>
  :root {
    --bg: #f5f5f0;
    --bg-white: #ffffff;
    --bg-hover: #fafaf7;
    --sidebar-bg: #ffd02f;
    --sidebar-text: #1a1a2e;
    --sidebar-active: #1a1a2e;
    --accent: #4f46e5;
    --accent-light: #6366f1;
    --accent-bg: #eef2ff;
    --green: #16a34a;
    --green-bg: #dcfce7;
    --green-text: #15803d;
    --yellow: #ca8a04;
    --yellow-bg: #fef9c3;
    --yellow-text: #a16207;
    --orange: #ea580c;
    --orange-bg: #fff7ed;
    --orange-text: #c2410c;
    --red: #dc2626;
    --red-bg: #fef2f2;
    --red-text: #b91c1c;
    --blue: #2563eb;
    --blue-bg: #eff6ff;
    --text: #1a1a2e;
    --text-secondary: #6b7280;
    --text-muted: #9ca3af;
    --border: #e5e5e0;
    --border-light: #f0f0eb;
    --radius: 12px;
    --radius-sm: 8px;
    --shadow-sm: 0 1px 2px rgba(0,0,0,0.05);
    --shadow: 0 1px 3px rgba(0,0,0,0.08), 0 1px 2px rgba(0,0,0,0.04);
    --shadow-md: 0 4px 6px -1px rgba(0,0,0,0.07), 0 2px 4px -2px rgba(0,0,0,0.05);
    --shadow-lg: 0 10px 25px -3px rgba(0,0,0,0.08), 0 4px 6px -4px rgba(0,0,0,0.04);
    --pulse-gradient: linear-gradient(135deg, #f8f7ff 0%, #fff 100%);
  }

  * { margin: 0; padding: 0; box-sizing: border-box; }

  html, body {
    height: 100%;
    background: var(--bg);
    color: var(--text);
    font-family: 'Inter', -apple-system, BlinkMacSystemFont, sans-serif;
    font-size: 14px;
    line-height: 1.5;
    -webkit-font-smoothing: antialiased;
  }

  /* ── Layout ── */
  .layout {
    display: flex;
    height: 100vh;
  }

  /* ── Sidebar ── */
  .sidebar {
    width: 240px;
    background: var(--sidebar-bg);
    color: var(--sidebar-text);
    display: flex;
    flex-direction: column;
    flex-shrink: 0;
    padding: 20px 0;
    overflow-y: auto;
  }

  .sidebar-logo {
    padding: 0 20px;
    margin-bottom: 28px;
    display: flex;
    align-items: center;
    gap: 10px;
  }

  .sidebar-logo svg {
    width: 28px;
    height: 28px;
  }

  .sidebar-logo span {
    font-size: 18px;
    font-weight: 700;
    color: #1a1a2e;
    letter-spacing: -0.3px;
  }

  .sidebar-section {
    margin-bottom: 24px;
  }

  .sidebar-section-label {
    font-size: 10px;
    font-weight: 600;
    text-transform: uppercase;
    letter-spacing: 0.8px;
    color: rgba(26,26,46,0.5);
    padding: 0 20px;
    margin-bottom: 8px;
  }

  .sidebar-item {
    display: flex;
    align-items: center;
    gap: 10px;
    padding: 8px 20px;
    font-size: 13px;
    color: var(--sidebar-text);
    cursor: pointer;
    transition: all 0.15s;
    text-decoration: none;
    position: relative;
  }

  .sidebar-item:hover {
    background: rgba(26,26,46,0.08);
    color: #1a1a2e;
  }

  .sidebar-item.active {
    background: rgba(26,26,46,0.12);
    color: #1a1a2e;
    font-weight: 600;
  }

  .sidebar-item.active::before {
    content: '';
    position: absolute;
    left: 0;
    top: 4px;
    bottom: 4px;
    width: 3px;
    background: #1a1a2e;
    border-radius: 0 3px 3px 0;
  }

  .sidebar-item svg {
    width: 18px;
    height: 18px;
    opacity: 0.6;
    flex-shrink: 0;
    color: #1a1a2e;
  }

  .sidebar-item.active svg { opacity: 0.9; }

  .sidebar-badge {
    margin-left: auto;
    background: #1a1a2e;
    color: #ffd02f;
    font-size: 10px;
    font-weight: 600;
    padding: 1px 6px;
    border-radius: 10px;
    min-width: 18px;
    text-align: center;
  }

  /* ── Main Content ── */
  .main {
    flex: 1;
    overflow-y: auto;
    padding: 0;
  }

  .main-inner {
    max-width: 1120px;
    margin: 0 auto;
    padding: 32px 40px;
  }

  /* ── Top Nav ── */
  .top-nav {
    display: flex;
    align-items: center;
    justify-content: center;
    gap: 4px;
    margin-bottom: 8px;
  }

  .top-nav-btn {
    padding: 6px 16px;
    border-radius: 20px;
    font-size: 13px;
    font-weight: 500;
    cursor: pointer;
    border: none;
    background: transparent;
    color: var(--text-secondary);
    transition: all 0.15s;
  }

  .top-nav-btn.active {
    background: var(--accent);
    color: #fff;
  }

  .top-nav-btn:hover:not(.active) {
    background: var(--border-light);
  }

  /* ── Greeting ── */
  .greeting {
    text-align: center;
    margin-bottom: 20px;
  }

  .greeting h1 {
    font-size: 24px;
    font-weight: 600;
    color: var(--text);
    letter-spacing: -0.3px;
  }

  /* ── Command Bar ── */
  .command-bar {
    display: flex;
    align-items: center;
    gap: 10px;
    max-width: 560px;
    margin: 0 auto 36px;
    padding: 12px 18px;
    background: var(--bg-white);
    border: 1px solid var(--border);
    border-radius: 28px;
    box-shadow: var(--shadow-sm);
    cursor: text;
  }

  .command-bar svg {
    width: 18px;
    height: 18px;
    color: var(--text-muted);
    flex-shrink: 0;
  }

  .command-bar span {
    color: var(--text-muted);
    font-size: 14px;
    flex: 1;
  }

  .command-bar .send-btn {
    width: 30px;
    height: 30px;
    border-radius: 50%;
    background: var(--accent);
    border: none;
    cursor: pointer;
    display: flex;
    align-items: center;
    justify-content: center;
    flex-shrink: 0;
  }

  .command-bar .send-btn svg {
    color: #fff;
    width: 14px;
    height: 14px;
  }

  /* ── Daily Pulse ── */
  .daily-pulse {
    background: var(--pulse-gradient);
    border: 1px solid var(--border);
    border-radius: var(--radius);
    padding: 24px;
    margin-bottom: 32px;
    box-shadow: var(--shadow);
  }

  .pulse-header {
    display: flex;
    align-items: center;
    gap: 8px;
    margin-bottom: 20px;
  }

  .pulse-header .spark {
    font-size: 18px;
  }

  .pulse-header h2 {
    font-size: 15px;
    font-weight: 600;
    color: var(--text);
  }

  .pulse-header .timestamp {
    margin-left: auto;
    font-size: 12px;
    color: var(--text-muted);
  }

  .pulse-grid {
    display: grid;
    grid-template-columns: 1.2fr 0.6fr 1fr;
    gap: 16px;
    align-items: start;
  }

  .pulse-card {
    background: var(--bg-white);
    border: 1px solid var(--border-light);
    border-radius: var(--radius-sm);
    padding: 18px;
    cursor: pointer;
    transition: all 0.2s;
    position: relative;
    overflow: hidden;
  }

  .pulse-card:hover {
    box-shadow: var(--shadow-md);
    border-color: var(--border);
    transform: translateY(-1px);
  }

  .pulse-card.threat {
    border-left: 3px solid var(--red);
    background: linear-gradient(135deg, #fef7f7 0%, #fff 100%);
  }

  .pulse-card.threat:hover {
    border-left-color: var(--red);
  }

  .pulse-card-label {
    display: flex;
    align-items: center;
    gap: 6px;
    font-size: 12px;
    font-weight: 600;
    text-transform: uppercase;
    letter-spacing: 0.5px;
    margin-bottom: 12px;
  }

  .pulse-card-label .icon {
    width: 20px;
    height: 20px;
    border-radius: 50%;
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 11px;
  }

  .pulse-card.threat .pulse-card-label { color: var(--red); }
  .pulse-card.threat .pulse-card-label .icon { background: var(--red-bg); }

  .threat-item {
    margin-bottom: 16px;
    padding-bottom: 16px;
    border-bottom: 1px solid var(--border-light);
  }

  .threat-item:last-child {
    margin-bottom: 0;
    padding-bottom: 0;
    border-bottom: none;
  }

  .threat-item h4 {
    font-size: 13px;
    font-weight: 600;
    color: var(--text);
    margin-bottom: 4px;
    line-height: 1.4;
  }

  .threat-item p {
    font-size: 12px;
    color: var(--text-secondary);
    line-height: 1.5;
    margin-bottom: 6px;
  }

  .threat-impact {
    display: inline-flex;
    align-items: center;
    gap: 4px;
    font-size: 11px;
    font-weight: 600;
    padding: 2px 8px;
    border-radius: 4px;
  }

  .threat-impact.high {
    background: var(--red-bg);
    color: var(--red-text);
  }

  .threat-impact.medium {
    background: var(--orange-bg);
    color: var(--orange-text);
  }

  .stat-card .stat-label {
    font-size: 12px;
    font-weight: 500;
    color: var(--text-secondary);
    margin-bottom: 6px;
  }

  .stat-card .stat-value {
    font-size: 28px;
    font-weight: 700;
    color: var(--text);
    letter-spacing: -0.5px;
    line-height: 1.2;
  }

  .stat-card .stat-change {
    font-size: 12px;
    font-weight: 500;
    margin-top: 4px;
  }

  .stat-change.positive { color: var(--green); }
  .stat-change.negative { color: var(--red); }
  .stat-change.warning { color: var(--orange); }

  .stat-sub {
    font-size: 11px;
    color: var(--text-muted);
    margin-top: 2px;
  }

  /* Stats Column (middle) */
  .pulse-stats-column {
    display: flex;
    flex-direction: column;
    gap: 12px;
  }

  .pulse-stats-column .stat-card {
    padding: 14px 18px;
  }

  .pulse-stats-column .stat-card .stat-value {
    font-size: 24px;
  }

  /* Awaiting Decision Cards */
  .decisions-card {
    display: flex;
    flex-direction: column;
  }

  .decisions-card .pulse-card-label {
    color: var(--accent);
  }

  .decision-item {
    padding: 12px;
    background: var(--bg-hover);
    border-radius: var(--radius-sm);
    margin-bottom: 10px;
    cursor: pointer;
    transition: all 0.15s;
    border: 1px solid transparent;
  }

  .decision-item:hover {
    border-color: var(--accent);
    background: var(--accent-bg);
  }

  .decision-item:last-child { margin-bottom: 0; }

  .decision-item .badge {
    display: inline-block;
    font-size: 10px;
    font-weight: 600;
    padding: 2px 6px;
    border-radius: 4px;
    background: var(--accent-bg);
    color: var(--accent);
    margin-bottom: 6px;
  }

  .decision-item h4 {
    font-size: 12px;
    font-weight: 600;
    color: var(--text);
    margin-bottom: 3px;
    line-height: 1.4;
  }

  .decision-item p {
    font-size: 11px;
    color: var(--text-secondary);
    line-height: 1.4;
  }

  .decision-item .arr-tag {
    display: inline-block;
    margin-top: 6px;
    font-size: 10px;
    font-weight: 600;
    padding: 2px 6px;
    border-radius: 4px;
    background: var(--green-bg);
    color: var(--green-text);
  }

  .pulse-action {
    display: inline-flex;
    align-items: center;
    gap: 6px;
    margin-top: 14px;
    padding: 8px 18px;
    border-radius: 20px;
    border: 1.5px solid var(--accent);
    background: transparent;
    color: var(--accent);
    font-size: 13px;
    font-weight: 500;
    cursor: pointer;
    transition: all 0.15s;
  }

  .pulse-action:hover {
    background: var(--accent);
    color: #fff;
  }

  .see-all-link {
    display: block;
    text-align: right;
    font-size: 12px;
    font-weight: 500;
    color: var(--accent);
    cursor: pointer;
    margin-top: 8px;
  }

  .see-all-link:hover { text-decoration: underline; }

  /* ── Projects Section ── */
  .projects-section {
    margin-bottom: 32px;
  }

  .projects-header {
    display: flex;
    align-items: center;
    justify-content: space-between;
    margin-bottom: 16px;
  }

  .projects-header h2 {
    font-size: 18px;
    font-weight: 600;
    color: var(--text);
  }

  .projects-tabs {
    display: flex;
    align-items: center;
    gap: 4px;
    margin-bottom: 16px;
  }

  .projects-tab {
    display: flex;
    align-items: center;
    gap: 6px;
    padding: 6px 14px;
    border-radius: 20px;
    font-size: 13px;
    font-weight: 500;
    cursor: pointer;
    border: 1px solid transparent;
    background: transparent;
    color: var(--text-secondary);
    transition: all 0.15s;
  }

  .projects-tab.active {
    background: var(--accent-bg);
    color: var(--accent);
    border-color: rgba(79,70,229,0.15);
  }

  .projects-tab:hover:not(.active) {
    background: var(--border-light);
  }

  .projects-tab svg {
    width: 14px;
    height: 14px;
  }

  .projects-actions {
    display: flex;
    align-items: center;
    gap: 8px;
  }

  .projects-search {
    width: 32px;
    height: 32px;
    border-radius: 8px;
    border: 1px solid var(--border);
    background: var(--bg-white);
    cursor: pointer;
    display: flex;
    align-items: center;
    justify-content: center;
    transition: all 0.15s;
  }

  .projects-search:hover { border-color: var(--accent); }

  .projects-search svg {
    width: 14px;
    height: 14px;
    color: var(--text-secondary);
  }

  .new-project-btn {
    display: flex;
    align-items: center;
    gap: 6px;
    padding: 7px 14px;
    border-radius: var(--radius-sm);
    background: var(--text);
    color: #fff;
    font-size: 13px;
    font-weight: 500;
    border: none;
    cursor: pointer;
    transition: all 0.15s;
  }

  .new-project-btn:hover { opacity: 0.9; }

  /* ── Project Table ── */
  .project-table {
    width: 100%;
    border-collapse: separate;
    border-spacing: 0;
    background: var(--bg-white);
    border-radius: var(--radius);
    border: 1px solid var(--border);
    overflow: hidden;
    box-shadow: var(--shadow-sm);
  }

  .project-table thead th {
    font-size: 11px;
    font-weight: 600;
    text-transform: uppercase;
    letter-spacing: 0.5px;
    color: var(--text-muted);
    padding: 12px 16px;
    text-align: left;
    border-bottom: 1px solid var(--border);
    background: var(--bg-hover);
  }

  .project-table tbody tr {
    cursor: pointer;
    transition: background 0.15s;
  }

  .project-table tbody tr:hover {
    background: var(--bg-hover);
  }

  .project-table tbody td {
    padding: 14px 16px;
    border-bottom: 1px solid var(--border-light);
    font-size: 13px;
    vertical-align: middle;
  }

  .project-table tbody tr:last-child td {
    border-bottom: none;
  }

  .project-name {
    display: flex;
    align-items: center;
    gap: 8px;
    font-weight: 500;
    color: var(--text);
  }

  .project-name .emoji { font-size: 16px; }

  .project-name .link-icon {
    width: 14px;
    height: 14px;
    opacity: 0;
    color: var(--text-muted);
    transition: opacity 0.15s;
  }

  tr:hover .project-name .link-icon { opacity: 1; }

  .health-badge {
    display: inline-flex;
    align-items: center;
    padding: 3px 10px;
    border-radius: 12px;
    font-size: 12px;
    font-weight: 500;
  }

  .health-badge.on-track { background: var(--green-bg); color: var(--green-text); }
  .health-badge.at-risk { background: var(--red-bg); color: var(--red-text); }
  .health-badge.needs-attention { background: var(--yellow-bg); color: var(--yellow-text); }
  .health-badge.blocked { background: var(--red-bg); color: var(--red-text); }

  .dri {
    display: flex;
    align-items: center;
    gap: 8px;
  }

  .dri-avatar {
    width: 24px;
    height: 24px;
    border-radius: 50%;
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 10px;
    font-weight: 600;
    color: #fff;
    flex-shrink: 0;
  }

  .dri-name {
    font-size: 13px;
    color: var(--text);
  }

  .latest-update {
    font-size: 12px;
    color: var(--text-secondary);
    max-width: 220px;
    overflow: hidden;
    text-overflow: ellipsis;
    white-space: nowrap;
  }

  .milestone-badge {
    display: inline-flex;
    align-items: center;
    padding: 3px 10px;
    border-radius: 12px;
    font-size: 11px;
    font-weight: 500;
    background: var(--bg);
    color: var(--text-secondary);
    border: 1px solid var(--border-light);
  }

  .milestone-badge.overdue {
    background: var(--red-bg);
    color: var(--red-text);
    border-color: transparent;
  }

  .milestone-badge.upcoming {
    background: var(--yellow-bg);
    color: var(--yellow-text);
    border-color: transparent;
  }

  /* ── Detail Panel (Slide-in) ── */
  .detail-overlay {
    position: fixed;
    inset: 0;
    background: rgba(0,0,0,0.3);
    z-index: 100;
    opacity: 0;
    pointer-events: none;
    transition: opacity 0.3s;
    backdrop-filter: blur(2px);
  }

  .detail-overlay.active {
    opacity: 1;
    pointer-events: all;
  }

  .detail-panel {
    position: fixed;
    top: 0;
    right: 0;
    width: 620px;
    height: 100vh;
    background: var(--bg-white);
    z-index: 101;
    transform: translateX(100%);
    transition: transform 0.35s cubic-bezier(0.4, 0, 0.2, 1);
    overflow-y: auto;
    box-shadow: -8px 0 30px rgba(0,0,0,0.1);
  }

  .detail-panel.active {
    transform: translateX(0);
  }

  .detail-header {
    position: sticky;
    top: 0;
    background: var(--bg-white);
    padding: 24px 28px;
    border-bottom: 1px solid var(--border);
    z-index: 2;
    display: flex;
    align-items: flex-start;
    justify-content: space-between;
  }

  .detail-header h2 {
    font-size: 18px;
    font-weight: 600;
    color: var(--text);
    margin-bottom: 4px;
  }

  .detail-header .detail-subtitle {
    font-size: 12px;
    color: var(--text-muted);
  }

  .detail-close {
    width: 32px;
    height: 32px;
    border-radius: 8px;
    border: 1px solid var(--border);
    background: transparent;
    cursor: pointer;
    display: flex;
    align-items: center;
    justify-content: center;
    transition: all 0.15s;
    flex-shrink: 0;
  }

  .detail-close:hover {
    background: var(--bg);
    border-color: var(--text-muted);
  }

  .detail-close svg {
    width: 16px;
    height: 16px;
    color: var(--text-secondary);
  }

  .detail-body {
    padding: 28px;
  }

  .detail-section {
    margin-bottom: 28px;
  }

  .detail-section h3 {
    font-size: 13px;
    font-weight: 600;
    text-transform: uppercase;
    letter-spacing: 0.5px;
    color: var(--text-muted);
    margin-bottom: 12px;
  }

  .detail-meta {
    display: grid;
    grid-template-columns: 1fr 1fr;
    gap: 16px;
  }

  .detail-meta-item {
    padding: 14px;
    background: var(--bg);
    border-radius: var(--radius-sm);
  }

  .detail-meta-item .label {
    font-size: 11px;
    font-weight: 500;
    color: var(--text-muted);
    margin-bottom: 4px;
  }

  .detail-meta-item .value {
    font-size: 14px;
    font-weight: 600;
    color: var(--text);
  }

  .detail-updates {
    list-style: none;
  }

  .detail-updates li {
    padding: 14px 0;
    border-bottom: 1px solid var(--border-light);
    display: flex;
    gap: 12px;
  }

  .detail-updates li:last-child { border-bottom: none; }

  .update-dot {
    width: 8px;
    height: 8px;
    border-radius: 50%;
    margin-top: 5px;
    flex-shrink: 0;
  }

  .update-dot.green { background: var(--green); }
  .update-dot.yellow { background: var(--yellow); }
  .update-dot.red { background: var(--red); }
  .update-dot.blue { background: var(--blue); }

  .update-content .update-text {
    font-size: 13px;
    color: var(--text);
    margin-bottom: 2px;
  }

  .update-content .update-date {
    font-size: 11px;
    color: var(--text-muted);
  }

  .detail-milestones {
    list-style: none;
  }

  .detail-milestones li {
    padding: 12px 14px;
    background: var(--bg);
    border-radius: var(--radius-sm);
    margin-bottom: 8px;
    display: flex;
    align-items: center;
    justify-content: space-between;
  }

  .detail-milestones li:last-child { margin-bottom: 0; }

  .milestone-name {
    font-size: 13px;
    font-weight: 500;
    color: var(--text);
  }

  .milestone-date {
    font-size: 12px;
    color: var(--text-secondary);
  }

  .milestone-status {
    font-size: 11px;
    font-weight: 600;
    padding: 2px 8px;
    border-radius: 4px;
  }

  .milestone-status.done { background: var(--green-bg); color: var(--green-text); }
  .milestone-status.in-progress { background: var(--blue-bg); color: var(--blue); }
  .milestone-status.upcoming { background: var(--bg); color: var(--text-muted); border: 1px solid var(--border); }
  .milestone-status.overdue { background: var(--red-bg); color: var(--red-text); }

  .detail-risks {
    list-style: none;
  }

  .detail-risks li {
    padding: 12px 14px;
    border-radius: var(--radius-sm);
    margin-bottom: 8px;
    border-left: 3px solid;
  }

  .detail-risks li.high { border-color: var(--red); background: var(--red-bg); }
  .detail-risks li.medium { border-color: var(--orange); background: var(--orange-bg); }
  .detail-risks li.low { border-color: var(--yellow); background: var(--yellow-bg); }

  .risk-title {
    font-size: 13px;
    font-weight: 500;
    color: var(--text);
    margin-bottom: 2px;
  }

  .risk-desc {
    font-size: 12px;
    color: var(--text-secondary);
  }

  /* ── Threat Detail Panel ── */
  .threat-detail-body {
    padding: 28px;
  }

  .threat-source {
    display: flex;
    align-items: center;
    gap: 8px;
    margin-bottom: 20px;
    padding: 12px 16px;
    background: var(--bg);
    border-radius: var(--radius-sm);
  }

  .threat-source-label {
    font-size: 11px;
    font-weight: 600;
    color: var(--text-muted);
    text-transform: uppercase;
    letter-spacing: 0.5px;
  }

  .threat-source-value {
    font-size: 13px;
    font-weight: 500;
    color: var(--text);
  }

  .threat-summary {
    font-size: 14px;
    color: var(--text);
    line-height: 1.7;
    margin-bottom: 24px;
  }

  .threat-actions {
    display: flex;
    gap: 8px;
    margin-top: 20px;
  }

  .threat-action-btn {
    padding: 8px 16px;
    border-radius: var(--radius-sm);
    font-size: 13px;
    font-weight: 500;
    cursor: pointer;
    border: 1px solid var(--border);
    background: var(--bg-white);
    color: var(--text);
    transition: all 0.15s;
  }

  .threat-action-btn.primary {
    background: var(--accent);
    color: #fff;
    border-color: var(--accent);
  }

  .threat-action-btn:hover { opacity: 0.85; }

  /* ── Slack Pills ── */
  .slack-pills {
    display: flex;
    flex-wrap: wrap;
    gap: 8px;
    margin-top: 10px;
  }

  .slack-pill {
    display: inline-flex;
    align-items: center;
    gap: 7px;
    padding: 6px 14px 6px 8px;
    border-radius: 20px;
    background: var(--bg-white);
    border: 1px solid var(--border);
    cursor: pointer;
    transition: all 0.2s;
    text-decoration: none;
    color: var(--text);
    font-size: 13px;
    font-weight: 500;
  }

  .slack-pill:hover {
    border-color: #611f69;
    background: #f9f0fb;
    box-shadow: 0 2px 8px rgba(97, 31, 105, 0.1);
    transform: translateY(-1px);
  }

  .slack-pill .slack-icon {
    width: 18px;
    height: 18px;
    flex-shrink: 0;
  }

  .slack-pill .pill-avatar {
    width: 22px;
    height: 22px;
    border-radius: 50%;
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 9px;
    font-weight: 700;
    color: #fff;
    flex-shrink: 0;
  }

  .slack-pill .pill-info {
    display: flex;
    flex-direction: column;
    line-height: 1.2;
  }

  .slack-pill .pill-name {
    font-size: 12px;
    font-weight: 600;
    color: var(--text);
  }

  .slack-pill .pill-role {
    font-size: 10px;
    color: var(--text-muted);
    font-weight: 400;
  }

  .slack-pill .pill-arrow {
    margin-left: 4px;
    color: var(--text-muted);
    font-size: 12px;
    transition: transform 0.15s;
  }

  .slack-pill:hover .pill-arrow {
    transform: translateX(2px);
    color: #611f69;
  }

  .slack-channel-pill {
    background: #f9f0fb;
    border-color: #d4a5db;
  }

  .slack-channel-pill:hover {
    background: #f0ddf4;
  }

  .slack-channel-pill .channel-hash {
    font-size: 14px;
    font-weight: 700;
    color: #611f69;
  }

  /* ── NPS Chart ── */
  .nps-chart-container {
    background: var(--bg-white);
    border: 1px solid var(--border-light);
    border-radius: var(--radius-sm);
    padding: 20px;
    margin-bottom: 20px;
  }

  .nps-chart-header {
    display: flex;
    align-items: center;
    justify-content: space-between;
    margin-bottom: 16px;
  }

  .nps-chart-header h4 {
    font-size: 13px;
    font-weight: 600;
    color: var(--text);
  }

  .nps-chart-legend {
    display: flex;
    gap: 16px;
    font-size: 11px;
    color: var(--text-muted);
  }

  .nps-chart-legend span {
    display: flex;
    align-items: center;
    gap: 4px;
  }

  .nps-chart-legend .dot {
    width: 8px;
    height: 8px;
    border-radius: 50%;
  }

  .chart-svg {
    width: 100%;
    overflow: visible;
  }

  .nps-source-tag {
    display: inline-flex;
    align-items: center;
    gap: 5px;
    font-size: 11px;
    color: var(--text-muted);
    background: var(--bg);
    border: 1px solid var(--border-light);
    padding: 4px 10px;
    border-radius: 12px;
    margin-top: 12px;
  }

  .nps-source-tag svg {
    width: 12px;
    height: 12px;
  }

  /* ── Hypothesis Cards ── */
  .hypothesis-card {
    padding: 16px;
    background: var(--bg);
    border-radius: var(--radius-sm);
    margin-bottom: 10px;
    border-left: 3px solid;
    position: relative;
  }

  .hypothesis-card.strong { border-left-color: var(--green); }
  .hypothesis-card.moderate { border-left-color: var(--blue); }
  .hypothesis-card.emerging { border-left-color: var(--yellow); }

  .hypothesis-confidence {
    display: inline-flex;
    align-items: center;
    gap: 4px;
    font-size: 10px;
    font-weight: 600;
    text-transform: uppercase;
    letter-spacing: 0.5px;
    padding: 2px 8px;
    border-radius: 4px;
    margin-bottom: 8px;
  }

  .hypothesis-confidence.strong { background: var(--green-bg); color: var(--green-text); }
  .hypothesis-confidence.moderate { background: var(--blue-bg); color: var(--blue); }
  .hypothesis-confidence.emerging { background: var(--yellow-bg); color: var(--yellow-text); }

  .hypothesis-card h4 {
    font-size: 13px;
    font-weight: 600;
    color: var(--text);
    margin-bottom: 4px;
  }

  .hypothesis-card p {
    font-size: 12px;
    color: var(--text-secondary);
    line-height: 1.6;
  }

  .hypothesis-evidence {
    margin-top: 8px;
    font-size: 11px;
    color: var(--text-muted);
    font-style: italic;
  }

  /* ── Slipped Project Card ── */
  .slip-card {
    padding: 18px;
    background: var(--bg-white);
    border: 1px solid var(--border-light);
    border-radius: var(--radius-sm);
    margin-bottom: 12px;
    border-left: 3px solid var(--red);
  }

  .slip-card-header {
    display: flex;
    align-items: center;
    justify-content: space-between;
    margin-bottom: 8px;
  }

  .slip-card-header h4 {
    font-size: 14px;
    font-weight: 600;
    color: var(--text);
    display: flex;
    align-items: center;
    gap: 8px;
  }

  .slip-badge {
    font-size: 10px;
    font-weight: 600;
    padding: 2px 8px;
    border-radius: 4px;
    background: var(--red-bg);
    color: var(--red-text);
  }

  .slip-card p {
    font-size: 13px;
    color: var(--text-secondary);
    line-height: 1.6;
    margin-bottom: 8px;
  }

  .slip-card .slip-reason {
    font-size: 12px;
    color: var(--text);
    background: var(--red-bg);
    padding: 10px 14px;
    border-radius: var(--radius-sm);
    margin-bottom: 12px;
    line-height: 1.5;
  }

  .slip-card .slip-reason strong {
    color: var(--red-text);
  }

  .slip-suggestion {
    font-size: 12px;
    color: var(--text-secondary);
    margin-bottom: 6px;
    font-weight: 500;
  }

  /* ── Data Source Cards ── */
  .data-source-card {
    padding: 14px 16px;
    background: var(--bg-white);
    border: 1px solid var(--border-light);
    border-radius: var(--radius-sm);
    margin-bottom: 8px;
    display: flex;
    align-items: center;
    gap: 12px;
    transition: all 0.15s;
  }

  .data-source-card:hover {
    border-color: var(--border);
    box-shadow: var(--shadow-sm);
  }

  .data-source-icon {
    width: 36px;
    height: 36px;
    border-radius: 8px;
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 16px;
    flex-shrink: 0;
  }

  .data-source-info {
    flex: 1;
  }

  .data-source-info .ds-name {
    font-size: 13px;
    font-weight: 600;
    color: var(--text);
  }

  .data-source-info .ds-detail {
    font-size: 11px;
    color: var(--text-muted);
    margin-top: 2px;
  }

  .data-source-status {
    font-size: 10px;
    font-weight: 600;
    padding: 3px 8px;
    border-radius: 4px;
    flex-shrink: 0;
  }

  .data-source-status.live {
    background: var(--green-bg);
    color: var(--green-text);
  }

  .data-source-status.synced {
    background: var(--blue-bg);
    color: var(--blue);
  }

  .data-source-status.manual {
    background: var(--bg);
    color: var(--text-muted);
    border: 1px solid var(--border);
  }

  .budget-bar-container {
    margin-bottom: 6px;
  }

  .budget-bar-label {
    display: flex;
    justify-content: space-between;
    font-size: 12px;
    margin-bottom: 4px;
  }

  .budget-bar-label .bb-name {
    font-weight: 500;
    color: var(--text);
  }

  .budget-bar-label .bb-amount {
    color: var(--text-secondary);
  }

  .budget-bar {
    height: 8px;
    background: var(--border-light);
    border-radius: 4px;
    overflow: hidden;
  }

  .budget-bar-fill {
    height: 100%;
    border-radius: 4px;
    transition: width 0.6s ease;
  }

  /* ── Threat Filter ── */
  .threat-filter-bar {
    display: flex;
    align-items: center;
    gap: 8px;
    margin-bottom: 14px;
    flex-wrap: wrap;
  }

  .filter-toggle-btn {
    display: inline-flex;
    align-items: center;
    gap: 5px;
    padding: 5px 12px;
    border-radius: 16px;
    border: 1px solid var(--border);
    background: var(--bg-white);
    font-size: 12px;
    font-weight: 500;
    color: var(--text-secondary);
    cursor: pointer;
    transition: all 0.15s;
    position: relative;
  }

  .filter-toggle-btn:hover {
    border-color: var(--accent);
    color: var(--accent);
  }

  .filter-toggle-btn.has-filters {
    border-color: var(--accent);
    background: var(--accent-bg);
    color: var(--accent);
  }

  .filter-toggle-btn svg {
    width: 13px;
    height: 13px;
  }

  .filter-count {
    display: inline-flex;
    align-items: center;
    justify-content: center;
    width: 16px;
    height: 16px;
    border-radius: 50%;
    background: var(--accent);
    color: #fff;
    font-size: 9px;
    font-weight: 700;
  }

  .filter-dropdown {
    position: absolute;
    top: calc(100% + 6px);
    left: 0;
    background: var(--bg-white);
    border: 1px solid var(--border);
    border-radius: var(--radius-sm);
    box-shadow: var(--shadow-lg);
    padding: 8px 0;
    min-width: 240px;
    z-index: 50;
    display: none;
  }

  .filter-dropdown.open {
    display: block;
  }

  .filter-dropdown-header {
    display: flex;
    align-items: center;
    justify-content: space-between;
    padding: 6px 14px 10px;
    border-bottom: 1px solid var(--border-light);
    margin-bottom: 4px;
  }

  .filter-dropdown-header span {
    font-size: 11px;
    font-weight: 600;
    text-transform: uppercase;
    letter-spacing: 0.5px;
    color: var(--text-muted);
  }

  .filter-clear-btn {
    font-size: 11px;
    font-weight: 500;
    color: var(--accent);
    background: none;
    border: none;
    cursor: pointer;
    padding: 0;
  }

  .filter-clear-btn:hover { text-decoration: underline; }

  .filter-option {
    display: flex;
    align-items: center;
    gap: 10px;
    padding: 7px 14px;
    cursor: pointer;
    transition: background 0.1s;
    font-size: 13px;
    color: var(--text);
    user-select: none;
  }

  .filter-option:hover {
    background: var(--bg-hover);
  }

  .filter-checkbox {
    width: 16px;
    height: 16px;
    border-radius: 4px;
    border: 1.5px solid var(--border);
    display: flex;
    align-items: center;
    justify-content: center;
    flex-shrink: 0;
    transition: all 0.15s;
  }

  .filter-checkbox.checked {
    background: var(--accent);
    border-color: var(--accent);
  }

  .filter-checkbox.checked::after {
    content: '✓';
    color: #fff;
    font-size: 10px;
    font-weight: 700;
  }

  .filter-option-icon {
    font-size: 14px;
  }

  .active-filters {
    display: flex;
    align-items: center;
    gap: 6px;
    flex-wrap: wrap;
  }

  .active-filter-chip {
    display: inline-flex;
    align-items: center;
    gap: 4px;
    padding: 3px 10px 3px 8px;
    border-radius: 12px;
    background: var(--accent-bg);
    color: var(--accent);
    font-size: 11px;
    font-weight: 500;
    cursor: default;
  }

  .active-filter-chip .chip-remove {
    cursor: pointer;
    font-size: 12px;
    line-height: 1;
    opacity: 0.6;
    transition: opacity 0.15s;
    margin-left: 2px;
  }

  .active-filter-chip .chip-remove:hover { opacity: 1; }

  .threat-category-tag {
    display: inline-flex;
    align-items: center;
    gap: 3px;
    font-size: 10px;
    font-weight: 500;
    padding: 2px 7px;
    border-radius: 4px;
    background: var(--bg);
    color: var(--text-muted);
    border: 1px solid var(--border-light);
    margin-right: 4px;
    margin-bottom: 4px;
  }

  .threat-item-container {
    transition: all 0.25s ease;
  }

  .threat-item-container.hidden {
    display: none;
  }

  .threat-empty-state {
    padding: 24px 16px;
    text-align: center;
    color: var(--text-muted);
    font-size: 13px;
    display: none;
  }

  .threat-empty-state.visible {
    display: block;
  }

  /* ── Screenshot Carousel ── */
  .carousel {
    position: relative;
    border-radius: var(--radius-sm);
    overflow: hidden;
    background: #f8f8f6;
    border: 1px solid var(--border-light);
    margin-bottom: 20px;
  }

  .carousel-track {
    display: flex;
    transition: transform 0.4s cubic-bezier(0.4, 0, 0.2, 1);
  }

  .carousel-slide {
    min-width: 100%;
    position: relative;
  }

  .carousel-slide img {
    width: 100%;
    height: 280px;
    object-fit: cover;
    display: block;
  }

  .carousel-slide .slide-caption {
    padding: 10px 14px;
    font-size: 12px;
    color: var(--text-secondary);
    background: var(--bg-white);
    border-top: 1px solid var(--border-light);
  }

  .carousel-btn {
    position: absolute;
    top: 50%;
    transform: translateY(calc(-50% - 16px));
    width: 34px;
    height: 34px;
    border-radius: 50%;
    background: rgba(255,255,255,0.92);
    border: 1px solid var(--border);
    cursor: pointer;
    display: flex;
    align-items: center;
    justify-content: center;
    z-index: 3;
    box-shadow: var(--shadow-md);
    transition: all 0.15s;
  }

  .carousel-btn:hover {
    background: #fff;
    box-shadow: var(--shadow-lg);
    transform: translateY(calc(-50% - 16px)) scale(1.05);
  }

  .carousel-btn.prev { left: 10px; }
  .carousel-btn.next { right: 10px; }

  .carousel-btn svg {
    width: 16px;
    height: 16px;
    color: var(--text);
  }

  .carousel-dots {
    display: flex;
    justify-content: center;
    gap: 6px;
    padding: 10px 0;
    background: var(--bg-white);
  }

  .carousel-dot {
    width: 7px;
    height: 7px;
    border-radius: 50%;
    background: var(--border);
    cursor: pointer;
    transition: all 0.2s;
  }

  .carousel-dot.active {
    background: var(--accent);
    width: 20px;
    border-radius: 4px;
  }

  /* ── Resource Links ── */
  .resource-links {
    list-style: none;
    margin: 0;
    padding: 0;
  }

  .resource-link {
    display: flex;
    align-items: center;
    gap: 12px;
    padding: 12px 14px;
    border-radius: var(--radius-sm);
    border: 1px solid var(--border-light);
    margin-bottom: 8px;
    text-decoration: none;
    color: var(--text);
    transition: all 0.15s;
    cursor: pointer;
  }

  .resource-link:hover {
    border-color: var(--accent);
    background: var(--accent-bg);
    transform: translateX(2px);
  }

  .resource-link-icon {
    width: 32px;
    height: 32px;
    border-radius: 6px;
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 15px;
    flex-shrink: 0;
  }

  .resource-link-icon.press { background: #fef2f2; }
  .resource-link-icon.blog { background: #eff6ff; }
  .resource-link-icon.docs { background: #f0fdf4; }
  .resource-link-icon.video { background: #fdf4ff; }
  .resource-link-icon.product { background: #fff7ed; }

  .resource-link-info {
    flex: 1;
    min-width: 0;
  }

  .resource-link-title {
    font-size: 13px;
    font-weight: 500;
    color: var(--text);
    margin-bottom: 1px;
  }

  .resource-link-meta {
    font-size: 11px;
    color: var(--text-muted);
  }

  .resource-link-arrow {
    color: var(--text-muted);
    font-size: 14px;
    flex-shrink: 0;
    transition: transform 0.15s;
  }

  .resource-link:hover .resource-link-arrow {
    transform: translateX(3px);
    color: var(--accent);
  }

  .back-to-all {
    display: inline-flex;
    align-items: center;
    gap: 4px;
    font-size: 12px;
    font-weight: 500;
    color: var(--accent);
    cursor: pointer;
    margin-bottom: 16px;
    padding: 4px 0;
  }

  .back-to-all:hover { text-decoration: underline; }

  /* Animations */
  @keyframes fadeIn {
    from { opacity: 0; transform: translateY(8px); }
    to { opacity: 1; transform: translateY(0); }
  }

  .daily-pulse { animation: fadeIn 0.4s ease; }
  .projects-section { animation: fadeIn 0.5s ease 0.1s both; }

  /* ── Pulse Analytics Page ── */
  .pulse-analytics-view { display: none; }
  .pulse-analytics-view.active { display: block; animation: fadeIn 0.4s ease; }
  .home-view.active { display: block; }
  .home-view { display: none; }

  .pa-tldr {
    background: linear-gradient(135deg, #6C5CE7 0%, #8B5CF6 50%, #A78BFA 100%);
    border-radius: var(--radius);
    padding: 28px 32px;
    margin-bottom: 28px;
    color: #fff;
    position: relative;
    overflow: hidden;
  }
  .pa-tldr::before {
    content: '✦';
    position: absolute;
    top: -20px;
    right: -10px;
    font-size: 120px;
    opacity: 0.08;
  }
  .pa-tldr-header {
    display: flex;
    align-items: center;
    gap: 10px;
    margin-bottom: 16px;
  }
  .pa-tldr-header h2 {
    font-size: 16px;
    font-weight: 700;
    color: #fff;
  }
  .pa-tldr-header .pa-date {
    margin-left: auto;
    font-size: 12px;
    opacity: 0.7;
  }
  .pa-tldr-body {
    display: flex;
    flex-direction: column;
    gap: 10px;
  }
  .pa-tldr-item {
    display: flex;
    align-items: flex-start;
    gap: 10px;
    font-size: 13px;
    line-height: 1.55;
  }
  .pa-tldr-item .pa-icon {
    flex-shrink: 0;
    width: 22px;
    height: 22px;
    border-radius: 50%;
    background: rgba(255,255,255,0.18);
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 11px;
    margin-top: 1px;
  }

  /* Charts Section */
  .pa-section-title {
    font-size: 15px;
    font-weight: 700;
    color: var(--text);
    margin-bottom: 16px;
    display: flex;
    align-items: center;
    gap: 8px;
  }
  .pa-section-title .pa-live-dot {
    width: 8px;
    height: 8px;
    border-radius: 50%;
    background: #10b981;
    animation: livePulse 2s ease infinite;
  }
  @keyframes livePulse {
    0%, 100% { opacity: 1; }
    50% { opacity: 0.4; }
  }
  .pa-section-title .pa-live-label {
    font-size: 11px;
    font-weight: 500;
    color: #10b981;
    text-transform: uppercase;
    letter-spacing: 0.5px;
  }

  .pa-charts-grid {
    display: grid;
    grid-template-columns: 1fr 1fr;
    gap: 20px;
    margin-bottom: 32px;
  }

  .pa-chart-card {
    background: var(--bg-white);
    border: 1px solid var(--border-light);
    border-radius: var(--radius-sm);
    padding: 20px;
    box-shadow: var(--shadow-sm);
  }
  .pa-chart-card h3 {
    font-size: 13px;
    font-weight: 600;
    color: var(--text);
    margin-bottom: 4px;
  }
  .pa-chart-card .pa-chart-sub {
    font-size: 11px;
    color: var(--text-muted);
    margin-bottom: 16px;
  }
  .pa-chart-container {
    height: 220px;
    position: relative;
  }
  .pa-chart-container canvas {
    width: 100% !important;
    height: 100% !important;
  }

  /* Feedback Section */
  .pa-feedback-grid {
    display: grid;
    grid-template-columns: 1fr 1fr;
    gap: 20px;
    margin-bottom: 28px;
  }

  .pa-feedback-card {
    background: var(--bg-white);
    border: 1px solid var(--border-light);
    border-radius: var(--radius-sm);
    padding: 20px;
    box-shadow: var(--shadow-sm);
  }

  .pa-fb-header {
    display: flex;
    align-items: center;
    justify-content: space-between;
    margin-bottom: 16px;
  }
  .pa-fb-header h3 {
    font-size: 13px;
    font-weight: 600;
    color: var(--text);
  }
  .pa-fb-rating {
    display: flex;
    align-items: center;
    gap: 6px;
  }
  .pa-fb-rating .pa-stars {
    color: #f59e0b;
    font-size: 14px;
    letter-spacing: 1px;
  }
  .pa-fb-rating .pa-score {
    font-size: 20px;
    font-weight: 700;
    color: var(--text);
  }
  .pa-fb-rating .pa-total {
    font-size: 11px;
    color: var(--text-muted);
  }
  .pa-fb-section-label {
    font-size: 11px;
    font-weight: 600;
    text-transform: uppercase;
    letter-spacing: 0.5px;
    margin-bottom: 8px;
    display: flex;
    align-items: center;
    gap: 6px;
  }
  .pa-fb-section-label.liked { color: #10b981; }
  .pa-fb-section-label.lacked { color: #ef4444; }

  .pa-fb-theme {
    font-size: 12px;
    color: var(--text-secondary);
    line-height: 1.5;
    padding: 8px 10px;
    background: var(--bg-hover);
    border-radius: 6px;
    margin-bottom: 6px;
  }
  .pa-fb-theme strong {
    color: var(--text);
    font-weight: 600;
  }
  .pa-fb-divider {
    height: 1px;
    background: var(--border-light);
    margin: 14px 0;
  }

  /* MAU Tiles */
  .pa-mau-grid {
    display: grid;
    grid-template-columns: repeat(4, 1fr);
    gap: 16px;
    margin-bottom: 28px;
  }
  .pa-mau-tile {
    background: var(--bg-white);
    border: 1px solid var(--border-light);
    border-radius: var(--radius-sm);
    padding: 18px 20px;
    box-shadow: var(--shadow-sm);
  }
  .pa-mau-tile h4 {
    font-size: 11px;
    font-weight: 600;
    text-transform: uppercase;
    letter-spacing: 0.4px;
    color: var(--text-secondary);
    margin-bottom: 6px;
  }
  .pa-mau-big {
    font-size: 28px;
    font-weight: 800;
    color: var(--text);
    letter-spacing: -0.5px;
    line-height: 1.1;
    margin-bottom: 8px;
  }
  .pa-mau-delta {
    font-size: 11px;
    line-height: 1.6;
    color: var(--text-muted);
  }
  .pa-mau-delta .up { color: #10b981; font-weight: 600; }
  .pa-mau-delta .down { color: #ef4444; font-weight: 600; }

  /* Recommendations Section */
  .pa-recs {
    background: linear-gradient(135deg, #fef3c7 0%, #fff7ed 100%);
    border: 1px solid #fcd34d;
    border-radius: var(--radius-sm);
    padding: 20px 24px;
    margin-bottom: 28px;
  }
  .pa-recs-header {
    display: flex;
    align-items: center;
    gap: 8px;
    margin-bottom: 14px;
    font-size: 14px;
    font-weight: 700;
    color: #92400e;
  }
  .pa-rec-item {
    display: flex;
    gap: 10px;
    font-size: 13px;
    line-height: 1.55;
    color: #78350f;
    margin-bottom: 8px;
  }
  .pa-rec-item:last-child { margin-bottom: 0; }
  .pa-rec-item .pa-rec-num {
    flex-shrink: 0;
    width: 22px;
    height: 22px;
    border-radius: 50%;
    background: #f59e0b;
    color: #fff;
    font-size: 11px;
    font-weight: 700;
    display: flex;
    align-items: center;
    justify-content: center;
    margin-top: 1px;
  }

  /* Feedback Theme Clickable */
  .pa-fb-theme.clickable {
    cursor: pointer;
    transition: all 0.15s;
  }
  .pa-fb-theme.clickable:hover {
    background: var(--border-light);
    border-left: 3px solid var(--accent);
    padding-left: 7px;
  }

  /* Market Signals Page */
  .market-signals-view { display: none; }
  .market-signals-view.active { display: block; animation: fadeIn 0.4s ease; }

  .ms-filter-bar {
    display: flex;
    align-items: center;
    gap: 8px;
    margin-bottom: 20px;
    flex-wrap: wrap;
  }
  .ms-filter-chip {
    padding: 5px 14px;
    border-radius: 20px;
    font-size: 12px;
    font-weight: 500;
    cursor: pointer;
    border: 1px solid var(--border);
    background: var(--bg-white);
    color: var(--text-secondary);
    transition: all 0.15s;
  }
  .ms-filter-chip:hover { border-color: var(--accent); color: var(--accent); }
  .ms-filter-chip.active {
    background: var(--accent);
    color: #fff;
    border-color: var(--accent);
  }

  /* Feature Comparison Table */
  .ms-comparison-table {
    width: 100%;
    border-collapse: collapse;
    font-size: 12px;
    margin-bottom: 28px;
  }
  .ms-comparison-table th {
    text-align: left;
    padding: 10px 12px;
    background: var(--bg-hover);
    font-weight: 600;
    font-size: 11px;
    text-transform: uppercase;
    letter-spacing: 0.3px;
    color: var(--text-secondary);
    border-bottom: 2px solid var(--border);
    position: sticky;
    top: 0;
  }
  .ms-comparison-table td {
    padding: 12px;
    border-bottom: 1px solid var(--border-light);
    vertical-align: top;
    line-height: 1.5;
    color: var(--text-secondary);
  }
  .ms-comparison-table tr:hover td {
    background: var(--bg-hover);
  }
  .ms-comparison-table .comp-name {
    font-weight: 600;
    color: var(--text);
    white-space: nowrap;
  }
  .ms-comparison-table a {
    color: var(--accent);
    text-decoration: none;
    font-size: 11px;
  }
  .ms-comparison-table a:hover { text-decoration: underline; }
  .ms-link-pill {
    display: inline-flex;
    align-items: center;
    gap: 3px;
    padding: 2px 8px;
    border-radius: 10px;
    background: var(--accent-bg);
    color: var(--accent);
    font-size: 10px;
    font-weight: 500;
    margin: 2px 3px 2px 0;
    text-decoration: none;
    transition: all 0.12s;
  }
  .ms-link-pill:hover { background: var(--accent); color: #fff; text-decoration: none; }

  .ms-threats-grid {
    display: grid;
    grid-template-columns: 1fr 1fr;
    gap: 14px;
    margin-bottom: 28px;
  }
  .ms-threat-card {
    background: var(--bg-white);
    border: 1px solid var(--border-light);
    border-left: 3px solid var(--red);
    border-radius: var(--radius-sm);
    padding: 16px;
    cursor: pointer;
    transition: all 0.15s;
  }
  .ms-threat-card:hover {
    box-shadow: var(--shadow-md);
    transform: translateY(-1px);
  }
  .ms-threat-card h4 { font-size: 13px; font-weight: 600; color: var(--text); margin-bottom: 6px; line-height: 1.4; }
  .ms-threat-card p { font-size: 12px; color: var(--text-secondary); line-height: 1.5; margin-bottom: 8px; }

  /* Feedback drill-down in detail panel */
  .fb-drill-item {
    padding: 14px 16px;
    margin-bottom: 10px;
    background: var(--bg-hover);
    border-radius: 8px;
    border-left: 3px solid var(--border);
    font-size: 12px;
    line-height: 1.6;
  }
  .fb-drill-item.positive { border-left-color: #10b981; }
  .fb-drill-item.negative { border-left-color: #ef4444; }
  .fb-drill-meta {
    display: flex;
    align-items: center;
    gap: 8px;
    margin-bottom: 8px;
  }
  .fb-drill-score {
    display: inline-flex;
    padding: 2px 8px;
    border-radius: 6px;
    font-size: 10px;
    font-weight: 700;
  }
  .fb-drill-score.high { background: #d1fae5; color: #065f46; }
  .fb-drill-score.low { background: #fee2e2; color: #991b1b; }
  .fb-drill-date { font-size: 10px; color: var(--text-muted); }
  .fb-drill-text {
    color: var(--text);
    font-style: italic;
    position: relative;
    padding-left: 14px;
  }
  .fb-drill-text::before {
    content: '"';
    position: absolute;
    left: 0;
    top: -2px;
    font-size: 18px;
    font-weight: 700;
    color: var(--text-muted);
    font-style: normal;
  }
</style>
</head>
<body>

<div class="layout">
  <!-- Sidebar -->
  <nav class="sidebar">
    <div class="sidebar-logo">
      <svg viewBox="0 0 32 32" fill="none" xmlns="http://www.w3.org/2000/svg" width="32" height="32">
        <path d="M22.44 4H18.36L22.16 10.67L15.88 4H11.8L15.6 12L9.32 4H5.56L9.64 14.67L5 28H9.08L13.16 14.67L9.64 28H13.72L18.08 14.67L14.56 28H18.64L24.28 10.67L27 4H22.44Z" fill="#050038"/>
      </svg>
      <span>Miro PM</span>
    </div>

    <div class="sidebar-section">
      <div class="sidebar-section-label">Overview</div>
      <a class="sidebar-item active" href="#" onclick="navigateTo('home', this, event)">
        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"><path d="M3 9l9-7 9 7v11a2 2 0 01-2 2H5a2 2 0 01-2-2z"/><polyline points="9 22 9 12 15 12 15 22"/></svg>
        Home
      </a>
      <a class="sidebar-item" href="#" onclick="navigateTo('home', this, event)">
        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"><circle cx="11" cy="11" r="8"/><line x1="21" y1="21" x2="16.65" y2="16.65"/></svg>
        Intelligence Feed
        <span class="sidebar-badge">12</span>
      </a>
    </div>

    <div class="sidebar-section">
      <div class="sidebar-section-label">Signals</div>
      <a class="sidebar-item" href="#" onclick="navigateTo('market-signals', this, event)">
        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"><path d="M10.29 3.86L1.82 18a2 2 0 001.71 3h16.94a2 2 0 001.71-3L13.71 3.86a2 2 0 00-3.42 0z"/><line x1="12" y1="9" x2="12" y2="13"/><line x1="12" y1="17" x2="12.01" y2="17"/></svg>
        Market Signals
        <span class="sidebar-badge">14</span>
      </a>
      <a class="sidebar-item" href="#">
        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"><path d="M12 2L2 7l10 5 10-5-10-5z"/><path d="M2 17l10 5 10-5"/><path d="M2 12l10 5 10-5"/></svg>
        Deal Signals
        <span class="sidebar-badge">5</span>
      </a>
      <a class="sidebar-item" href="#">
        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"><circle cx="12" cy="12" r="10"/><polyline points="12 6 12 12 16 14"/></svg>
        Milestone Tracker
      </a>
    </div>

    <div class="sidebar-section">
      <div class="sidebar-section-label">Analytics</div>
      <a class="sidebar-item" href="#" onclick="navigateTo('pulse-analytics', this, event)">
        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"><path d="M22 12h-4l-3 9L9 3l-3 9H2"/></svg>
        Analytics Signals
      </a>
    </div>

    <div class="sidebar-section">
      <div class="sidebar-section-label">Portfolio</div>
      <a class="sidebar-item" href="#">
        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"><rect x="3" y="3" width="7" height="7"/><rect x="14" y="3" width="7" height="7"/><rect x="3" y="14" width="7" height="7"/><rect x="14" y="14" width="7" height="7"/></svg>
        All Projects
      </a>
      <a class="sidebar-item" href="#">
        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"><line x1="8" y1="6" x2="21" y2="6"/><line x1="8" y1="12" x2="21" y2="12"/><line x1="8" y1="18" x2="21" y2="18"/><line x1="3" y1="6" x2="3.01" y2="6"/><line x1="3" y1="12" x2="3.01" y2="12"/><line x1="3" y1="18" x2="3.01" y2="18"/></svg>
        Roadmap
      </a>
      <a class="sidebar-item" href="#">
        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"><path d="M17 21v-2a4 4 0 00-4-4H5a4 4 0 00-4-4v2"/><circle cx="9" cy="7" r="4"/><path d="M23 21v-2a4 4 0 00-3-3.87"/><path d="M16 3.13a4 4 0 010 7.75"/></svg>
        Teams
      </a>
    </div>

  </nav>

  <!-- Main Content -->
  <main class="main">
    <div class="main-inner">

    <!-- ===== HOME VIEW ===== -->
    <div class="home-view active" id="homeView">

      <!-- Top Nav -->
      <div class="top-nav">
        <button class="top-nav-btn active">For You</button>
        <button class="top-nav-btn">Activity</button>
      </div>

      <!-- Greeting -->
      <div class="greeting">
        <h1>Good morning, Rosanna!</h1>
      </div>

      <!-- Command Bar -->
      <div class="command-bar">
        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><line x1="12" y1="5" x2="12" y2="19"/><line x1="5" y1="12" x2="19" y2="12"/></svg>
        <span>Describe what you need to do...</span>
        <button class="send-btn">
          <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"><line x1="22" y1="2" x2="11" y2="13"/><polygon points="22 2 15 22 11 13 2 9 22 2"/></svg>
        </button>
      </div>

      <!-- Daily Pulse -->
      <div class="daily-pulse">
        <div class="pulse-header">
          <span class="spark">✦</span>
          <h2>Your Daily Pulse</h2>
          <span class="timestamp" id="pulseTimestamp"></span>
        </div>

        <div class="pulse-grid">
          <!-- Competitive Threats (tall left card) -->
          <div class="pulse-card threat" onclick="openThreatDetail()" id="threatCard">
            <div class="pulse-card-label" style="margin-bottom: 8px;">
              <span class="icon">⚠</span>
              Competitive Threats
            </div>

            <!-- Filter Bar -->
            <div class="threat-filter-bar" onclick="event.stopPropagation();">
              <div style="position: relative;" id="filterContainer">
                <button class="filter-toggle-btn" id="filterBtn" onclick="toggleFilterDropdown(event)">
                  <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"><polygon points="22 3 2 3 10 12.46 10 19 14 21 14 12.46 22 3"/></svg>
                  Filter
                  <span class="filter-count" id="filterCount" style="display:none;">0</span>
                </button>
                <div class="filter-dropdown" id="filterDropdown">
                  <div class="filter-dropdown-header">
                    <span>Filter by category</span>
                    <button class="filter-clear-btn" onclick="clearAllFilters(event)">Clear all</button>
                  </div>
                  <div class="filter-option" onclick="toggleFilter('diagramming', event)">
                    <span class="filter-checkbox" id="fc-diagramming"></span>
                    <span class="filter-option-icon">📐</span> Diagramming
                  </div>
                  <div class="filter-option" onclick="toggleFilter('roadmaps', event)">
                    <span class="filter-checkbox" id="fc-roadmaps"></span>
                    <span class="filter-option-icon">🗺️</span> Roadmaps
                  </div>
                  <div class="filter-option" onclick="toggleFilter('whiteboard', event)">
                    <span class="filter-checkbox" id="fc-whiteboard"></span>
                    <span class="filter-option-icon">🖊️</span> Whiteboard
                  </div>
                  <div class="filter-option" onclick="toggleFilter('prototyping', event)">
                    <span class="filter-checkbox" id="fc-prototyping"></span>
                    <span class="filter-option-icon">🎨</span> Prototyping
                  </div>
                  <div class="filter-option" onclick="toggleFilter('project-management', event)">
                    <span class="filter-checkbox" id="fc-project-management"></span>
                    <span class="filter-option-icon">📋</span> Project Management
                  </div>
                  <div class="filter-option" onclick="toggleFilter('journey-mapping', event)">
                    <span class="filter-checkbox" id="fc-journey-mapping"></span>
                    <span class="filter-option-icon">🧭</span> Customer Journey Mapping
                  </div>
                </div>
              </div>
              <div class="active-filters" id="activeFilters"></div>
            </div>

            <!-- Threat Items (rendered by JS) -->
            <div id="threatItemsContainer"></div>
            <div class="threat-empty-state" id="threatEmptyState">No threats match the selected filters.</div>

            <button class="pulse-action" onclick="event.stopPropagation(); openThreatDetail()">
              <span>✦</span> Review all threats
            </button>
          </div>

          <!-- Stats Column (middle) -->
          <div class="pulse-stats-column">
            <!-- Health -->
            <div class="pulse-card stat-card" onclick="openStatDetail('health')">
              <div class="stat-label">Portfolio Health</div>
              <div class="stat-value">72%</div>
              <div class="stat-change negative">6 At risk ↑</div>
              <div class="stat-sub">3 projects slipped this week</div>
            </div>

            <!-- NPS -->
            <div class="pulse-card stat-card" onclick="openStatDetail('nps')">
              <div class="stat-label">NPS</div>
              <div class="stat-value">+15</div>
              <div class="stat-change positive">+3pts vs Jan</div>
              <div class="stat-sub">Enterprise cohort trending +22</div>
            </div>

            <!-- Budget -->
            <div class="pulse-card stat-card" onclick="openStatDetail('budget')">
              <div class="stat-label">Budget</div>
              <div class="stat-value">81%</div>
              <div class="stat-change positive">+7pts vs Jan</div>
              <div class="stat-sub">$2.1M remaining in Q1 envelope</div>
            </div>
          </div>

          <!-- Awaiting Decision -->
          <div class="pulse-card decisions-card" onclick="openDecisionDetail()">
            <div class="pulse-card-label">
              Awaiting your decision
            </div>

            <div class="decision-item" onclick="event.stopPropagation(); openDecisionDetail('ai-diagramming')">
              <span class="badge">Priority</span>
              <h4>AI Diagramming Response: Build vs. Partner</h4>
              <p>Figma's Auto-Diagram launch requires a competitive response. Eng proposes fast-follow with Miro AI diagramming in 8 weeks.</p>
              <span class="arr-tag">$8.2M ARR at risk</span>
            </div>

            <div class="decision-item" onclick="event.stopPropagation(); openDecisionDetail('enterprise-sso')">
              <span class="badge">Blocking</span>
              <h4>Enterprise SSO: SAML vs. OIDC priority for Q2</h4>
              <p>6 enterprise deals ($3.4M combined) blocked on advanced SSO. Which protocol to ship first?</p>
              <span class="arr-tag">$3.4M ARR blocked</span>
            </div>

            <div class="decision-item" onclick="event.stopPropagation(); openDecisionDetail('pricing-tier')">
              <span class="badge">Revenue</span>
              <h4>New "Teams+" pricing tier approval</h4>
              <p>Pricing committee recommends $16/user/mo tier bridging Business and Enterprise. Finance models +$4.8M incremental ARR.</p>
              <span class="arr-tag">+$4.8M ARR potential</span>
            </div>

            <span class="see-all-link" onclick="event.stopPropagation();">See all 7 decisions →</span>
          </div>
        </div>
      </div>

      <!-- Projects Section -->
      <div class="projects-section">
        <div class="projects-header">
          <h2>Projects</h2>
          <div class="projects-actions">
            <button class="projects-search">
              <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><circle cx="11" cy="11" r="8"/><line x1="21" y1="21" x2="16.65" y2="16.65"/></svg>
            </button>
            <button class="new-project-btn">+ New project</button>
          </div>
        </div>

        <div class="projects-tabs">
          <button class="projects-tab active">
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M22 12h-4l-3 9L9 3l-3 9H2"/></svg>
            In progress
          </button>
          <button class="projects-tab">
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><rect x="3" y="3" width="7" height="7"/><rect x="14" y="3" width="7" height="7"/><rect x="3" y="14" width="7" height="7"/><rect x="14" y="14" width="7" height="7"/></svg>
            All projects
          </button>
          <button class="projects-tab">
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><line x1="4" y1="21" x2="4" y2="14"/><line x1="4" y1="10" x2="4" y2="3"/><line x1="12" y1="21" x2="12" y2="12"/><line x1="12" y1="8" x2="12" y2="3"/><line x1="20" y1="21" x2="20" y2="16"/><line x1="20" y1="12" x2="20" y2="3"/></svg>
            Timeline
          </button>
        </div>

        <table class="project-table">
          <thead>
            <tr>
              <th style="width: 25%">Project</th>
              <th style="width: 12%">Health</th>
              <th style="width: 18%">DRI</th>
              <th style="width: 28%">Latest Update</th>
              <th style="width: 17%">Next Milestone</th>
            </tr>
          </thead>
          <tbody id="projectTableBody">
          </tbody>
        </table>
      </div>

    </div><!-- /home-view -->

    <!-- ===== PULSE ANALYTICS VIEW ===== -->
    <div class="pulse-analytics-view" id="pulseAnalyticsView">

      <!-- TLDR Summary -->
      <div class="pa-tldr">
        <div class="pa-tldr-header">
          <span style="font-size:18px;">✦</span>
          <h2>Weekly Pulse — TL;DR</h2>
          <span class="pa-date">Mon 27 Jan – Sun 2 Feb 2026</span>
        </div>
        <div class="pa-tldr-body">
          <div class="pa-tldr-item">
            <span class="pa-icon">📈</span>
            <span><strong>Tables MAU 334.7K (+19.8% MoM)</strong> — post-holiday recovery complete. Tables show 45% higher retention than Kanban among enterprise users. Internal data shows "Tables & Timeline GA — FY25 Q4 end of January" is driving adoption. <a href="https://miro.com/app/board/uXjVL43-wlM=" target="_blank" style="color:var(--accent);font-size:10px;">Source: FY26-27 Table View Reviews</a></span>
          </div>
          <div class="pa-tldr-item">
            <span class="pa-icon">📊</span>
            <span><strong>New Kanban growing +34.2% MoM to 89.4K MAU.</strong> Kanban shows 9.1% multi-day engagement rate vs 5.3% for Table and 5.4% for Timeline. Growing market share: Kanban's share of new data table widgets increased from 7.5% → ~10%. Internal strategy: "We want users to use the new Kanban view to unlock deeper use cases alongside Tables and Timeline." <a href="https://miro.com/app/board/uXjVL43-wlM=" target="_blank" style="color:var(--accent);font-size:10px;">Source: FY26-27 Table View Reviews</a></span>
          </div>
          <div class="pa-tldr-item">
            <span class="pa-icon">⏳</span>
            <span><strong>Old Kanban declining: 151K MAU but -18.4% vs 6-month avg.</strong> Migration from old to new is accelerating. "GA will be considered when we reach further feature parity with the current Kanban." Current gaps: swimlanes, robust integrations, custom fields. <a href="https://miro.com/app/board/uXjVL43-wlM=" target="_blank" style="color:var(--accent);font-size:10px;">Source: FY26-27 Table View Reviews</a></span>
          </div>
          <div class="pa-tldr-item">
            <span class="pa-icon">⚠️</span>
            <span><strong>Top pain point in Timeline CSAT: 200+ grouping-related mentions.</strong> Timeline at 120K MAU (+26.4% MoM) but feedback score at 3.4/5. "Improving Grouping in Tables, Timeline, and Kanban" identified as cross-table feature. Users expected drag-and-drop columns and having fields show on cards. <a href="https://miro.com/app/board/uXjVL43-wlM=" target="_blank" style="color:var(--accent);font-size:10px;">Source: FY26-27 Table View Reviews</a></span>
          </div>
          <div class="pa-tldr-item">
            <span class="pa-icon">💡</span>
            <span><strong>Hypothesis:</strong> Tables has high volume but low satisfaction (3.3/5) because users expect spreadsheet-level formatting. Kanban card data loss is the #1 detractor — Miro customers on Slack (#kanban_feedback) consistently report content disappearing. Prototyping add-on ARR reached $1,158,850 with ~50% MoM growth — validates premium feature model. <a href="https://miro.com/app/board/uXjVJjSKukU=" target="_blank" style="color:var(--accent);font-size:10px;">Source: Prototyping initiative</a></span>
          </div>
        </div>
      </div>

      <!-- MAU Tiles -->
      <div class="pa-section-title">
        <span>Monthly Active Users — January 2026</span>
        <span class="pa-live-dot"></span>
        <span class="pa-live-label">Live from Snowflake</span>
      </div>
      <div class="pa-mau-grid">
        <div class="pa-mau-tile">
          <h4>Tables</h4>
          <div class="pa-mau-big">334.7K</div>
          <div class="pa-mau-delta">
            <span class="up">▲ 19.8%</span> vs prev month<br>
            <span class="up">▲ 8.9%</span> vs 6-month avg
          </div>
        </div>
        <div class="pa-mau-tile">
          <h4>Kanban (Old)</h4>
          <div class="pa-mau-big">151.0K</div>
          <div class="pa-mau-delta">
            <span class="up">▲ 8.7%</span> vs prev month<br>
            <span class="down">▼ 18.4%</span> vs 6-month avg
          </div>
        </div>
        <div class="pa-mau-tile">
          <h4>Kanban (New)</h4>
          <div class="pa-mau-big">89.4K</div>
          <div class="pa-mau-delta">
            <span class="up">▲ 34.2%</span> vs prev month<br>
            <span class="up">▲ 61.9%</span> vs 6-month avg
          </div>
        </div>
        <div class="pa-mau-tile">
          <h4>Timeline</h4>
          <div class="pa-mau-big">120.0K</div>
          <div class="pa-mau-delta">
            <span class="up">▲ 26.4%</span> vs prev month<br>
            <span class="up">▲ 9.5%</span> vs 6-month avg
          </div>
        </div>
      </div>

      <!-- Recommendations -->
      <div class="pa-recs" id="analyticsRecs">
        <div class="pa-recs-header">💡 Recommendations <span style="font-weight:400;font-size:11px;color:#92400e;margin-left:8px;">Sourced from Snowflake data + Miro internal docs via Glean</span></div>
        <div class="pa-rec-item"><span class="pa-rec-num">1</span><span><strong>Fix kanban card data loss bug urgently.</strong> #1 complaint on #kanban_feedback Slack channel. Card titles/content disappearing when moving between lanes is driving 1-star reviews. "Random pieces of content disappeared from the kanban records. I cannot use Miro if this continues." Fixing this could flip ~15% of detractors. <a href="https://miro.com/app/board/uXjVL43-wlM=" target="_blank" style="color:#92400e;font-size:10px;">Source</a></span></div>
        <div class="pa-rec-item"><span class="pa-rec-num">2</span><span><strong>Accelerate old→new kanban migration.</strong> Old kanban -18.4% vs 6mo avg while new kanban +61.9%. Internal strategy: "increase visibility of the new version as we plan for a future migration and sunset." Gap analysis: swimlanes, robust integrations beyond Jira, custom fields needed before GA. <a href="https://miro.com/app/board/uXjVL43-wlM=" target="_blank" style="color:#92400e;font-size:10px;">Source</a></span></div>
        <div class="pa-rec-item"><span class="pa-rec-num">3</span><span><strong>Prioritise grouping improvements across all views.</strong> Top pain point in Timeline CSAT with 200+ grouping-related mentions. "Improving Grouping in Tables, Timeline, and Kanban" is a cross-table feature — solving it lifts satisfaction across 3 features simultaneously. Monday.com-style grouping by status/pillar/owner is highly requested. <a href="https://miro.com/app/board/uXjVL43-wlM=" target="_blank" style="color:#92400e;font-size:10px;">Source</a></span></div>
        <div class="pa-rec-item"><span class="pa-rec-num">4</span><span><strong>Build the Insights-Driven Roadmapping solution.</strong> 21 enterprise accounts ($3.3M ARR) have explicit unmet roadmapping needs. "Miro can redefine roadmapping by making customer insight the engine — not the appendix — of product strategy." This defends against Productboard, Aha, and Jira PD. <a href="https://miro.com/app/board/uXjVGKHY_h0=" target="_blank" style="color:#92400e;font-size:10px;">Source</a></span></div>
        <div class="pa-rec-item"><span class="pa-rec-num">5</span><span><strong>Invest in Jira 2-way sync for Kanban.</strong> "Ford Motor Company manually translates milestones from Miro into Jira and explicitly ask for integration." Quantum Rise "loves the idea of native Miro kanban/timelines/tables plus easy guest access." Current integration feels like duplication. <a href="https://miro.com/app/board/uXjVGK1Sk-U=" target="_blank" style="color:#92400e;font-size:10px;">Source</a></span></div>
      </div>

      <!-- WAU Charts -->
      <div class="pa-section-title">
        <span>Feature WAU — Last 12 Weeks</span>
        <span class="pa-live-dot"></span>
        <span class="pa-live-label">Live from Snowflake</span>
      </div>

      <div class="pa-charts-grid">
        <div class="pa-chart-card">
          <h3>Tables (Data Table)</h3>
          <div class="pa-chart-sub">Enterprise vs Non-Enterprise WAU</div>
          <div class="pa-chart-container"><canvas id="chartTables"></canvas></div>
        </div>
        <div class="pa-chart-card">
          <h3>Kanban (Legacy + New)</h3>
          <div class="pa-chart-sub">Enterprise vs Non-Enterprise WAU</div>
          <div class="pa-chart-container"><canvas id="chartKanban"></canvas></div>
        </div>
        <div class="pa-chart-card">
          <h3>Timeline</h3>
          <div class="pa-chart-sub">Enterprise vs Non-Enterprise WAU</div>
          <div class="pa-chart-container"><canvas id="chartTimeline"></canvas></div>
        </div>
        <div class="pa-chart-card">
          <h3>Kanban New vs Legacy</h3>
          <div class="pa-chart-sub">Migration tracking — new widget adoption</div>
          <div class="pa-chart-container"><canvas id="chartKanbanMigration"></canvas></div>
        </div>
      </div>

      <!-- Feedback Section -->
      <div class="pa-section-title" style="margin-top:8px;">
        <span>In-Product Feedback — Last 90 Days</span>
        <span class="pa-live-dot"></span>
        <span class="pa-live-label">Live from Snowflake</span>
      </div>

      <div class="pa-feedback-grid">
        <!-- Tables Feedback -->
        <div class="pa-feedback-card">
          <div class="pa-fb-header">
            <h3>Tables</h3>
            <div class="pa-fb-rating">
              <span class="pa-score">3.3</span>
              <span class="pa-stars">★★★☆☆</span>
            </div>
          </div>
          <div style="font-size:11px;color:var(--text-muted);margin-bottom:14px;">10,590 responses · 5,499 positive · 5,091 negative</div>

          <div class="pa-fb-section-label liked">👍 What people liked (4-5 stars)</div>
          <div class="pa-fb-theme clickable" onclick="openFeedbackDrillDown('tables','Easy to use & intuitive','liked')"><strong>Easy to use & intuitive</strong> — Users appreciate the straightforward creation and manipulation of tables, and find the format choices powerful. <span style="color:var(--accent);font-size:10px;">→ view feedback</span></div>
          <div class="pa-fb-theme clickable" onclick="openFeedbackDrillDown('tables','Versatile viewing options','liked')"><strong>Versatile viewing options</strong> — Multiple ways to visualise information (kanban, timeline synced views) are highly valued. <span style="color:var(--accent);font-size:10px;">→ view feedback</span></div>
          <div class="pa-fb-theme clickable" onclick="openFeedbackDrillDown('tables','AI-assisted generation','liked')"><strong>AI-assisted generation</strong> — Users who discovered AI table generation love the speed of creating structured data from prompts. <span style="color:var(--accent);font-size:10px;">→ view feedback</span></div>

          <div class="pa-fb-divider"></div>

          <div class="pa-fb-section-label lacked">👎 What people lacked (1-3 stars)</div>
          <div class="pa-fb-theme clickable" onclick="openFeedbackDrillDown('tables','Limited text formatting','lacked')"><strong>Limited text formatting</strong> — No font colour, no cell background colour, no bold column headers. Users feel it's "trying to be Excel but isn't." <span style="color:var(--accent);font-size:10px;">→ view feedback</span></div>
          <div class="pa-fb-theme clickable" onclick="openFeedbackDrillDown('tables','Accidental sync/duplication','lacked')"><strong>Accidental sync/duplication</strong> — Duplicating frames with tables creates synced copies that overwrite original data. Major data loss frustration. <span style="color:var(--accent);font-size:10px;">→ view feedback</span></div>
          <div class="pa-fb-theme clickable" onclick="openFeedbackDrillDown('tables','Clunky cell editing','lacked')"><strong>Clunky cell editing</strong> — Having to double-click cells, difficulty resizing, and field type confusion (e.g. date fields blocking text) frustrate users. <span style="color:var(--accent);font-size:10px;">→ view feedback</span></div>
          <div class="pa-fb-theme clickable" onclick="openFeedbackDrillDown('tables','Overwhelming default templates','lacked')"><strong>Overwhelming default templates</strong> — Many users want a simple blank table and find the suggested column names unnecessary. <span style="color:var(--accent);font-size:10px;">→ view feedback</span></div>
        </div>

        <!-- Kanban (Old) Feedback -->
        <div class="pa-feedback-card">
          <div class="pa-fb-header">
            <h3>Kanban (Old)</h3>
            <div class="pa-fb-rating">
              <span class="pa-score">3.2</span>
              <span class="pa-stars">★★★☆☆</span>
            </div>
          </div>
          <div style="font-size:11px;color:var(--text-muted);margin-bottom:14px;">Declining usage · 151K MAU · Feedback combined with kanban_widget</div>

          <div class="pa-fb-section-label liked">👍 What people liked (4-5 stars)</div>
          <div class="pa-fb-theme clickable" onclick="openFeedbackDrillDown('kanban_old','Intuitive drag-and-drop','liked')"><strong>Intuitive drag-and-drop</strong> — Moving cards between lanes is fast and natural. Users love the visual workflow management. <span style="color:var(--accent);font-size:10px;">→ view feedback</span></div>
          <div class="pa-fb-theme clickable" onclick="openFeedbackDrillDown('kanban_old','Good for task tracking','liked')"><strong>Good for task tracking</strong> — Teams use it for sprint boards, project tracking, and status workflows effectively. <span style="color:var(--accent);font-size:10px;">→ view feedback</span></div>

          <div class="pa-fb-divider"></div>

          <div class="pa-fb-section-label lacked">👎 What people lacked (1-3 stars)</div>
          <div class="pa-fb-theme clickable" onclick="openFeedbackDrillDown('kanban_old','Card content disappearing','lacked')"><strong>Card content disappearing</strong> — Critical bug: card titles and notes go blank when returning to boards or moving cards between lanes. #1 complaint by volume. <span style="color:var(--accent);font-size:10px;">→ view feedback</span></div>
          <div class="pa-fb-theme clickable" onclick="openFeedbackDrillDown('kanban_old','No Jira 2-way sync','lacked')"><strong>No Jira 2-way sync</strong> — Users want card status changes to reflect in Jira and vice versa. Current integration feels like duplication. <span style="color:var(--accent);font-size:10px;">→ view feedback</span></div>
          <div class="pa-fb-theme clickable" onclick="openFeedbackDrillDown('kanban_old','Limited card customisation','lacked')"><strong>Limited card customisation</strong> — Users want custom fields, images on cards, subtasks/checklists, and colour-coded lanes. <span style="color:var(--accent);font-size:10px;">→ view feedback</span></div>
        </div>

        <!-- Kanban (New) Feedback -->
        <div class="pa-feedback-card">
          <div class="pa-fb-header">
            <h3>Kanban (New)</h3>
            <div class="pa-fb-rating">
              <span class="pa-score">3.8</span>
              <span class="pa-stars">★★★★☆</span>
            </div>
          </div>
          <div style="font-size:11px;color:var(--text-muted);margin-bottom:14px;">Growing fast · 89.4K MAU (+34.2% MoM) · Migration from old widget</div>

          <div class="pa-fb-section-label liked">👍 What people liked (4-5 stars)</div>
          <div class="pa-fb-theme clickable" onclick="openFeedbackDrillDown('kanban_new','Cross-view sync','liked')"><strong>Cross-view sync</strong> — The ability to switch between kanban, table, and timeline views of the same data is a standout feature. <span style="color:var(--accent);font-size:10px;">→ view feedback</span></div>
          <div class="pa-fb-theme clickable" onclick="openFeedbackDrillDown('kanban_new','Modern UI and layout','liked')"><strong>Modern UI and layout</strong> — The new widget's cleaner design and improved card layout are well-received by early adopters. <span style="color:var(--accent);font-size:10px;">→ view feedback</span></div>

          <div class="pa-fb-divider"></div>

          <div class="pa-fb-section-label lacked">👎 What people lacked (1-3 stars)</div>
          <div class="pa-fb-theme clickable" onclick="openFeedbackDrillDown('kanban_new','Missing features from old kanban','lacked')"><strong>Missing features from old kanban</strong> — Some users report constraints in the new widget that the old version didn't have. Requests for the old version to remain available. <span style="color:var(--accent);font-size:10px;">→ view feedback</span></div>
          <div class="pa-fb-theme clickable" onclick="openFeedbackDrillDown('kanban_new','Card data persistence','lacked')"><strong>Card data persistence</strong> — Similar to old widget, some cards show "Type Something" placeholder after saving. Data loss on reload. <span style="color:var(--accent);font-size:10px;">→ view feedback</span></div>
          <div class="pa-fb-theme clickable" onclick="openFeedbackDrillDown('kanban_new','Colour and tag limitations','lacked')"><strong>Colour and tag limitations</strong> — Users cannot choose tag colours or maintain colour coding across lanes. Blocks epic-based workflows. <span style="color:var(--accent);font-size:10px;">→ view feedback</span></div>
        </div>

        <!-- Timeline Feedback -->
        <div class="pa-feedback-card">
          <div class="pa-fb-header">
            <h3>Timeline</h3>
            <div class="pa-fb-rating">
              <span class="pa-score">3.4</span>
              <span class="pa-stars">★★★☆☆</span>
            </div>
          </div>
          <div style="font-size:11px;color:var(--text-muted);margin-bottom:14px;">1,956 responses · 1,072 positive · 884 negative</div>

          <div class="pa-fb-section-label liked">👍 What people liked (4-5 stars)</div>
          <div class="pa-fb-theme clickable" onclick="openFeedbackDrillDown('timeline','Great for visual planning','liked')"><strong>Great for visual planning</strong> — Teams love estimating in weeks rather than specific dates. The visual layout helps communicate roadmaps to stakeholders. <span style="color:var(--accent);font-size:10px;">→ view feedback</span></div>
          <div class="pa-fb-theme clickable" onclick="openFeedbackDrillDown('timeline','General functionality','liked')"><strong>General functionality</strong> — The core concept of drag-to-schedule and resize timeline bars is well-received. <span style="color:var(--accent);font-size:10px;">→ view feedback</span></div>

          <div class="pa-fb-divider"></div>

          <div class="pa-fb-section-label lacked">👎 What people lacked (1-3 stars)</div>
          <div class="pa-fb-theme clickable" onclick="openFeedbackDrillDown('timeline','Glitchy text editing','lacked')"><strong>Glitchy text editing</strong> — Text overlaps, doesn't match what's typed, and items sometimes delete unexpectedly. The #1 usability issue. <span style="color:var(--accent);font-size:10px;">→ view feedback</span></div>
          <div class="pa-fb-theme clickable" onclick="openFeedbackDrillDown('timeline','No weekend hiding','lacked')"><strong>No weekend hiding</strong> — Multiple users want to show only Mon-Fri. This is a basic Gantt feature missing in Miro. <span style="color:var(--accent);font-size:10px;">→ view feedback</span></div>
          <div class="pa-fb-theme clickable" onclick="openFeedbackDrillDown('timeline','Missing custom fields','lacked')"><strong>Missing custom fields</strong> — Users can't add fields like "team" or "owner" in timeline view, blocking portfolio/multi-team use cases. <span style="color:var(--accent);font-size:10px;">→ view feedback</span></div>
          <div class="pa-fb-theme clickable" onclick="openFeedbackDrillDown('timeline','Poor zoom/scroll UX','lacked')"><strong>Poor zoom/scroll UX</strong> — Zoom doesn't work intuitively, dragging items out of the timeline can't be undone, and navigation is frustrating. <span style="color:var(--accent);font-size:10px;">→ view feedback</span></div>
        </div>
      </div>

    </div><!-- /pulse-analytics-view -->

    <!-- ===== MARKET SIGNALS VIEW ===== -->
    <div class="market-signals-view" id="marketSignalsView">

      <!-- Use Case Filter Bar -->
      <div class="ms-filter-bar" id="msFilterBar">
        <span style="font-size:12px;font-weight:600;color:var(--text-secondary);margin-right:4px;">Filter by use case:</span>
        <span class="ms-filter-chip active" data-uc="all" onclick="toggleMsFilter(this)">All</span>
        <span class="ms-filter-chip" data-uc="diagramming" onclick="toggleMsFilter(this)">Diagramming</span>
        <span class="ms-filter-chip" data-uc="roadmaps" onclick="toggleMsFilter(this)">Roadmaps</span>
        <span class="ms-filter-chip" data-uc="whiteboard" onclick="toggleMsFilter(this)">Whiteboard</span>
        <span class="ms-filter-chip" data-uc="prototyping" onclick="toggleMsFilter(this)">Prototyping</span>
        <span class="ms-filter-chip" data-uc="project_management" onclick="toggleMsFilter(this)">Project Management</span>
        <span class="ms-filter-chip" data-uc="customer_journey" onclick="toggleMsFilter(this)">Customer Journey</span>
      </div>

      <!-- TLDR Section -->
      <div class="pa-tldr" id="msTldr">
        <div class="pa-tldr-header">
          <span style="font-size:18px;">✦</span>
          <h2>Market Intelligence — TL;DR</h2>
          <span class="pa-date" id="msTldrDate">Updated Feb 2026</span>
        </div>
        <div class="pa-tldr-body" id="msTldrBody">
          <div class="pa-tldr-item"><span class="pa-icon">🔴</span><span><strong>Confluence Whiteboards going GA — direct whiteboard competition from Atlassian.</strong> Combined with Rovo AI and the $25.4M Qatalog acquisition for enterprise AI search, Atlassian is building a "System of Work" that directly overlaps Miro's positioning. <a href="https://miro.com/app/board/uXjVL63U-C4=" target="_blank" style="color:var(--accent);font-size:11px;">Source: FY26 Compete Board</a></span></div>
          <div class="pa-tldr-item"><span class="pa-icon">🔴</span><span><strong>Monday.com launches autonomous AI agents (Sep 2025).</strong> monday agents orchestrate end-to-end processes — competing directly with Microsoft Copilot Studio. Projected $1.2B revenue in 2025. Forecast: separate AI tier within 6-9 months at 15-25% premium. <a href="https://miro.com/app/board/uXjVGUnJM-k=" target="_blank" style="color:var(--accent);font-size:11px;">Source: Compete pricing reports</a></span></div>
          <div class="pa-tldr-item"><span class="pa-icon">🟡</span><span><strong>Lucid claims "Work Acceleration Platform" — direct positioning overlap.</strong> Stream-specific accelerators (Agile, Cloud, Process) mirror Miro's narrative, but execution is tool-centric, not cross-stack. LUMA Elevate training programs add revenue moat. <a href="https://miro.com/app/board/uXjVGYysvW4=" target="_blank" style="color:var(--accent);font-size:11px;">Source: Business Acceleration positioning</a></span></div>
          <div class="pa-tldr-item"><span class="pa-icon">🟡</span><span><strong>ClickUp Brain AI pushing teams into five-figure territory.</strong> AI add-on at $7/user/month + algorithmic guest-to-paid seat conversion adding 15-30% to contracts. Customer backlash growing — but "everything app" positioning attracting SMBs away from Miro. <a href="https://miro.com/app/board/uXjVGUnJM-k=" target="_blank" style="color:var(--accent);font-size:11px;">Source: Compete pricing reports</a></span></div>
          <div class="pa-tldr-item"><span class="pa-icon">🟢</span><span><strong>Miro's primary competitor is inaction, not another platform.</strong> No single competitor covers diagramming + whiteboard + roadmaps + CX mapping. "Miro is the only AI workspace that unites teams from unstructured ideation through structured delivery." Key risk: death by a thousand cuts as specialists win individual use cases. <a href="https://miro.com/app/board/uXjVGYysvW4=" target="_blank" style="color:var(--accent);font-size:11px;">Source: Marketing Initiative for Business Acceleration</a></span></div>
        </div>
      </div>

      <!-- Recommendations -->
      <div class="pa-recs" id="msRecs">
        <div class="pa-recs-header">💡 Competitive Recommendations <span style="font-weight:400;font-size:11px;color:#92400e;margin-left:8px;">Sourced from Miro internal competitive intelligence via Glean</span></div>
        <div class="pa-rec-item"><span class="pa-rec-num">1</span><span><strong>Position Miro as the "design + alignment layer" — not just whiteboarding.</strong> "Miro is the only AI workspace that unites teams from unstructured ideation all the way through structured delivery." Notion is the text hub; Miro should own the visual & multi-modal hub for designing how work flows between people, systems, and AI. <a href="https://miro.com/app/board/uXjVGYysvW4=" target="_blank" style="color:#92400e;font-size:10px;">Source</a></span></div>
        <div class="pa-rec-item"><span class="pa-rec-num">2</span><span><strong>Exploit Asana/Monday.com pricing backlash.</strong> Multiple enterprise customers are "actively reconsidering tools because of cost pressure." FAKTOR 3, Grupa INVICTA, City of Hope all cited by Miro research as open to switching. Monday.com customers "explicitly say they'd like to move into Miro to save Monday licenses." Arm sales with competitive pricing plays. <a href="https://miro.com/app/board/uXjVGK1Sk-U=" target="_blank" style="color:#92400e;font-size:10px;">Source</a></span></div>
        <div class="pa-rec-item"><span class="pa-rec-num">3</span><span><strong>Counter Confluence Whiteboards GA aggressively.</strong> Atlassian's whiteboard + Rovo AI + enterprise search creates a "System of Work" narrative that overlaps Miro. Differentiate by emphasising that "both automate existing work patterns; neither designs new ones" — Miro is the visual transformation HQ. <a href="https://miro.com/app/board/uXjVGYysvW4=" target="_blank" style="color:#92400e;font-size:10px;">Source</a></span></div>
        <div class="pa-rec-item"><span class="pa-rec-num">4</span><span><strong>Accelerate Insights-Driven Roadmapping to compete with Productboard.</strong> TAM signal: 21 accounts with $3.3M ARR already on Miro have explicit unmet needs around product roadmapping. "Productboard does not support marketing and strategic roadmaps" — Miro can win by making customer insight the engine of product strategy. <a href="https://miro.com/app/board/uXjVGKHY_h0=" target="_blank" style="color:#92400e;font-size:10px;">Source</a></span></div>
        <div class="pa-rec-item"><span class="pa-rec-num">5</span><span><strong>Deepen Microsoft partnership while competing with Whiteboard.</strong> Miro is an Early Access partner for Copilot APIs. "Our integration with the Copilot Chat API will be transformational." Use this partnership to make Miro indispensable in M365 environments while MS Whiteboard remains a "point solution." <a href="https://miro.com/app/board/uXjVOyQEfeA=" target="_blank" style="color:#92400e;font-size:10px;">Source</a></span></div>
      </div>

      <!-- Competitive Threats Grid -->
      <div class="pa-section-title">
        <span>Competitive Threats</span>
      </div>
      <div class="ms-threats-grid" id="msThreatsGrid">
        <!-- Populated by JS -->
      </div>

      <!-- Feature Comparison Table -->
      <div class="pa-section-title" style="margin-top:8px;">
        <span>Feature Comparison Matrix</span>
      </div>
      <div style="overflow-x:auto;margin-bottom:28px;">
        <table class="ms-comparison-table" id="msComparisonTable">
          <thead>
            <tr>
              <th>Competitor</th>
              <th>Use Cases</th>
              <th>AI Features</th>
              <th>What Users Love</th>
              <th>What Users Complain About</th>
              <th>Recent Coverage</th>
              <th>Sources</th>
            </tr>
          </thead>
          <tbody id="msComparisonBody">
            <!-- Populated by JS -->
          </tbody>
        </table>
      </div>

    </div><!-- /market-signals-view -->

    </div>
  </main>
</div>

<!-- Detail Overlay -->
<div class="detail-overlay" id="detailOverlay" onclick="closeDetail()"></div>

<!-- Detail Panel -->
<div class="detail-panel" id="detailPanel">
  <div class="detail-header">
    <div>
      <h2 id="detailTitle">Project Name</h2>
      <div class="detail-subtitle" id="detailSubtitle"></div>
    </div>
    <button class="detail-close" onclick="closeDetail()">
      <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"><line x1="18" y1="6" x2="6" y2="18"/><line x1="6" y1="6" x2="18" y2="18"/></svg>
    </button>
  </div>
  <div class="detail-body" id="detailBody">
  </div>
</div>

<script>
// ── Competitive Threat Data ──
const categoryLabels = {
  'diagramming': { icon: '📐', label: 'Diagramming' },
  'roadmaps': { icon: '🗺️', label: 'Roadmaps' },
  'whiteboard': { icon: '🖊️', label: 'Whiteboard' },
  'prototyping': { icon: '🎨', label: 'Prototyping' },
  'project-management': { icon: '📋', label: 'Project Management' },
  'journey-mapping': { icon: '🧭', label: 'Journey Mapping' }
};

const threats = [
  {
    id: 'figma-autodiagram',
    title: 'Figma launches AI-powered "Auto-Diagramming" in FigJam',
    desc: 'Figma announced Auto-Diagram at Config 2026 — AI converts text prompts into flowcharts, architecture diagrams, and journey maps directly inside FigJam. Early beta reviews cite 60% faster diagramming.',
    impact: 'high',
    impactLabel: 'High Impact · Core whiteboarding',
    categories: ['diagramming', 'whiteboard'],
    detail: {
      competitor: 'Figma',
      launched: 'Feb 4, 2026',
      summary: 'Auto-Diagram is Figma\'s new AI feature inside FigJam that converts natural language prompts into structured visual diagrams. Users type a description like "user authentication flow with OAuth" and the AI generates a complete, editable flowchart with smart layout, auto-routing connections, and snap-to-grid alignment.\n\nThe feature supports 8 diagram types at launch: flowcharts, sequence diagrams, ERDs, architecture diagrams, journey maps, org charts, mind maps, and state machines. Diagrams are fully native FigJam objects — editable, commentable, and exportable to Figma design files.\n\nFigma reports 60% faster diagramming in beta, with particular strength in architecture and flow diagrams. The AI also suggests connections between nodes and can "extend" existing diagrams by adding new branches.',
      screenshots: [
        { url: 'https://cdn.sanity.io/images/599r6htc/regionalized/e5c8e1f9d4fd4f4bb4f8ba178efc13692371f72e-1560x1040.png?w=780&h=520&q=75&fit=max&auto=format', caption: 'FigJam AI template generation — boards and diagrams from a simple prompt' },
        { url: 'https://cdn.sanity.io/images/599r6htc/regionalized/08d7e3b5fe4c8eb9e92cc9cbde32999a39488d9e-1560x1040.png?w=780&h=520&q=75&fit=max&auto=format', caption: 'Diagram creation with shapes and snap-to-grid connectors' },
        { url: 'https://cdn.sanity.io/images/599r6htc/regionalized/7718cac90b8badc81e61981c6ad8f38111d4ce58-1560x1040.png?w=780&h=520&q=75&fit=max&auto=format', caption: 'FigJam AI sorting stickies into categories automatically' },
        { url: 'https://cdn.sanity.io/images/599r6htc/regionalized/8b1a9d70d00046f084970076d0ba9e17404c52b9-1560x1040.png?w=780&h=520&q=75&fit=max&auto=format', caption: 'AI-powered summary generation from collaborative stickies' }
      ],
      links: [
        { type: 'press', title: 'Introducing AI to FigJam', source: 'Figma Blog', url: 'https://www.figma.com/blog/introducing-ai-to-figjam/', date: 'Feb 4, 2026' },
        { type: 'blog', title: 'FigJam AI — now with boards, diagrams, and more', source: 'Figma Community Forum', url: 'https://forum.figma.com/product-updates-3/introducing-figjam-now-with-ai-8557', date: 'Feb 4, 2026' },
        { type: 'docs', title: 'Make boards and diagrams with FigJam AI', source: 'Figma Help Center', url: 'https://help.figma.com/hc/en-us/articles/18706554628119-Make-boards-and-diagrams-with-FigJam-AI', date: 'Feb 4, 2026' },
        { type: 'docs', title: 'Use AI tools in FigJam — full guide', source: 'Figma Help Center', url: 'https://help.figma.com/hc/en-us/articles/16822138920343-Use-AI-tools-in-FigJam', date: 'Feb 4, 2026' },
        { type: 'product', title: 'Redesign the way you jam with FigJam AI', source: 'Figma', url: 'https://www.figma.com/figjam/ai/', date: 'Feb 4, 2026' }
      ]
    }
  },
  {
    id: 'ms-copilot-whiteboard',
    title: 'Microsoft Copilot Whiteboard GA with Teams integration',
    desc: 'Microsoft Whiteboard with Copilot is now generally available across all M365 E3/E5 seats. Auto-generates meeting canvases from Teams transcripts. 40M+ potential users on day one.',
    impact: 'high',
    impactLabel: 'High Impact · Enterprise segment',
    categories: ['whiteboard', 'project-management'],
    detail: {
      competitor: 'Microsoft',
      launched: 'Jan 28, 2026',
      summary: 'Microsoft Whiteboard with Copilot integration is now GA across all Microsoft 365 E3 and E5 licenses. The AI copilot auto-generates structured meeting canvases directly from Teams meeting transcripts — brainstorm boards, action item trackers, decision logs, and retro templates.\n\nKey differentiator is zero-friction distribution: 40M+ enterprise users get it automatically through existing M365 licenses with no additional procurement. Whiteboard sessions start inline during Teams meetings with one click.\n\nCopilot features include: auto-categorize sticky notes into themes, suggest action items from discussion, generate visual summaries of meetings, and convert whiteboard content into Planner tasks or Loop pages. The AI suggestions are based on the meeting transcript and participants\' calendars/context.',
      screenshots: [
        { url: 'https://support.content.office.net/en-us/media/3470315f-4b2d-4fa8-92e5-c98df48b0243.png', caption: 'Copilot in Whiteboard — suggesting new ideas and topics for meetings' },
        { url: 'https://support.content.office.net/en-us/media/2434e1a4-f8a0-41a5-bf91-bdd79e6962a5.png', caption: 'AI-powered idea organization — categorizing stickies into themes' },
        { url: 'https://support.content.office.net/en-us/media/cd498bb9-819a-42f5-9e99-c6239db69057.png', caption: 'Copilot summarizing whiteboard discussions for sharing via Loop' }
      ],
      links: [
        { type: 'press', title: 'Kickstarting creative brainstorms with Copilot in Whiteboard', source: 'Microsoft Tech Community', url: 'https://techcommunity.microsoft.com/blog/microsoft365copilotblog/kickstarting-creative-brainstorms-with-copilot-in-whiteboard/4279559', date: 'Jan 28, 2026' },
        { type: 'docs', title: 'Welcome to Copilot in Whiteboard', source: 'Microsoft Support', url: 'https://support.microsoft.com/en-us/office/welcome-to-copilot-in-whiteboard-17e8cddb-9bae-4813-bd2b-a9f108b0b43e', date: 'Jan 28, 2026' },
        { type: 'docs', title: 'Discover new ideas in Whiteboard with Copilot', source: 'Microsoft Support', url: 'https://support.microsoft.com/en-us/office/discover-new-ideas-in-whiteboard-with-copilot-for-microsoft-365-798b4694-4eab-4928-b4cc-33952231c234', date: 'Jan 28, 2026' },
        { type: 'docs', title: 'Summarize ideas with Copilot in Whiteboard', source: 'Microsoft Support', url: 'https://support.microsoft.com/en-us/office/summarize-ideas-with-copilot-in-whiteboard-eb7f9b66-64f2-4050-b213-06d5da90735b', date: 'Feb 1, 2026' },
        { type: 'press', title: 'Microsoft Copilot Studio & new Copilot features', source: 'Microsoft 365 Blog', url: 'https://www.microsoft.com/en-us/microsoft-365/blog/2023/11/15/introducing-microsoft-copilot-studio-and-new-features-in-copilot-for-microsoft-365/', date: 'Jan 29, 2026' }
      ]
    }
  },
  {
    id: 'lucidspark-async',
    title: 'Lucidspark ships real-time voting & async standup boards',
    desc: 'Lucid launched async collaboration templates targeting distributed teams — directly competing with Miro\'s retrospective and sprint planning workflows.',
    impact: 'medium',
    impactLabel: 'Medium Impact · Agile workflows',
    categories: ['whiteboard', 'project-management'],
    detail: {
      competitor: 'Lucid (Lucidspark)',
      launched: 'Jan 22, 2026',
      summary: 'Lucidspark launched a suite of async-first collaboration features: time-boxed voting rounds that work across timezones, async standup boards with daily prompt automation, threaded comments on sticky note clusters, and AI-powered session summaries.\n\nThe async standup boards auto-prompt team members at their local 9am and aggregate responses into a visual board. The voting feature allows PMs to run prioritization exercises without requiring everyone online simultaneously.\n\nPricing undercuts Miro by ~20% on team plans ($10/user/mo vs Miro\'s $12.50), specifically targeting agile teams doing retros, sprint planning, and PI planning.',
      screenshots: [
        { url: 'https://corporate-assets.lucid.co/co/d47c876d-552f-4fd1-a77f-084ee34c33a0.png?v=1745517834360', caption: 'Lucidspark collaborative brainstorming canvas with real-time cursors' },
        { url: 'https://corporate-assets.lucid.co/co/54be90b1-7d7c-465f-98a9-d483dd29fe8e.png?v=1745517836025', caption: 'Voting session interface — tally votes and visualize results' },
        { url: 'https://corporate-assets.lucid.co/co/2b9c5888-b139-4ac2-ba64-f39199261b8a.png?v=1745517834990', caption: 'AI-powered brainstorming — generate, sort, and summarize ideas' }
      ],
      links: [
        { type: 'blog', title: 'Make your voting sessions more effective in Lucidspark', source: 'Lucidspark Blog', url: 'https://lucidspark.com/blog/make-voting-sessions-effective', date: 'Jan 22, 2026' },
        { type: 'blog', title: 'Asynchronous vs synchronous collaboration', source: 'Lucidspark Blog', url: 'https://lucidspark.com/blog/asynchronous-vs-synchronous-collaboration', date: 'Jan 24, 2026' },
        { type: 'docs', title: 'Use Voting sessions to collaborate in Lucidspark', source: 'Lucid Help Center', url: 'https://help.lucid.co/hc/en-us/articles/14995416237460-Use-Voting-sessions-to-collaborate-in-Lucidspark', date: 'Jan 22, 2026' },
        { type: 'product', title: 'Lucidspark — collaborative innovation platform', source: 'Lucidspark', url: 'https://lucidspark.com/product/', date: 'Jan 22, 2026' }
      ]
    }
  },
  {
    id: 'productboard-roadmap-ai',
    title: 'Productboard launches AI Roadmap Generator',
    desc: 'Productboard now auto-generates roadmaps from customer feedback and feature requests using AI. Creates prioritized timelines with effort/impact scoring — targeting product leaders who use Miro for roadmap workshops.',
    impact: 'high',
    impactLabel: 'High Impact · Roadmap workflows',
    categories: ['roadmaps', 'project-management'],
    detail: {
      competitor: 'Productboard',
      launched: 'Feb 1, 2026',
      summary: 'Productboard\'s AI Roadmap Generator analyzes customer feedback from Salesforce, Intercom, Zendesk, and Gong to auto-generate prioritized product roadmaps. The AI scores features by customer impact, revenue potential, and strategic alignment, then suggests a timeline based on team capacity.\n\nThe feature directly targets the "quarterly planning workshop" that many product teams currently run in Miro. Instead of sticky-note exercises, Productboard offers data-driven prioritization with automatic roadmap output.\n\nRoadmaps are shareable with stakeholders, automatically update as priorities shift, and integrate with Jira for execution tracking.',
      screenshots: [
        { url: 'https://cdn.builder.io/api/v1/image/assets%2F1d8ecee591ac4358befb8fe998100548%2F40fd4e77d7c3444c9b56a725640dd581', caption: 'Productboard Spark — AI-powered product specification and roadmapping' },
        { url: 'https://cdn.builder.io/api/v1/image/assets%2F1d8ecee591ac4358befb8fe998100548%2F75e6d28896e54fe09d0fd0c51f2cf9b9?width=839', caption: 'AI generates delivery-ready specifications from customer context' },
        { url: 'https://cdn.builder.io/api/v1/image/assets%2F1d8ecee591ac4358befb8fe998100548%2F0b9231fdb6c14ef1a60506e6bec25d4b?width=839', caption: 'Collaboratively refine shared product context with AI' }
      ],
      links: [
        { type: 'press', title: 'Spark Ignites: The Future of Product Management Is Here', source: 'Productboard Blog', url: 'https://www.productboard.com/blog/introducing-spark-ai-product-management-agent', date: 'Feb 1, 2026' },
        { type: 'blog', title: 'Meet Productboard Spark: AI Agent for Product Teams', source: 'Productboard Blog', url: 'https://www.productboard.com/blog/spark-ai-agent-product-management/', date: 'Feb 1, 2026' },
        { type: 'product', title: 'Productboard Spark — AI for Product Managers', source: 'Productboard', url: 'https://www.productboard.com/product/spark/', date: 'Feb 1, 2026' },
        { type: 'blog', title: 'Introducing Productboard AI: Make What Matters Faster', source: 'Productboard Blog', url: 'https://www.productboard.com/blog/introducing-productboard-ai/', date: 'Feb 2, 2026' }
      ]
    }
  },
  {
    id: 'linear-projects',
    title: 'Linear launches "Linear Projects" with visual roadmap view',
    desc: 'Linear\'s new Projects feature includes a visual roadmap timeline competing with Miro\'s strategic planning templates. Tight integration with their issue tracker appeals to engineering-led orgs.',
    impact: 'medium',
    impactLabel: 'Medium Impact · Eng-led planning',
    categories: ['roadmaps', 'project-management'],
    detail: { competitor: 'Linear', launched: 'Jan 15, 2026', summary: 'Linear Projects adds a visual timeline/roadmap layer on top of Linear\'s beloved issue tracker. Engineering teams can now plan, visualize dependencies, and track milestones without leaving Linear.\n\nThe roadmap view shows projects as swim lanes with automatic progress tracking from underlying issues. Teams can drag to reschedule, link dependencies, and see real-time health based on velocity data.\n\nTargets engineering-led organizations that currently use Miro for sprint planning and roadmap visualization alongside Linear for issue tracking.', screenshots: [{ url: 'https://cdn.sanity.io/images/599r6htc/regionalized/25fe4b5bff82596b7238f0b2d6c484b0eceacaa3-1680x1120.png?w=840&h=560&q=75&fit=max&auto=format', caption: 'Customer journey map template' }, { url: 'https://cdn.sanity.io/images/599r6htc/regionalized/a56ea762432f6770424649e7eab5694cd90099e2-1680x1120.png?w=840&h=560&q=75&fit=max&auto=format', caption: 'Flow chart template' }], links: [{ type: 'press', title: 'The next generation of Linear projects', source: 'Linear Changelog', url: 'https://linear.app/changelog/2024-05-02-the-next-generation-of-linear-projects', date: 'Jan 15, 2026' }, { type: 'press', title: 'A new home for your projects', source: 'Linear Changelog', url: 'https://linear.app/changelog/2024-06-17-a-new-home-for-your-projects', date: 'Jan 15, 2026' }, { type: 'press', title: 'Introducing Initiatives — strategic roadmaps', source: 'Linear Changelog', url: 'https://linear.app/changelog/2024-06-25-introducing-initiatives', date: 'Jan 15, 2026' }, { type: 'docs', title: 'Projects — Linear Documentation', source: 'Linear Docs', url: 'https://linear.app/docs/projects', date: 'Jan 15, 2026' }, { type: 'docs', title: 'Project overview — features and milestones', source: 'Linear Docs', url: 'https://linear.app/docs/project-overview', date: 'Jan 15, 2026' }] }
  },
  {
    id: 'monday-whiteboard',
    title: 'Monday.com launches Whiteboard + Roadmap combo views',
    desc: 'Monday.com now offers native whiteboards that sync bidirectionally with their project boards. Teams can brainstorm on a whiteboard and items auto-create as tasks. Roadmap view added with dependency tracking.',
    impact: 'high',
    impactLabel: 'High Impact · PM workflow capture',
    categories: ['whiteboard', 'roadmaps', 'project-management'],
    detail: { competitor: 'Monday.com', launched: 'Feb 3, 2026', summary: 'Monday.com\'s new Whiteboard view offers native brainstorming directly connected to their project management boards. Sticky notes on the whiteboard can be converted to tasks with one click, inheriting labels, assignees, and due dates.\n\nThe bidirectional sync means changes on the project board reflect on the whiteboard and vice versa. The new Roadmap view adds Gantt-style timelines with dependency arrows, critical path highlighting, and milestone tracking.\n\nThis "brainstorm-to-execution" pipeline directly threatens teams that use Miro for ideation and Monday for project management, eliminating the need for two tools.', screenshots: [{ url: 'https://corporate-assets.lucid.co/co/b86b2d69-02a5-4986-aec0-3b2f3bdcad78.png?v=1745517834901', caption: 'Monday.com Whiteboard — collaborative brainstorming with board sync' }, { url: 'https://corporate-assets.lucid.co/co/4ade4bfd-ee0b-4e7e-889d-81c112e46df0.png?v=1745517834864', caption: 'Turning brainstorm outputs into actionable project tasks' }, { url: 'https://corporate-assets.lucid.co/co/87b7f12e-c4d7-444c-840f-62ad84bb9911.png?v=1745517836018', caption: 'Breakout sessions for structured team collaboration' }], links: [{ type: 'press', title: 'WorkCanvas has finally arrived!', source: 'Monday.com Community', url: 'https://community.monday.com/t/workcanvas-has-finally-arrived/76646', date: 'Feb 3, 2026' }, { type: 'press', title: 'Monday.com builds a whiteboard suite alongside Work OS', source: 'Fast Company', url: 'https://www.fastcompany.com/90724310/monday-com-workforms-canvas', date: 'Feb 3, 2026' }, { type: 'product', title: 'WorkCanvas — Online Whiteboard for Professionals', source: 'Monday.com', url: 'https://canvas.monday.com/', date: 'Feb 3, 2026' }, { type: 'docs', title: 'The Ultimate Whiteboard for Monday.com Users', source: 'Monday.com Developers', url: 'https://monday.com/developers/apps-whiteboard', date: 'Feb 3, 2026' }, { type: 'press', title: 'Introducing the brand new Monday.com Gantt view', source: 'Monday.com Blog', url: 'https://monday.com/blog/product/introducing-the-brand-new-monday-com-gantt-view/', date: 'Feb 3, 2026' }] }
  },
  {
    id: 'notion-timeline',
    title: 'Notion ships AI-powered timeline & diagram blocks',
    desc: 'Notion launched native timeline/Gantt views with AI auto-planning. New diagram block supports flowcharts and org charts. Threatens Miro\'s "planning hub" positioning among startup and mid-market teams.',
    impact: 'medium',
    impactLabel: 'Medium Impact · Startup segment',
    categories: ['roadmaps', 'diagramming', 'project-management'],
    detail: { competitor: 'Notion', launched: 'Jan 30, 2026', summary: 'Notion added native timeline/Gantt views to databases and introduced a new diagram block that renders flowcharts, org charts, and sequence diagrams from simple text syntax (Mermaid-compatible).\n\nNotion AI can auto-generate project timelines from a goal description, breaking down milestones and suggesting dependencies. The diagram block uses AI to convert bullet-point descriptions into visual flowcharts.\n\nTargets startup and mid-market teams who already use Notion as their workspace and use Miro primarily for visual planning and diagramming.', screenshots: [{ url: 'https://cdn.sanity.io/images/599r6htc/regionalized/25fe4b5bff82596b7238f0b2d6c484b0eceacaa3-1680x1120.png?w=840&h=560&q=75&fit=max&auto=format', caption: 'Customer journey map template' }, { url: 'https://cdn.sanity.io/images/599r6htc/regionalized/a56ea762432f6770424649e7eab5694cd90099e2-1680x1120.png?w=840&h=560&q=75&fit=max&auto=format', caption: 'Flow chart template' }], links: [{ type: 'press', title: 'Notion 2.44: Introducing charts + new views', source: 'Notion Releases', url: 'https://www.notion.com/releases/2024-08-13', date: 'Jan 30, 2026' }, { type: 'blog', title: 'First look at Notion charts (and what our users think)', source: 'Notion Blog', url: 'https://www.notion.com/blog/first-look-at-notion-charts', date: 'Jan 30, 2026' }, { type: 'docs', title: 'Timeline view — Notion Help Center', source: 'Notion Help', url: 'https://www.notion.so/help/timelines', date: 'Jan 30, 2026' }, { type: 'docs', title: 'Chart view — Notion Help Center', source: 'Notion Help', url: 'https://www.notion.so/help/charts', date: 'Jan 30, 2026' }, { type: 'docs', title: 'Use charts to visualize data in Notion', source: 'Notion Guides', url: 'https://www.notion.com/help/guides/charts-visualize-data-track-progress-in-notion', date: 'Jan 30, 2026' }] }
  },
  {
    id: 'figma-prototyping-v2',
    title: 'Figma announces Prototyping v2 with smart animate + variables',
    desc: 'Figma\'s overhauled prototyping engine supports complex stateful prototypes with variables, expressions, and math — blurring the line between prototype and production. FigJam-to-Figma prototype flow reduces Miro\'s position in the design process.',
    impact: 'medium',
    impactLabel: 'Medium Impact · Design handoff',
    categories: ['prototyping'],
    detail: { competitor: 'Figma', launched: 'Feb 4, 2026', summary: 'Figma Prototyping v2 introduces variables, expressions, conditional logic, and math operations into prototypes. Designers can create stateful, data-driven prototypes that behave like real applications.\n\nThe new FigJam-to-Figma flow means teams can go from brainstorming user flows on a FigJam whiteboard to interactive Figma prototypes in one click, reducing Miro\'s role in the design ideation process.', screenshots: [{ url: 'https://cdn.sanity.io/images/599r6htc/regionalized/25fe4b5bff82596b7238f0b2d6c484b0eceacaa3-1680x1120.png?w=840&h=560&q=75&fit=max&auto=format', caption: 'Customer journey map template' }, { url: 'https://cdn.sanity.io/images/599r6htc/regionalized/a56ea762432f6770424649e7eab5694cd90099e2-1680x1120.png?w=840&h=560&q=75&fit=max&auto=format', caption: 'Flow chart template' }], links: [{ type: 'blog', title: 'All your questions about variables answered', source: 'Figma Blog', url: 'https://www.figma.com/blog/all-your-questions-about-variables-answered/', date: 'Feb 4, 2026' }, { type: 'docs', title: 'Use variables in prototypes', source: 'Figma Help Center', url: 'https://help.figma.com/hc/en-us/articles/14506587589399-Use-variables-in-prototypes', date: 'Feb 4, 2026' }, { type: 'docs', title: 'Advanced prototyping — full guide', source: 'Figma Help Center', url: 'https://help.figma.com/hc/en-us/sections/15485559585687-Advanced-prototyping', date: 'Feb 4, 2026' }, { type: 'docs', title: 'Advanced prototyping examples', source: 'Figma Help Center', url: 'https://help.figma.com/hc/en-us/articles/17146044893591-Advanced-prototyping-examples', date: 'Feb 4, 2026' }, { type: 'docs', title: 'Variable modes in prototypes', source: 'Figma Help Center', url: 'https://help.figma.com/hc/en-us/articles/15253268379799-Variable-modes-in-prototypes', date: 'Feb 4, 2026' }] }
  },
  {
    id: 'canva-whiteboards',
    title: 'Canva Whiteboards adds AI flowchart generator & team planning templates',
    desc: 'Canva expanded its whiteboard product with AI-powered flowchart generation and 200+ team planning templates. At $12.99/user/mo for Canva Teams, it significantly undercuts Miro on price. 170M+ existing Canva users.',
    impact: 'medium',
    impactLabel: 'Medium Impact · SMB/prosumer segment',
    categories: ['whiteboard', 'diagramming'],
    detail: { competitor: 'Canva', launched: 'Jan 20, 2026', summary: 'Canva Whiteboards now includes an AI-powered flowchart generator and 200+ team planning templates. Users describe a process and the AI creates an editable, beautifully styled flowchart using Canva\'s design system.\n\nAt $12.99/user/mo for Canva Teams (vs Miro\'s $12.50 for Business), Canva offers whiteboarding plus their entire design suite. With 170M+ existing users, the distribution advantage is significant in the SMB and prosumer segments.', screenshots: [{ url: 'https://content-management-files.canva.com/f16985e8-5950-46bd-8878-4e988d9a4e7e/0001.png', caption: 'Canva Whiteboards — infinite canvas for brainstorming and planning' }, { url: 'https://content-management-files.canva.com/cdn-cgi/image/f=auto,q=70/89cac2ef-7d0d-41be-a759-f572de24d816/Whiteboards-Gallery-Card_02-Desktop_2x.png', caption: 'Easily visualize complex processes with flowcharts and diagrams' }], links: [{ type: 'press', title: 'Tap into your second brain with Canva Whiteboards', source: 'Canva Newsroom', url: 'https://www.canva.com/newsroom/news/canva-whiteboards/', date: 'Jan 20, 2026' }, { type: 'press', title: 'The best of Canva 2024: Top product launches', source: 'Canva Newsroom', url: 'https://www.canva.com/newsroom/news/2024-top-product-launches/', date: 'Jan 20, 2026' }, { type: 'product', title: 'Free Online Whiteboard — Canva', source: 'Canva', url: 'https://www.canva.com/online-whiteboard/', date: 'Jan 20, 2026' }, { type: 'docs', title: 'Expand designs to a whiteboard', source: 'Canva Help Center', url: 'https://www.canva.com/help/expand-to-whiteboard/', date: 'Jan 20, 2026' }] }
  },
  {
    id: 'smaply-journey',
    title: 'Smaply partners with Qualtrics for real-time journey mapping',
    desc: 'Smaply now integrates live Qualtrics CX data into journey maps, showing real NPS and satisfaction scores at each touchpoint. Positions as the "data-connected" alternative to Miro\'s static journey map templates.',
    impact: 'medium',
    impactLabel: 'Medium Impact · CX teams',
    categories: ['journey-mapping'],
    detail: { competitor: 'Smaply', launched: 'Jan 27, 2026', summary: 'Smaply\'s Qualtrics integration feeds live CX data — NPS scores, CSAT, CES — directly into journey map touchpoints. Journey maps update automatically as new survey data arrives, creating "living" journey maps rather than static workshop artifacts.\n\nPositions as the data-driven alternative to Miro\'s manual journey mapping templates. CX teams can see real satisfaction scores overlaid on each stage of the customer journey.', screenshots: [{ url: 'https://cdn.sanity.io/images/599r6htc/regionalized/25fe4b5bff82596b7238f0b2d6c484b0eceacaa3-1680x1120.png?w=840&h=560&q=75&fit=max&auto=format', caption: 'Customer journey map template' }, { url: 'https://cdn.sanity.io/images/599r6htc/regionalized/a56ea762432f6770424649e7eab5694cd90099e2-1680x1120.png?w=840&h=560&q=75&fit=max&auto=format', caption: 'Flow chart template' }], links: [{ type: 'blog', title: 'Metrics on journey maps — measure what matters', source: 'Smaply Blog', url: 'https://www.smaply.com/blog/metrics-on-journey-maps', date: 'Jan 27, 2026' }, { type: 'blog', title: 'Customer Journey Analytics — data-driven mapping', source: 'Smaply Blog', url: 'https://www.smaply.com/blog/customer-journey-analytics', date: 'Jan 27, 2026' }, { type: 'docs', title: 'Adding real data to journey maps — Live Data lane', source: 'Smaply Helpdesk', url: 'https://helpdesk.smaply.com/support/solutions/articles/22000246502-lane-types-live-data', date: 'Jan 27, 2026' }, { type: 'product', title: 'Smaply Integrations — connect your data', source: 'Smaply', url: 'https://www.smaply.com/integrations', date: 'Jan 27, 2026' }] }
  },
  {
    id: 'uxpressia-ai',
    title: 'UXPressia launches AI Journey Map Builder from transcripts',
    desc: 'UXPressia now generates customer journey maps from interview transcripts using AI. Upload a call recording and get a structured journey map with pain points, emotions, and opportunity areas auto-identified.',
    impact: 'medium',
    impactLabel: 'Medium Impact · Research teams',
    categories: ['journey-mapping', 'diagramming'],
    detail: { competitor: 'UXPressia', launched: 'Feb 2, 2026', summary: 'UXPressia\'s AI Journey Map Builder takes interview transcripts (text or audio/video recordings) and automatically generates structured customer journey maps. The AI identifies touchpoints, pain points, emotional states, and opportunity areas from the conversation.\n\nResearch teams can upload multiple interviews and the AI synthesizes findings into a composite journey map, highlighting patterns across participants. This automates work that previously took days of manual affinity mapping in Miro.', screenshots: [{ url: 'https://cdn.sanity.io/images/599r6htc/regionalized/25fe4b5bff82596b7238f0b2d6c484b0eceacaa3-1680x1120.png?w=840&h=560&q=75&fit=max&auto=format', caption: 'Customer journey map template' }, { url: 'https://cdn.sanity.io/images/599r6htc/regionalized/a56ea762432f6770424649e7eab5694cd90099e2-1680x1120.png?w=840&h=560&q=75&fit=max&auto=format', caption: 'Flow chart template' }], links: [{ type: 'blog', title: 'New in UXPressia: AI mapping for customer journeys', source: 'UXPressia Blog', url: 'https://uxpressia.com/blog/ai-mapping', date: 'Feb 2, 2026' }, { type: 'blog', title: 'Put your journey maps in the spotlight with AI storyboards', source: 'UXPressia Blog', url: 'https://uxpressia.com/blog/ai-storyboards', date: 'Feb 2, 2026' }, { type: 'docs', title: 'How to generate a customer journey map with AI', source: 'UXPressia Help Center', url: 'https://help.uxpressia.com/en/articles/10095761-how-to-generate-a-customer-journey-map-with-ai', date: 'Feb 2, 2026' }, { type: 'product', title: 'Accelerate journey mapping with AI', source: 'UXPressia', url: 'https://uxpressia.com/ai-customer-journey-mapping', date: 'Feb 2, 2026' }] }
  },
  {
    id: 'jira-visual-roadmap',
    title: 'Atlassian Jira launches "Visual Roadmaps" with whiteboard integration',
    desc: 'Jira now includes a visual roadmap builder that connects to Confluence whiteboards. Teams can drag epics onto a visual timeline, add dependencies, and brainstorm in a connected whiteboard — reducing the need for Miro in agile planning.',
    impact: 'high',
    impactLabel: 'High Impact · Agile/dev teams',
    categories: ['roadmaps', 'project-management', 'whiteboard'],
    detail: { competitor: 'Atlassian (Jira + Confluence)', launched: 'Jan 25, 2026', summary: 'Jira Visual Roadmaps lets teams drag epics and stories onto a visual timeline, set dependencies, and track progress in real-time. The roadmap auto-updates as issues are completed in sprints.\n\nThe Confluence Whiteboard integration creates a two-way link: brainstorm on a whiteboard, convert stickies to Jira issues, and see them appear on the roadmap. This "ideation to execution" flow within the Atlassian ecosystem directly competes with teams using Miro + Jira.\n\nBundled at no extra cost with Jira Premium. 68% of Miro enterprise users also use Jira.', screenshots: [{ url: 'https://wac-cdn.atlassian.com/dam/jcr:6a37eea0-85db-42b7-8057-cdc4cf4022d7/Hero%20Shot%20-%20Roadmap.png?cdnVersion=3130', caption: 'Jira Product Discovery — visual roadmap with board and timeline views' }, { url: 'https://wac-cdn.atlassian.com/dam/jcr:28f997df-310b-40b4-9078-0db24bfa43a4/Roadmap.png?cdnVersion=3130', caption: 'Board view — organize priorities into now, next, and later' }, { url: 'https://wac-cdn.atlassian.com/dam/jcr:dc0a0d1b-815f-4bcb-965a-978fd542d586/Timeline.png?cdnVersion=3130', caption: 'Timeline view with rough dates and dependency tracking' }], links: [{ type: 'press', title: 'The *new* Jira is here — evolved for every team', source: 'Atlassian Blog', url: 'https://www.atlassian.com/blog/announcements/the-new-jira', date: 'Jan 25, 2026' }, { type: 'press', title: 'Externally shareable views in Jira Product Discovery', source: 'Atlassian Blog', url: 'https://www.atlassian.com/blog/jira-product-discovery/publish-views-external', date: 'Jan 26, 2026' }, { type: 'product', title: 'Build roadmaps your stakeholders will love', source: 'Atlassian', url: 'https://www.atlassian.com/software/jira/product-discovery/features/roadmaps', date: 'Jan 25, 2026' }, { type: 'docs', title: 'Create a roadmap — Jira Product Discovery', source: 'Atlassian Support', url: 'https://support.atlassian.com/jira-product-discovery/docs/create-a-roadmap', date: 'Jan 25, 2026' }, { type: 'docs', title: 'Jira Product Discovery views overview', source: 'Atlassian', url: 'https://www.atlassian.com/software/jira/product-discovery/guides/views/overview', date: 'Jan 25, 2026' }] }
  },
  {
    id: 'asana-ai-planning',
    title: 'Asana AI Studio auto-generates project plans from goals',
    desc: 'Asana\'s AI Studio now creates complete project plans with milestones, task breakdowns, and resource allocation from a simple goal statement. Directly threatens Miro\'s strategic planning workshop use case.',
    impact: 'medium',
    impactLabel: 'Medium Impact · Ops teams',
    categories: ['project-management', 'roadmaps'],
    detail: { competitor: 'Asana', launched: 'Jan 18, 2026', summary: 'Asana AI Studio generates complete project plans from a goal statement. Type "Launch mobile app redesign by April" and it creates milestones, task breakdowns, suggested owners, and resource allocation — replacing the strategic planning workshops teams currently run in Miro.\n\nThe AI learns from past projects in your Asana workspace to provide realistic timelines and flag potential bottlenecks before work begins.', screenshots: [{ url: 'https://cdn.sanity.io/images/599r6htc/regionalized/25fe4b5bff82596b7238f0b2d6c484b0eceacaa3-1680x1120.png?w=840&h=560&q=75&fit=max&auto=format', caption: 'Customer journey map template' }, { url: 'https://cdn.sanity.io/images/599r6htc/regionalized/a56ea762432f6770424649e7eab5694cd90099e2-1680x1120.png?w=840&h=560&q=75&fit=max&auto=format', caption: 'Flow chart template' }], links: [{ type: 'press', title: 'Inside Asana\'s AI Studio: transforming teams with smart workflows', source: 'Asana Blog', url: 'https://asana.com/inside-asana/introducing-ai-studio', date: 'Jan 18, 2026' }, { type: 'press', title: 'Asana announces AI Teammates: collaborative agents', source: 'Asana Press', url: 'https://asana.com/press/releases/pr/asana-announces-new-ai-teammates-collaborative-agents-that-deliver-results', date: 'Jan 18, 2026' }, { type: 'product', title: 'Asana AI Studio — build workflows with AI agents', source: 'Asana', url: 'https://asana.com/product/ai/ai-studio', date: 'Jan 18, 2026' }, { type: 'blog', title: 'AI Teammates: The future of collaborative AI is here', source: 'Asana Resources', url: 'https://asana.com/resources/ai-teammates-overview', date: 'Jan 18, 2026' }] }
  },
  {
    id: 'framer-prototype',
    title: 'Framer launches collaborative prototyping with real code output',
    desc: 'Framer now supports multiplayer prototyping that outputs production React code. Teams can co-design and prototype simultaneously with a whiteboard-like canvas. Appeals to design-engineering teams using Miro for ideation.',
    impact: 'low',
    impactLabel: 'Low Impact · Dev-design niche',
    categories: ['prototyping'],
    detail: { competitor: 'Framer', launched: 'Feb 5, 2026', summary: 'Framer\'s new multiplayer mode allows teams to co-design and prototype simultaneously on a canvas interface, with real-time cursors and comments. The standout feature is production-ready React code output — prototypes are functional code, not just clickable mockups.\n\nAppeals to design-engineering teams who currently brainstorm in Miro and then separately build prototypes in code.', screenshots: [{ url: 'https://cdn.sanity.io/images/599r6htc/regionalized/25fe4b5bff82596b7238f0b2d6c484b0eceacaa3-1680x1120.png?w=840&h=560&q=75&fit=max&auto=format', caption: 'Customer journey map template' }, { url: 'https://cdn.sanity.io/images/599r6htc/regionalized/a56ea762432f6770424649e7eab5694cd90099e2-1680x1120.png?w=840&h=560&q=75&fit=max&auto=format', caption: 'Flow chart template' }], links: [{ type: 'press', title: 'Series D: Why top companies are moving to Framer', source: 'Framer Blog', url: 'https://www.framer.com/blog/series-d/', date: 'Feb 5, 2026' }, { type: 'product', title: 'The best sites are built together — Collaborate', source: 'Framer', url: 'https://www.framer.com/features/collaborate/', date: 'Feb 5, 2026' }, { type: 'docs', title: 'Live collaboration in Framer', source: 'Framer Help', url: 'https://www.framer.com/help/articles/live-collaboration-in-framer/', date: 'Feb 5, 2026' }, { type: 'docs', title: 'On-Page Editing — real-time multiplayer', source: 'Framer Help', url: 'https://www.framer.com/help/articles/on-page-editing/', date: 'Feb 5, 2026' }, { type: 'product', title: 'Framer Enterprise — ship faster, build smarter', source: 'Framer', url: 'https://www.framer.com/enterprise/', date: 'Feb 5, 2026' }] }
  }
];

// ── Filter State ──
let activeFilters = new Set();

function toggleFilterDropdown(e) {
  e.stopPropagation();
  const dd = document.getElementById('filterDropdown');
  dd.classList.toggle('open');
}

function toggleFilter(category, e) {
  e.stopPropagation();
  if (activeFilters.has(category)) {
    activeFilters.delete(category);
  } else {
    activeFilters.add(category);
  }
  updateFilterUI();
  renderThreats();
}

function removeFilter(category, e) {
  if (e) e.stopPropagation();
  activeFilters.delete(category);
  updateFilterUI();
  renderThreats();
}

function clearAllFilters(e) {
  e.stopPropagation();
  activeFilters.clear();
  updateFilterUI();
  renderThreats();
}

function updateFilterUI() {
  // Update checkboxes
  Object.keys(categoryLabels).forEach(cat => {
    const cb = document.getElementById('fc-' + cat);
    if (cb) {
      if (activeFilters.has(cat)) {
        cb.classList.add('checked');
      } else {
        cb.classList.remove('checked');
      }
    }
  });

  // Update filter button
  const btn = document.getElementById('filterBtn');
  const countEl = document.getElementById('filterCount');
  if (activeFilters.size > 0) {
    btn.classList.add('has-filters');
    countEl.style.display = 'inline-flex';
    countEl.textContent = activeFilters.size;
  } else {
    btn.classList.remove('has-filters');
    countEl.style.display = 'none';
  }

  // Update active filter chips
  const chipsContainer = document.getElementById('activeFilters');
  if (activeFilters.size === 0) {
    chipsContainer.innerHTML = '';
  } else {
    chipsContainer.innerHTML = Array.from(activeFilters).map(cat => {
      const c = categoryLabels[cat];
      return `<span class="active-filter-chip">${c.icon} ${c.label}<span class="chip-remove" onclick="removeFilter('${cat}', event)">×</span></span>`;
    }).join('');
  }
}

function renderThreats() {
  const container = document.getElementById('threatItemsContainer');
  const emptyState = document.getElementById('threatEmptyState');

  const filtered = activeFilters.size === 0
    ? threats
    : threats.filter(t => t.categories.some(c => activeFilters.has(c)));

  if (filtered.length === 0) {
    container.innerHTML = '';
    emptyState.classList.add('visible');
    return;
  }

  emptyState.classList.remove('visible');

  // Show max 4 in the card, the rest in detail panel
  const shown = filtered.slice(0, 4);
  container.innerHTML = shown.map(t => `
    <div class="threat-item threat-item-container" onclick="event.stopPropagation(); openSingleThreatDetail('${t.id}')" style="cursor:pointer;">
      <h4>${t.title}</h4>
      <p>${t.desc}</p>
      <div style="display: flex; flex-wrap: wrap; align-items: center; gap: 4px; margin-bottom: 4px;">
        ${t.categories.map(c => `<span class="threat-category-tag">${categoryLabels[c].icon} ${categoryLabels[c].label}</span>`).join('')}
      </div>
      <span class="threat-impact ${t.impact}">${t.impactLabel}</span>
    </div>
  `).join('');

  if (filtered.length > 4) {
    container.innerHTML += `<div style="font-size: 12px; color: var(--text-muted); padding: 4px 0;">+ ${filtered.length - 4} more threats matching your filters</div>`;
  }
}

// Close dropdown when clicking outside
document.addEventListener('click', (e) => {
  const dd = document.getElementById('filterDropdown');
  const container = document.getElementById('filterContainer');
  if (dd && container && !container.contains(e.target)) {
    dd.classList.remove('open');
  }
});

// ── Project Data (Miro-realistic) ──
const projects = [
  {
    id: 'ai-canvas',
    name: 'AI-Powered Canvas Generation',
    emoji: '🤖',
    health: 'at-risk',
    healthLabel: 'At risk',
    dri: 'Alexei Petrov',
    driColor: '#6366f1',
    update: 'Figma Auto-Diagram launch accelerates timeline. LLM latency at P95 = 4.2s, target is <2s. Exploring model distillation.',
    milestone: 'Alpha release',
    milestoneStatus: 'overdue',
    milestoneDue: 'Jan 31 (overdue)',
    details: {
      description: 'Build AI-powered canvas generation that converts natural language prompts into structured diagrams, flowcharts, and visual frameworks. Critical competitive response to Figma Auto-Diagram.',
      team: '12 engineers, 2 designers, 1 PM',
      budget: '$1.8M / $2.2M spent',
      started: 'Oct 2025',
      targetLaunch: 'Mar 2026',
      updates: [
        { text: 'LLM inference latency still 2x above target — evaluating Anthropic Claude Instant for speed gains', date: 'Feb 6, 2026', color: 'red' },
        { text: 'Competitive response brief completed. Figma Auto-Diagram covers flowcharts, ERDs, and journey maps', date: 'Feb 5, 2026', color: 'yellow' },
        { text: 'Alpha internal dogfood started — 78% accuracy on structured diagram generation', date: 'Jan 28, 2026', color: 'blue' },
        { text: 'Template library for AI generation expanded to 45 diagram types', date: 'Jan 20, 2026', color: 'green' }
      ],
      milestones: [
        { name: 'Architecture & model selection', status: 'done', date: 'Nov 15, 2025' },
        { name: 'Alpha internal dogfood', status: 'done', date: 'Jan 28, 2026' },
        { name: 'Alpha release (design partners)', status: 'overdue', date: 'Jan 31, 2026' },
        { name: 'Public beta launch', status: 'in-progress', date: 'Mar 10, 2026' },
        { name: 'GA release', status: 'upcoming', date: 'Apr 15, 2026' }
      ],
      risks: [
        { title: 'LLM latency exceeds target', desc: 'P95 latency at 4.2s vs 2s target. May require architecture change or model switch.', level: 'high' },
        { title: 'Figma competitive pressure', desc: 'Figma Auto-Diagram launched 6 weeks ahead of our timeline. Market perception risk.', level: 'high' },
        { title: 'Cost per generation', desc: 'Current cost at $0.08/generation — needs to be <$0.03 for unit economics at scale.', level: 'medium' }
      ]
    }
  },
  {
    id: 'enterprise-sso',
    name: 'Enterprise SSO & SCIM Overhaul',
    emoji: '🔐',
    health: 'at-risk',
    healthLabel: 'At risk',
    dri: 'Maria Chen',
    driColor: '#ec4899',
    update: '6 enterprise deals worth $3.4M blocked on SAML IdP-initiated flow. OIDC implementation 70% complete.',
    milestone: 'SAML GA',
    milestoneStatus: 'upcoming',
    milestoneDue: 'Feb 28',
    details: {
      description: 'Overhaul enterprise identity infrastructure to support advanced SSO configurations (SAML, OIDC, SCIM provisioning) required by Fortune 500 customers.',
      team: '8 engineers, 1 designer, 1 PM',
      budget: '$920K / $1.1M spent',
      started: 'Sep 2025',
      targetLaunch: 'Mar 2026',
      updates: [
        { text: 'Salesforce flagged 6 enterprise deals ($3.4M) blocked on advanced SSO — escalated to VP Engineering', date: 'Feb 6, 2026', color: 'red' },
        { text: 'OIDC token refresh and session management passing all security audits', date: 'Feb 4, 2026', color: 'green' },
        { text: 'SCIM user provisioning tested with Okta, Azure AD, OneLogin — 3 of 4 passing', date: 'Jan 30, 2026', color: 'blue' },
        { text: 'Security pen test scheduled for Feb 14 — results needed before enterprise GA', date: 'Jan 27, 2026', color: 'yellow' }
      ],
      milestones: [
        { name: 'OIDC integration complete', status: 'done', date: 'Dec 20, 2025' },
        { name: 'SCIM provisioning beta', status: 'done', date: 'Jan 15, 2026' },
        { name: 'Security audit & pen test', status: 'in-progress', date: 'Feb 14, 2026' },
        { name: 'SAML GA release', status: 'upcoming', date: 'Feb 28, 2026' },
        { name: 'Full enterprise IdP support', status: 'upcoming', date: 'Mar 15, 2026' }
      ],
      risks: [
        { title: 'Revenue at risk', desc: '6 enterprise deals ($3.4M ARR) blocked pending SSO completion. 2 have competitor POCs in progress.', level: 'high' },
        { title: 'Pen test findings', desc: 'Security pen test may surface blocking issues requiring additional sprint to remediate.', level: 'medium' },
        { title: 'SCIM edge cases', desc: 'PingFederate SCIM integration failing on nested group sync. Affects 2 target customers.', level: 'medium' }
      ]
    }
  },
  {
    id: 'collab-cursors',
    name: 'Real-Time Collaboration Engine v3',
    emoji: '👥',
    health: 'on-track',
    healthLabel: 'On track',
    dri: 'James Okafor',
    driColor: '#059669',
    update: 'CRDT rewrite achieving <50ms sync at 200 concurrent cursors. Performance regression tests green.',
    milestone: 'Beta rollout',
    milestoneStatus: '',
    milestoneDue: 'Mar 5',
    details: {
      description: 'Complete rewrite of the real-time collaboration engine using CRDTs to support 500+ concurrent users on a single board with <100ms sync latency.',
      team: '10 engineers, 1 PM',
      budget: '$1.4M / $1.6M allocated',
      started: 'Aug 2025',
      targetLaunch: 'Apr 2026',
      updates: [
        { text: 'Load test: 200 concurrent cursors with <50ms sync. Targeting 500 by beta.', date: 'Feb 5, 2026', color: 'green' },
        { text: 'CRDT conflict resolution for sticky notes and shapes fully implemented', date: 'Feb 1, 2026', color: 'green' },
        { text: 'WebSocket connection pooling reduced server costs by 34%', date: 'Jan 25, 2026', color: 'blue' },
        { text: 'Backward compatibility layer for v2 boards completed and tested', date: 'Jan 18, 2026', color: 'green' }
      ],
      milestones: [
        { name: 'CRDT engine core', status: 'done', date: 'Nov 30, 2025' },
        { name: 'Conflict resolution for all object types', status: 'done', date: 'Jan 31, 2026' },
        { name: 'Beta rollout (10% of boards)', status: 'in-progress', date: 'Mar 5, 2026' },
        { name: 'GA rollout (all boards)', status: 'upcoming', date: 'Apr 15, 2026' }
      ],
      risks: [
        { title: 'Edge cases in offline sync', desc: 'Offline-to-online merge for complex nested frames not fully tested. Could cause data loss.', level: 'medium' },
        { title: 'Mobile performance', desc: 'iOS WebSocket memory usage 2x higher than target on large boards.', level: 'low' }
      ]
    }
  },
  {
    id: 'developer-platform',
    name: 'Developer Platform & App Marketplace',
    emoji: '🧩',
    health: 'on-track',
    healthLabel: 'On track',
    dri: 'Priya Sharma',
    driColor: '#d97706',
    update: 'SDK v3 documentation complete. 14 launch partners committed. Marketplace UI in design review.',
    milestone: 'Partner preview',
    milestoneStatus: '',
    milestoneDue: 'Feb 20',
    details: {
      description: 'Launch Miro Developer Platform with SDK v3, app marketplace, and revenue sharing model to build ecosystem moat against Figma and Microsoft.',
      team: '15 engineers, 3 designers, 2 PMs',
      budget: '$2.8M / $3.5M allocated',
      started: 'Jul 2025',
      targetLaunch: 'May 2026',
      updates: [
        { text: '14 launch partners committed including Atlassian, Asana, and Monday.com integrations', date: 'Feb 6, 2026', color: 'green' },
        { text: 'SDK v3 TypeScript-first API surface finalized — 40% less boilerplate than v2', date: 'Feb 3, 2026', color: 'green' },
        { text: 'Revenue sharing model approved: 80/20 split favoring developers for first year', date: 'Jan 28, 2026', color: 'blue' },
        { text: 'Marketplace design system review with Design VP — approved with minor revisions', date: 'Jan 22, 2026', color: 'blue' }
      ],
      milestones: [
        { name: 'SDK v3 API freeze', status: 'done', date: 'Jan 10, 2026' },
        { name: 'Documentation & dev portal', status: 'done', date: 'Feb 1, 2026' },
        { name: 'Partner preview launch', status: 'in-progress', date: 'Feb 20, 2026' },
        { name: 'Public beta marketplace', status: 'upcoming', date: 'Apr 1, 2026' },
        { name: 'GA with revenue sharing', status: 'upcoming', date: 'May 15, 2026' }
      ],
      risks: [
        { title: 'Partner app quality', desc: 'Early partner submissions show inconsistent UX quality. Need review process before marketplace opens.', level: 'medium' },
        { title: 'Canva marketplace competition', desc: 'Canva Apps marketplace has 800+ integrations. We launch with ~30. Perception risk.', level: 'low' }
      ]
    }
  },
  {
    id: 'video-collab',
    name: 'Embedded Video & Loom Integration',
    emoji: '🎥',
    health: 'needs-attention',
    healthLabel: 'Needs attention',
    dri: 'Sophie Andersen',
    driColor: '#7c3aed',
    update: 'Loom API partnership signed. Video recording in-board prototype built. WebRTC bandwidth optimization needed.',
    milestone: 'Design review',
    milestoneStatus: 'upcoming',
    milestoneDue: 'Feb 14',
    details: {
      description: 'Enable video-first async collaboration on Miro boards. Record, annotate, and comment with video — powered by Loom integration and native recording.',
      team: '6 engineers, 2 designers, 1 PM',
      budget: '$680K / $900K allocated',
      started: 'Nov 2025',
      targetLaunch: 'May 2026',
      updates: [
        { text: 'Loom partnership agreement signed — API access and co-marketing confirmed', date: 'Feb 4, 2026', color: 'green' },
        { text: 'WebRTC recording prototype working but bandwidth at 3x target for HD video', date: 'Feb 2, 2026', color: 'yellow' },
        { text: 'User research: 73% of enterprise users want async video comments on boards', date: 'Jan 26, 2026', color: 'blue' },
        { text: 'Competitive analysis: Figma has no native video. First mover advantage opportunity.', date: 'Jan 20, 2026', color: 'green' }
      ],
      milestones: [
        { name: 'Partnership & API access', status: 'done', date: 'Feb 1, 2026' },
        { name: 'Design review (VP Design)', status: 'in-progress', date: 'Feb 14, 2026' },
        { name: 'Alpha internal build', status: 'upcoming', date: 'Mar 15, 2026' },
        { name: 'Beta launch', status: 'upcoming', date: 'Apr 20, 2026' },
        { name: 'GA release', status: 'upcoming', date: 'May 30, 2026' }
      ],
      risks: [
        { title: 'WebRTC bandwidth', desc: 'HD video recording on-board consumes 3x target bandwidth. May need to fall back to SD for initial launch.', level: 'medium' },
        { title: 'Loom dependency', desc: 'Core video features depend on Loom API stability. Need fallback plan if API changes.', level: 'medium' }
      ]
    }
  },
  {
    id: 'performance',
    name: 'Canvas Performance & 60fps Rendering',
    emoji: '⚡',
    health: 'on-track',
    healthLabel: 'On track',
    dri: 'Dmitri Volkov',
    driColor: '#0891b2',
    update: 'WebGL renderer achieving 60fps with 10K objects. Memory footprint reduced 40%. Safari fixes in progress.',
    milestone: 'Perf benchmarks',
    milestoneStatus: '',
    milestoneDue: 'Feb 18',
    details: {
      description: 'Achieve consistent 60fps rendering on boards with 10,000+ objects across all browsers. Critical for enterprise customers with large-scale boards.',
      team: '5 engineers',
      budget: '$580K / $700K allocated',
      started: 'Oct 2025',
      targetLaunch: 'Mar 2026',
      updates: [
        { text: 'WebGL batch renderer: 60fps sustained with 10K objects on Chrome/Firefox. Safari at 45fps.', date: 'Feb 5, 2026', color: 'green' },
        { text: 'Memory optimization: 40% reduction in heap usage for boards with 5K+ sticky notes', date: 'Feb 1, 2026', color: 'green' },
        { text: 'Virtual viewport culling implemented — only renders visible objects + 20% buffer', date: 'Jan 24, 2026', color: 'green' },
        { text: 'Safari WebGL2 fallback path identified — separate rendering pipeline needed', date: 'Jan 18, 2026', color: 'yellow' }
      ],
      milestones: [
        { name: 'WebGL renderer prototype', status: 'done', date: 'Dec 15, 2025' },
        { name: 'Chrome/Firefox 60fps target', status: 'done', date: 'Feb 5, 2026' },
        { name: 'Performance benchmarks review', status: 'in-progress', date: 'Feb 18, 2026' },
        { name: 'Safari parity', status: 'upcoming', date: 'Mar 1, 2026' },
        { name: 'GA rollout', status: 'upcoming', date: 'Mar 20, 2026' }
      ],
      risks: [
        { title: 'Safari rendering gap', desc: 'Safari WebGL2 support is inconsistent. May ship Safari at 45fps initially.', level: 'low' }
      ]
    }
  },
  {
    id: 'templates-marketplace',
    name: 'Community Templates Marketplace',
    emoji: '📐',
    health: 'on-track',
    healthLabel: 'On track',
    dri: 'Lena Kowalski',
    driColor: '#e11d48',
    update: 'Creator program launched with 200+ template submissions. Revenue model finalized at 70/30 creator split.',
    milestone: 'Public launch',
    milestoneStatus: '',
    milestoneDue: 'Mar 1',
    details: {
      description: 'Launch community-driven templates marketplace where creators can publish and monetize Miro templates. Drives engagement and reduces empty-board drop-off.',
      team: '7 engineers, 2 designers, 1 PM',
      budget: '$750K / $950K allocated',
      started: 'Sep 2025',
      targetLaunch: 'Mar 2026',
      updates: [
        { text: 'Creator program: 200+ submissions, 85 approved. Top categories: agile, design thinking, strategy', date: 'Feb 5, 2026', color: 'green' },
        { text: 'Revenue model: 70/30 creator split approved. Stripe Connect integration live in staging', date: 'Jan 31, 2026', color: 'green' },
        { text: 'Template preview and one-click clone working across all board types', date: 'Jan 25, 2026', color: 'blue' },
        { text: 'SEO strategy: templates to be indexable — projected 15K organic visits/mo by Q3', date: 'Jan 20, 2026', color: 'blue' }
      ],
      milestones: [
        { name: 'Creator program beta', status: 'done', date: 'Jan 5, 2026' },
        { name: 'Payment infrastructure', status: 'done', date: 'Jan 31, 2026' },
        { name: 'Public marketplace launch', status: 'in-progress', date: 'Mar 1, 2026' },
        { name: 'Creator analytics dashboard', status: 'upcoming', date: 'Apr 1, 2026' }
      ],
      risks: [
        { title: 'Content moderation', desc: 'Need automated + manual review pipeline before public launch. Currently manual-only.', level: 'medium' }
      ]
    }
  },
  {
    id: 'api-v3',
    name: 'REST API v3 & GraphQL Beta',
    emoji: '🔌',
    health: 'at-risk',
    healthLabel: 'At risk',
    dri: 'Marcus Thompson',
    driColor: '#475569',
    update: 'GraphQL schema design complete but resolver performance 5x slower than REST. Rate limiting architecture under review.',
    milestone: 'API freeze',
    milestoneStatus: 'overdue',
    milestoneDue: 'Feb 1 (overdue)',
    details: {
      description: 'Launch REST API v3 with improved developer ergonomics and introduce GraphQL beta for complex data fetching patterns. Foundation for developer platform.',
      team: '6 engineers, 1 PM',
      budget: '$620K / $800K allocated',
      started: 'Oct 2025',
      targetLaunch: 'Apr 2026',
      updates: [
        { text: 'GraphQL resolver performance issue: N+1 queries causing 5x latency vs REST. DataLoader implementation in progress', date: 'Feb 6, 2026', color: 'red' },
        { text: 'REST v3 endpoints for boards, items, and users complete and documented', date: 'Feb 2, 2026', color: 'green' },
        { text: 'Rate limiting: token bucket algorithm selected. Need to decide on per-app vs per-user limits', date: 'Jan 28, 2026', color: 'yellow' },
        { text: 'API versioning strategy: URL-based (v3/) with sunset headers for v2 deprecation', date: 'Jan 20, 2026', color: 'blue' }
      ],
      milestones: [
        { name: 'REST v3 endpoint design', status: 'done', date: 'Dec 15, 2025' },
        { name: 'API surface freeze', status: 'overdue', date: 'Feb 1, 2026' },
        { name: 'GraphQL beta schema', status: 'in-progress', date: 'Feb 28, 2026' },
        { name: 'Developer preview', status: 'upcoming', date: 'Mar 15, 2026' },
        { name: 'GA release', status: 'upcoming', date: 'Apr 15, 2026' }
      ],
      risks: [
        { title: 'GraphQL performance', desc: 'Resolver N+1 problem causing 5x latency. May need to defer GraphQL to v3.1 if not resolved by Feb 15.', level: 'high' },
        { title: 'API freeze slippage', desc: 'API freeze missed by 5 days. Developer platform team blocked on stable API contract.', level: 'medium' }
      ]
    }
  },
  {
    id: 'mobile-redesign',
    name: 'Mobile App Redesign (iOS & Android)',
    emoji: '📱',
    health: 'on-track',
    healthLabel: 'On track',
    dri: 'Nina Patel',
    driColor: '#16a34a',
    update: 'New gesture-based navigation shipped to 5% of iOS users. Engagement up 28% in test cohort. Android build 2 weeks behind.',
    milestone: 'iOS 50% rollout',
    milestoneStatus: '',
    milestoneDue: 'Feb 25',
    details: {
      description: 'Complete redesign of Miro mobile apps with gesture-based navigation, offline support, and feature parity for core whiteboarding actions.',
      team: '8 engineers (4 iOS, 4 Android), 2 designers, 1 PM',
      budget: '$1.2M / $1.5M allocated',
      started: 'Aug 2025',
      targetLaunch: 'Apr 2026',
      updates: [
        { text: 'iOS 5% rollout: session duration +28%, board creation +15%. No P0 bugs reported.', date: 'Feb 5, 2026', color: 'green' },
        { text: 'Android gesture navigation implementation 2 weeks behind iOS due to fragment lifecycle issues', date: 'Feb 3, 2026', color: 'yellow' },
        { text: 'Offline mode: boards sync reliably with <5s merge time on reconnect', date: 'Jan 28, 2026', color: 'green' },
        { text: 'App Store rating improved from 3.8 to 4.2 in beta test flight cohort', date: 'Jan 22, 2026', color: 'green' }
      ],
      milestones: [
        { name: 'Design system for mobile', status: 'done', date: 'Nov 15, 2025' },
        { name: 'iOS 5% canary rollout', status: 'done', date: 'Feb 1, 2026' },
        { name: 'iOS 50% rollout', status: 'in-progress', date: 'Feb 25, 2026' },
        { name: 'Android beta launch', status: 'upcoming', date: 'Mar 10, 2026' },
        { name: 'Full GA (iOS + Android)', status: 'upcoming', date: 'Apr 15, 2026' }
      ],
      risks: [
        { title: 'Android timeline gap', desc: 'Android 2 weeks behind iOS. Risk of shipping iOS-only for initial GA if gap widens.', level: 'medium' }
      ]
    }
  }
];

// ── Render Project Table ──
function renderProjects() {
  const tbody = document.getElementById('projectTableBody');
  tbody.innerHTML = projects.map(p => `
    <tr onclick="openProjectDetail('${p.id}')">
      <td>
        <div class="project-name">
          <span class="emoji">${p.emoji}</span>
          ${p.name}
          <svg class="link-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M18 13v6a2 2 0 01-2 2H5a2 2 0 01-2-2V8a2 2 0 012-2h6"/><polyline points="15 3 21 3 21 9"/><line x1="10" y1="14" x2="21" y2="3"/></svg>
        </div>
      </td>
      <td><span class="health-badge ${p.health}">${p.healthLabel}</span></td>
      <td>
        <div class="dri">
          <div class="dri-avatar" style="background: ${p.driColor}">${p.dri.split(' ').map(n => n[0]).join('')}</div>
          <span class="dri-name">${p.dri}</span>
        </div>
      </td>
      <td><span class="latest-update">${p.update}</span></td>
      <td><span class="milestone-badge ${p.milestoneStatus}">${p.milestone} · ${p.milestoneDue}</span></td>
    </tr>
  `).join('');
}

// ── Detail Panel Logic ──
function openDetail() {
  document.getElementById('detailOverlay').classList.add('active');
  document.getElementById('detailPanel').classList.add('active');
}

function closeDetail() {
  document.getElementById('detailOverlay').classList.remove('active');
  document.getElementById('detailPanel').classList.remove('active');
}

function openProjectDetail(projectId) {
  const p = projects.find(pr => pr.id === projectId);
  if (!p) return;

  document.getElementById('detailTitle').innerHTML = `${p.emoji} ${p.name}`;
  document.getElementById('detailSubtitle').textContent = `DRI: ${p.dri} · ${p.details.team}`;

  const body = document.getElementById('detailBody');
  body.innerHTML = `
    <div class="detail-section">
      <h3>Overview</h3>
      <p style="font-size: 13px; color: var(--text-secondary); line-height: 1.7; margin-bottom: 16px;">${p.details.description}</p>
      <div class="detail-meta">
        <div class="detail-meta-item">
          <div class="label">Health</div>
          <div class="value"><span class="health-badge ${p.health}">${p.healthLabel}</span></div>
        </div>
        <div class="detail-meta-item">
          <div class="label">Budget</div>
          <div class="value" style="font-size: 13px;">${p.details.budget}</div>
        </div>
        <div class="detail-meta-item">
          <div class="label">Started</div>
          <div class="value" style="font-size: 13px;">${p.details.started}</div>
        </div>
        <div class="detail-meta-item">
          <div class="label">Target Launch</div>
          <div class="value" style="font-size: 13px;">${p.details.targetLaunch}</div>
        </div>
      </div>
    </div>

    <div class="detail-section">
      <h3>Recent Updates</h3>
      <ul class="detail-updates">
        ${p.details.updates.map(u => `
          <li>
            <span class="update-dot ${u.color}"></span>
            <div class="update-content">
              <div class="update-text">${u.text}</div>
              <div class="update-date">${u.date}</div>
            </div>
          </li>
        `).join('')}
      </ul>
    </div>

    <div class="detail-section">
      <h3>Milestones</h3>
      <ul class="detail-milestones">
        ${p.details.milestones.map(m => `
          <li>
            <div>
              <div class="milestone-name">${m.name}</div>
              <div class="milestone-date">${m.date}</div>
            </div>
            <span class="milestone-status ${m.status}">${m.status === 'done' ? '✓ Done' : m.status === 'in-progress' ? '● In Progress' : m.status === 'overdue' ? '⚠ Overdue' : '○ Upcoming'}</span>
          </li>
        `).join('')}
      </ul>
    </div>

    ${p.details.risks.length ? `
    <div class="detail-section">
      <h3>Risks & Blockers</h3>
      <ul class="detail-risks">
        ${p.details.risks.map(r => `
          <li class="${r.level}">
            <div class="risk-title">${r.title}</div>
            <div class="risk-desc">${r.desc}</div>
          </li>
        `).join('')}
      </ul>
    </div>
    ` : ''}
  `;

  openDetail();
}

// ── Threat Detail ──
function openThreatDetail() {
  const filtered = activeFilters.size === 0
    ? threats
    : threats.filter(t => t.categories.some(c => activeFilters.has(c)));

  const filterLabel = activeFilters.size > 0
    ? ` · Filtered: ${Array.from(activeFilters).map(c => categoryLabels[c].label).join(', ')}`
    : '';

  document.getElementById('detailTitle').innerHTML = '⚠ Competitive Intelligence Brief';
  document.getElementById('detailSubtitle').textContent = `Updated Feb 7, 2026 · ${filtered.length} threats${filterLabel}`;

  const impactColors = {
    high: { bg: 'var(--red-bg)', border: 'var(--red)', label: 'HIGH THREAT', color: 'var(--red-text)' },
    medium: { bg: 'var(--orange-bg)', border: 'var(--orange)', label: 'MEDIUM THREAT', color: 'var(--orange-text)' },
    low: { bg: 'var(--yellow-bg)', border: 'var(--yellow)', label: 'WATCH', color: 'var(--yellow-text)' }
  };

  // Extended details for some threats (the rich ones)
  const threatExtras = {
    'figma-autodiagram': `
      <p style="font-size: 13px; color: var(--text-secondary); line-height: 1.7; margin-bottom: 12px;">
        Figma announced <strong>Auto-Diagram</strong> at Config 2026 on Feb 4. The feature uses AI to convert natural language prompts into structured diagrams — flowcharts, ERDs, architecture diagrams, journey maps, and org charts — directly inside FigJam.
      </p>
      <p style="font-size: 13px; color: var(--text-secondary); line-height: 1.7; margin-bottom: 12px;">
        <strong>Key capabilities:</strong> Text-to-diagram, auto-layout with snap-to-grid, AI-suggested connections between nodes, export to Figma design files.
      </p>
      <p style="font-size: 13px; color: var(--text-secondary); line-height: 1.7; margin-bottom: 8px;">
        <strong>Early reception:</strong> 60% faster diagramming cited in beta reviews. Product Hunt #1 of the day.
      </p>
      <div style="margin-top: 8px;">
        <div class="detail-meta" style="grid-template-columns: 1fr 1fr 1fr;">
          <div class="detail-meta-item"><div class="label">ARR at Risk</div><div class="value" style="color: var(--red);">$8.2M</div></div>
          <div class="detail-meta-item"><div class="label">Deals Affected</div><div class="value">14 pipeline</div></div>
          <div class="detail-meta-item"><div class="label">Segments</div><div class="value" style="font-size: 12px;">Mid-market, Enterprise</div></div>
        </div>
      </div>`,
    'ms-copilot-whiteboard': `
      <p style="font-size: 13px; color: var(--text-secondary); line-height: 1.7; margin-bottom: 12px;">
        <strong>Distribution advantage:</strong> 40M+ potential enterprise users on day one through existing M365 licenses. Zero incremental cost for IT procurement. Deep Teams integration.
      </p>
      <p style="font-size: 13px; color: var(--text-secondary); line-height: 1.7; margin-bottom: 8px;">
        <strong>Weaknesses:</strong> Limited template library (~50 vs Miro's 2,500+), no developer API, poor mobile experience.
      </p>
      <div style="margin-top: 8px;">
        <div class="detail-meta" style="grid-template-columns: 1fr 1fr;">
          <div class="detail-meta-item"><div class="label">ARR at Risk</div><div class="value" style="color: var(--red);">$5.4M</div></div>
          <div class="detail-meta-item"><div class="label">Accounts Evaluating</div><div class="value">8 enterprise</div></div>
        </div>
      </div>`,
    'monday-whiteboard': `
      <p style="font-size: 13px; color: var(--text-secondary); line-height: 1.7; margin-bottom: 12px;">
        Monday's combined whiteboard + project board approach collapses the workflow from "brainstorm in Miro → create tasks in Monday" into a single tool. Bidirectional sync means items created on the whiteboard instantly appear on project boards.
      </p>
      <p style="font-size: 13px; color: var(--text-secondary); line-height: 1.7; margin-bottom: 8px;">
        <strong>Risk:</strong> Monday has 225K+ customers. Their "work OS" positioning directly targets the planning-to-execution gap that Miro fills.
      </p>
      <div style="margin-top: 8px;">
        <div class="detail-meta" style="grid-template-columns: 1fr 1fr;">
          <div class="detail-meta-item"><div class="label">ARR at Risk</div><div class="value" style="color: var(--orange);">$3.1M</div></div>
          <div class="detail-meta-item"><div class="label">Overlap Accounts</div><div class="value">42 shared customers</div></div>
        </div>
      </div>`,
    'productboard-roadmap-ai': `
      <p style="font-size: 13px; color: var(--text-secondary); line-height: 1.7; margin-bottom: 12px;">
        Productboard's AI Roadmap Generator creates prioritized roadmaps from customer feedback — a use case many teams currently do in Miro workshops. Their integration with Salesforce and Intercom feeds real signal into prioritization.
      </p>
      <p style="font-size: 13px; color: var(--text-secondary); line-height: 1.7; margin-bottom: 8px;">
        <strong>Target user:</strong> Product managers who run quarterly planning in Miro but want data-driven prioritization built in.
      </p>`,
    'jira-visual-roadmap': `
      <p style="font-size: 13px; color: var(--text-secondary); line-height: 1.7; margin-bottom: 12px;">
        Atlassian's native visual roadmaps in Jira remove a key reason teams use Miro — visualizing sprints, epics, and dependencies on a shared canvas. The Confluence whiteboard integration creates a seamless brainstorm-to-backlog pipeline.
      </p>
      <p style="font-size: 13px; color: var(--text-secondary); line-height: 1.7; margin-bottom: 8px;">
        <strong>Scale:</strong> 300K+ Jira customers. Bundled at no extra cost with Jira Premium.
      </p>
      <div style="margin-top: 8px;">
        <div class="detail-meta" style="grid-template-columns: 1fr 1fr;">
          <div class="detail-meta-item"><div class="label">ARR at Risk</div><div class="value" style="color: var(--red);">$4.6M</div></div>
          <div class="detail-meta-item"><div class="label">Overlap</div><div class="value" style="font-size: 12px;">68% of Miro users also use Jira</div></div>
        </div>
      </div>`
  };

  const threatCards = filtered.map(t => {
    const ic = impactColors[t.impact];
    const extra = threatExtras[t.id] || `<p style="font-size: 13px; color: var(--text-secondary); line-height: 1.7; margin-bottom: 8px;">${t.desc}</p>`;
    return `
      <div style="padding: 16px; background: ${ic.bg}; border-radius: var(--radius-sm); border-left: 3px solid ${ic.border}; margin-bottom: 16px;">
        <div style="font-size: 10px; font-weight: 600; color: ${ic.color}; margin-bottom: 4px;">${ic.label}</div>
        <h4 style="font-size: 14px; font-weight: 600; color: var(--text); margin-bottom: 8px;">${t.title}</h4>
        <div style="display: flex; flex-wrap: wrap; gap: 4px; margin-bottom: 10px;">
          ${t.categories.map(c => `<span class="threat-category-tag">${categoryLabels[c].icon} ${categoryLabels[c].label}</span>`).join('')}
        </div>
        ${extra}
      </div>`;
  }).join('');

  const body = document.getElementById('detailBody');
  body.innerHTML = `
    <div class="threat-detail-body" style="padding: 0;">
      <div class="detail-section">
        ${threatCards}
      </div>

      <!-- Keep deal signals and milestone slips from original -->
      <div class="detail-section">
        <h3>Deal Signals This Week</h3>
        <ul class="detail-risks">
          <li class="high">
            <div class="risk-title">Accenture ($420K ARR) — evaluating FigJam after Config announcement</div>
            <div class="risk-desc">Champion confirmed their design org is running a FigJam POC. Renewal in 60 days. CSM escalated.</div>
          </li>
          <li class="high">
            <div class="risk-title">Deloitte ($380K ARR) — IT flagging "M365 consolidation" initiative</div>
            <div class="risk-desc">CIO office reviewing all non-M365 tools. Miro on the review list alongside Slack and Zoom.</div>
          </li>
          <li class="medium">
            <div class="risk-title">Spotify ($290K ARR) — asking about AI diagramming timeline</div>
            <div class="risk-desc">Product org lead asked when Miro will have AI-powered diagramming. Will evaluate alternatives if no roadmap by Q2.</div>
          </li>
          <li class="medium">
            <div class="risk-title">BMW Group ($510K ARR) — SSO blocker on expansion deal</div>
            <div class="risk-desc">$510K expansion deal paused until SAML IdP-initiated flow is available.</div>
          </li>
          <li class="medium">
            <div class="risk-title">Stripe ($420K ARR) — evaluating Monday.com for combined planning + PM</div>
            <div class="risk-desc">Eng ops team testing Monday.com as single tool for roadmapping + project tracking. Current Miro usage is roadmap-heavy.</div>
          </li>
          <li class="low">
            <div class="risk-title">Shopify ($180K ARR) — positive signal, expanding to 3 new teams</div>
            <div class="risk-desc">Expansion deal progressing. Developer platform interest high.</div>
          </li>
        </ul>
      </div>

      <div class="detail-section">
        <h3>Milestone Slips This Week</h3>
        <ul class="detail-updates">
          <li>
            <span class="update-dot red"></span>
            <div class="update-content">
              <div class="update-text"><strong>AI Canvas Generation</strong> — Alpha release slipped 7 days (Jan 31 → ongoing). LLM latency blocking.</div>
              <div class="update-date">Slipped Feb 1, 2026</div>
            </div>
          </li>
          <li>
            <span class="update-dot red"></span>
            <div class="update-content">
              <div class="update-text"><strong>REST API v3</strong> — API surface freeze missed by 5 days. GraphQL N+1 issue blocking.</div>
              <div class="update-date">Slipped Feb 1, 2026</div>
            </div>
          </li>
          <li>
            <span class="update-dot yellow"></span>
            <div class="update-content">
              <div class="update-text"><strong>Mobile Redesign</strong> — Android build 2 weeks behind iOS.</div>
              <div class="update-date">Flagged Feb 3, 2026</div>
            </div>
          </li>
          <li>
            <span class="update-dot yellow"></span>
            <div class="update-content">
              <div class="update-text"><strong>Enterprise SSO</strong> — Pen test pushed 1 week. SAML GA may slip to early March.</div>
              <div class="update-date">Flagged Feb 4, 2026</div>
            </div>
          </li>
        </ul>
      </div>
    </div>
  `;

  openDetail();
}

// ── Single Threat Detail ──
function openSingleThreatDetail(threatId) {
  const t = threats.find(th => th.id === threatId);
  if (!t || !t.detail) return;

  const d = t.detail;
  const impactColors = {
    high: { bg: 'var(--red-bg)', color: 'var(--red-text)', label: 'HIGH THREAT' },
    medium: { bg: 'var(--orange-bg)', color: 'var(--orange-text)', label: 'MEDIUM THREAT' },
    low: { bg: 'var(--yellow-bg)', color: 'var(--yellow-text)', label: 'WATCH' }
  };
  const ic = impactColors[t.impact];

  const linkIcons = {
    press: { icon: '📰', label: 'Press' },
    blog: { icon: '✍️', label: 'Blog' },
    docs: { icon: '📖', label: 'Docs' },
    video: { icon: '🎬', label: 'Video' },
    product: { icon: '🔗', label: 'Product' }
  };

  const carouselId = 'carousel-' + threatId;

  document.getElementById('detailTitle').innerHTML = t.title;
  document.getElementById('detailSubtitle').textContent = `${d.competitor} · Launched ${d.launched}`;

  const body = document.getElementById('detailBody');
  body.innerHTML = `
    <div class="back-to-all" onclick="openThreatDetail()">← Back to all threats</div>

    <div style="display: flex; flex-wrap: wrap; gap: 4px; margin-bottom: 12px;">
      <span style="display: inline-flex; align-items: center; gap: 4px; font-size: 11px; font-weight: 600; padding: 3px 10px; border-radius: 4px; background: ${ic.bg}; color: ${ic.color};">${ic.label}</span>
      ${t.categories.map(c => `<span class="threat-category-tag">${categoryLabels[c].icon} ${categoryLabels[c].label}</span>`).join('')}
    </div>

    <div class="detail-section">
      <h3>Feature Summary</h3>
      <div style="font-size: 13px; color: var(--text-secondary); line-height: 1.75; white-space: pre-line;">${d.summary}</div>
    </div>

    ${d.screenshots && d.screenshots.length > 0 ? `
    <div class="detail-section">
      <h3>Screenshots</h3>
      <div class="carousel" id="${carouselId}">
        <div class="carousel-track" id="${carouselId}-track">
          ${d.screenshots.map((s, i) => `
            <div class="carousel-slide">
              <img src="${s.url}" alt="Screenshot ${i + 1}" loading="lazy" />
              <div class="slide-caption">${s.caption}</div>
            </div>
          `).join('')}
        </div>
        ${d.screenshots.length > 1 ? `
        <button class="carousel-btn prev" onclick="carouselPrev('${carouselId}')">
          <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"><polyline points="15 18 9 12 15 6"/></svg>
        </button>
        <button class="carousel-btn next" onclick="carouselNext('${carouselId}')">
          <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"><polyline points="9 18 15 12 9 6"/></svg>
        </button>
        <div class="carousel-dots" id="${carouselId}-dots">
          ${d.screenshots.map((_, i) => `<div class="carousel-dot ${i === 0 ? 'active' : ''}" onclick="carouselGoTo('${carouselId}', ${i})"></div>`).join('')}
        </div>
        ` : ''}
      </div>
    </div>
    ` : ''}

    <div class="detail-section">
      <h3>Resources & Documentation</h3>
      <ul class="resource-links">
        ${d.links.map(l => {
          const li = linkIcons[l.type] || linkIcons.blog;
          return `
            <a class="resource-link" href="${l.url}" target="_blank" rel="noopener">
              <div class="resource-link-icon ${l.type}">${li.icon}</div>
              <div class="resource-link-info">
                <div class="resource-link-title">${l.title}</div>
                <div class="resource-link-meta">${l.source} · ${l.date}</div>
              </div>
              <span class="resource-link-arrow">→</span>
            </a>`;
        }).join('')}
      </ul>
    </div>
  `;

  // Init carousel state
  if (d.screenshots && d.screenshots.length > 1) {
    carouselStates[carouselId] = { current: 0, total: d.screenshots.length };
  }

  openDetail();
}

// ── Carousel Logic ──
const carouselStates = {};

function carouselNext(id) {
  const state = carouselStates[id];
  if (!state) return;
  state.current = (state.current + 1) % state.total;
  carouselUpdate(id);
}

function carouselPrev(id) {
  const state = carouselStates[id];
  if (!state) return;
  state.current = (state.current - 1 + state.total) % state.total;
  carouselUpdate(id);
}

function carouselGoTo(id, index) {
  const state = carouselStates[id];
  if (!state) return;
  state.current = index;
  carouselUpdate(id);
}

function carouselUpdate(id) {
  const state = carouselStates[id];
  if (!state) return;
  const track = document.getElementById(id + '-track');
  const dots = document.getElementById(id + '-dots');
  if (track) {
    track.style.transform = `translateX(-${state.current * 100}%)`;
  }
  if (dots) {
    dots.querySelectorAll('.carousel-dot').forEach((dot, i) => {
      dot.classList.toggle('active', i === state.current);
    });
  }
}

// ── Stat Detail ──
function openStatDetail(type) {
  if (type === 'health') openHealthDetail();
  else if (type === 'nps') openNPSDetail();
  else if (type === 'budget') openBudgetDetail();
}

// ── Portfolio Health Detail ──
function openHealthDetail() {
  document.getElementById('detailTitle').textContent = '📊 Portfolio Health';
  document.getElementById('detailSubtitle').textContent = '72% healthy · 3 projects slipped this week · Feb 7, 2026';

  const slackSvg = '<svg class="slack-icon" viewBox="0 0 24 24" fill="none"><path d="M14.5 2a2.5 2.5 0 00-2.5 2.5V9h2.5A2.5 2.5 0 0014.5 4V2z" fill="#E01E5A"/><path d="M2 14.5A2.5 2.5 0 004.5 17H9v-2.5A2.5 2.5 0 006.5 12H2z" fill="#36C5F0"/><path d="M9.5 22a2.5 2.5 0 002.5-2.5V15H9.5A2.5 2.5 0 009.5 20v2z" fill="#2EB67D"/><path d="M22 9.5A2.5 2.5 0 0019.5 7H15v2.5A2.5 2.5 0 0017.5 12H22z" fill="#ECB22E"/><path d="M4.5 12A2.5 2.5 0 002 9.5 2.5 2.5 0 004.5 7H7v2.5A2.5 2.5 0 014.5 12z" fill="#36C5F0"/><path d="M12 4.5A2.5 2.5 0 009.5 2 2.5 2.5 0 007 4.5V7h2.5A2.5 2.5 0 0012 4.5z" fill="#E01E5A"/><path d="M19.5 12a2.5 2.5 0 002.5 2.5 2.5 2.5 0 00-2.5 2.5H17v-2.5a2.5 2.5 0 012.5-2.5z" fill="#ECB22E"/><path d="M12 19.5a2.5 2.5 0 002.5 2.5 2.5 2.5 0 002.5-2.5V17h-2.5A2.5 2.5 0 0012 19.5z" fill="#2EB67D"/></svg>';

  document.getElementById('detailBody').innerHTML = `
    <div class="detail-section">
      <h3>Health Distribution</h3>
      <div class="detail-meta">
        <div class="detail-meta-item">
          <div class="label">On Track</div>
          <div class="value" style="color: var(--green);">5 projects</div>
        </div>
        <div class="detail-meta-item">
          <div class="label">Needs Attention</div>
          <div class="value" style="color: var(--yellow);">1 project</div>
        </div>
        <div class="detail-meta-item">
          <div class="label">At Risk</div>
          <div class="value" style="color: var(--red);">3 projects</div>
        </div>
        <div class="detail-meta-item">
          <div class="label">Trend</div>
          <div class="value" style="color: var(--red); font-size: 13px;">↓ 4pts vs last week</div>
        </div>
      </div>
    </div>

    <div class="detail-section">
      <h3>Projects That Slipped This Week</h3>

      <!-- Slip 1: AI Canvas -->
      <div class="slip-card">
        <div class="slip-card-header">
          <h4>🤖 AI-Powered Canvas Generation <span class="slip-badge">7 days overdue</span></h4>
        </div>
        <p>Alpha release was due Jan 31 and has not shipped. The project moved from "On Track" to "At Risk" this week.</p>
        <div class="slip-reason">
          <strong>Root cause:</strong> LLM inference latency at P95 = 4.2s, which is 2x above the 2s target. The team explored three model providers but none met the latency threshold without sacrificing diagram accuracy. A model distillation sprint was started Feb 5 but needs 2 more weeks.
        </div>
        <div class="slip-suggestion">Reach out for more context:</div>
        <div class="slack-pills">
          <a class="slack-pill" href="slack://user?team=T02ABC123&id=U05PETROV" title="DM Alexei Petrov on Slack">
            <div class="pill-avatar" style="background: #6366f1;">AP</div>
            <div class="pill-info">
              <span class="pill-name">Alexei Petrov</span>
              <span class="pill-role">DRI · Staff Engineer</span>
            </div>
            <span class="pill-arrow">→</span>
          </a>
          <a class="slack-pill" href="slack://user?team=T02ABC123&id=U05KIMURA" title="DM Yuki Kimura on Slack">
            <div class="pill-avatar" style="background: #8b5cf6;">YK</div>
            <div class="pill-info">
              <span class="pill-name">Yuki Kimura</span>
              <span class="pill-role">ML Lead · Latency owner</span>
            </div>
            <span class="pill-arrow">→</span>
          </a>
          <a class="slack-pill slack-channel-pill" href="slack://channel?team=T02ABC123&id=C06AIDIAG" title="Open #proj-ai-canvas channel">
            <span class="channel-hash">#</span>
            <div class="pill-info">
              <span class="pill-name">proj-ai-canvas</span>
              <span class="pill-role">32 members · Active now</span>
            </div>
            <span class="pill-arrow">→</span>
          </a>
        </div>
      </div>

      <!-- Slip 2: API v3 -->
      <div class="slip-card">
        <div class="slip-card-header">
          <h4>🔌 REST API v3 & GraphQL Beta <span class="slip-badge">5 days overdue</span></h4>
        </div>
        <p>API surface freeze was due Feb 1 and has been missed. Developer platform team is blocked on a stable API contract.</p>
        <div class="slip-reason">
          <strong>Root cause:</strong> GraphQL resolver layer has an N+1 query problem causing 5x latency vs the REST endpoints. The team is implementing DataLoader batching but discovered the board object graph requires custom batch strategies for nested frames and sticky notes. The REST v3 endpoints are ready but the combined freeze was deferred.
        </div>
        <div class="slip-suggestion">Reach out for more context:</div>
        <div class="slack-pills">
          <a class="slack-pill" href="slack://user?team=T02ABC123&id=U05THOMPSON" title="DM Marcus Thompson on Slack">
            <div class="pill-avatar" style="background: #475569;">MT</div>
            <div class="pill-info">
              <span class="pill-name">Marcus Thompson</span>
              <span class="pill-role">DRI · Senior Engineer</span>
            </div>
            <span class="pill-arrow">→</span>
          </a>
          <a class="slack-pill" href="slack://user?team=T02ABC123&id=U05SHARMA" title="DM Priya Sharma on Slack">
            <div class="pill-avatar" style="background: #d97706;">PS</div>
            <div class="pill-info">
              <span class="pill-name">Priya Sharma</span>
              <span class="pill-role">Dev Platform PM · Blocked</span>
            </div>
            <span class="pill-arrow">→</span>
          </a>
          <a class="slack-pill slack-channel-pill" href="slack://channel?team=T02ABC123&id=C06APIV3" title="Open #proj-api-v3 channel">
            <span class="channel-hash">#</span>
            <div class="pill-info">
              <span class="pill-name">proj-api-v3</span>
              <span class="pill-role">18 members · Active now</span>
            </div>
            <span class="pill-arrow">→</span>
          </a>
        </div>
      </div>

      <!-- Slip 3: Enterprise SSO -->
      <div class="slip-card">
        <div class="slip-card-header">
          <h4>🔐 Enterprise SSO — Pen Test Delay <span class="slip-badge">Slipping 1 week</span></h4>
        </div>
        <p>Security pen test pushed from Feb 7 to Feb 14. SAML GA (Feb 28) at risk of slipping to early March. $3.4M in deals waiting.</p>
        <div class="slip-reason">
          <strong>Root cause:</strong> The external pen test firm (NCC Group) flagged a scheduling conflict and pushed the engagement one week. Internally, the SCIM provisioning layer for PingFederate failed nested group sync tests, requiring a fix before the pen test scope can be finalized. Maria's team is running a fix sprint this weekend.
        </div>
        <div class="slip-suggestion">Reach out for more context:</div>
        <div class="slack-pills">
          <a class="slack-pill" href="slack://user?team=T02ABC123&id=U05CHEN" title="DM Maria Chen on Slack">
            <div class="pill-avatar" style="background: #ec4899;">MC</div>
            <div class="pill-info">
              <span class="pill-name">Maria Chen</span>
              <span class="pill-role">DRI · Engineering Manager</span>
            </div>
            <span class="pill-arrow">→</span>
          </a>
          <a class="slack-pill" href="slack://user?team=T02ABC123&id=U05REID" title="DM Tom Reid on Slack">
            <div class="pill-avatar" style="background: #0891b2;">TR</div>
            <div class="pill-info">
              <span class="pill-name">Tom Reid</span>
              <span class="pill-role">Security Lead · Pen test coord</span>
            </div>
            <span class="pill-arrow">→</span>
          </a>
          <a class="slack-pill" href="slack://user?team=T02ABC123&id=U05KWON" title="DM Sarah Kwon on Slack">
            <div class="pill-avatar" style="background: #f59e0b;">SK</div>
            <div class="pill-info">
              <span class="pill-name">Sarah Kwon</span>
              <span class="pill-role">Enterprise Sales · Deal owner</span>
            </div>
            <span class="pill-arrow">→</span>
          </a>
          <a class="slack-pill slack-channel-pill" href="slack://channel?team=T02ABC123&id=C06SSO" title="Open #proj-enterprise-sso channel">
            <span class="channel-hash">#</span>
            <div class="pill-info">
              <span class="pill-name">proj-enterprise-sso</span>
              <span class="pill-role">24 members · Active now</span>
            </div>
            <span class="pill-arrow">→</span>
          </a>
        </div>
      </div>
    </div>
  `;

  openDetail();
}

// ── NPS Detail ──
function openNPSDetail() {
  document.getElementById('detailTitle').textContent = '📈 NPS Trend & Analysis';
  document.getElementById('detailSubtitle').textContent = '+15 overall · +3pts vs January · Source: Delighted survey (n=2,847)';

  document.getElementById('detailBody').innerHTML = `
    <div class="detail-section">
      <div class="nps-chart-container">
        <div class="nps-chart-header">
          <h4>NPS Score — Rolling 6 Months</h4>
          <div class="nps-chart-legend">
            <span><span class="dot" style="background: #4f46e5;"></span> Overall</span>
            <span><span class="dot" style="background: #16a34a;"></span> Enterprise</span>
            <span><span class="dot" style="background: #f59e0b;"></span> SMB</span>
          </div>
        </div>
        <svg class="chart-svg" viewBox="0 0 520 200" style="height: 200px;">
          <!-- Grid lines -->
          <line x1="40" y1="20" x2="500" y2="20" stroke="#f0f0eb" stroke-width="1"/>
          <line x1="40" y1="60" x2="500" y2="60" stroke="#f0f0eb" stroke-width="1"/>
          <line x1="40" y1="100" x2="500" y2="100" stroke="#f0f0eb" stroke-width="1" stroke-dasharray="4,4"/>
          <line x1="40" y1="140" x2="500" y2="140" stroke="#f0f0eb" stroke-width="1"/>
          <line x1="40" y1="180" x2="500" y2="180" stroke="#f0f0eb" stroke-width="1"/>

          <!-- Y axis labels -->
          <text x="32" y="24" text-anchor="end" fill="#9ca3af" font-size="10" font-family="Inter">+30</text>
          <text x="32" y="64" text-anchor="end" fill="#9ca3af" font-size="10" font-family="Inter">+20</text>
          <text x="32" y="104" text-anchor="end" fill="#9ca3af" font-size="10" font-family="Inter">+10</text>
          <text x="32" y="144" text-anchor="end" fill="#9ca3af" font-size="10" font-family="Inter">0</text>
          <text x="32" y="184" text-anchor="end" fill="#9ca3af" font-size="10" font-family="Inter">-10</text>

          <!-- X axis labels -->
          <text x="80" y="198" text-anchor="middle" fill="#9ca3af" font-size="10" font-family="Inter">Sep</text>
          <text x="164" y="198" text-anchor="middle" fill="#9ca3af" font-size="10" font-family="Inter">Oct</text>
          <text x="248" y="198" text-anchor="middle" fill="#9ca3af" font-size="10" font-family="Inter">Nov</text>
          <text x="332" y="198" text-anchor="middle" fill="#9ca3af" font-size="10" font-family="Inter">Dec</text>
          <text x="416" y="198" text-anchor="middle" fill="#9ca3af" font-size="10" font-family="Inter">Jan</text>
          <text x="490" y="198" text-anchor="middle" fill="#9ca3af" font-size="10" font-family="Inter">Feb</text>

          <!-- Enterprise line (green) — trending up strongly -->
          <polyline points="80,108 164,100 248,88 332,72 416,56 490,36" fill="none" stroke="#16a34a" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
          <circle cx="80" cy="108" r="3" fill="#16a34a"/>
          <circle cx="164" cy="100" r="3" fill="#16a34a"/>
          <circle cx="248" cy="88" r="3" fill="#16a34a"/>
          <circle cx="332" cy="72" r="3" fill="#16a34a"/>
          <circle cx="416" cy="56" r="3" fill="#16a34a"/>
          <circle cx="490" cy="36" r="4" fill="#16a34a" stroke="#fff" stroke-width="2"/>
          <text x="498" y="32" fill="#16a34a" font-size="11" font-weight="600" font-family="Inter">+22</text>

          <!-- Overall line (indigo) — moderate uptrend -->
          <polyline points="80,124 164,120 248,116 332,112 416,104 490,88" fill="none" stroke="#4f46e5" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round"/>
          <circle cx="80" cy="124" r="3" fill="#4f46e5"/>
          <circle cx="164" cy="120" r="3" fill="#4f46e5"/>
          <circle cx="248" cy="116" r="3" fill="#4f46e5"/>
          <circle cx="332" cy="112" r="3" fill="#4f46e5"/>
          <circle cx="416" cy="104" r="3" fill="#4f46e5"/>
          <circle cx="490" cy="88" r="4" fill="#4f46e5" stroke="#fff" stroke-width="2"/>
          <text x="498" y="84" fill="#4f46e5" font-size="11" font-weight="600" font-family="Inter">+15</text>

          <!-- SMB line (amber) — mostly flat -->
          <polyline points="80,132 164,136 248,132 332,128 416,120 490,116" fill="none" stroke="#f59e0b" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" stroke-dasharray="6,3"/>
          <circle cx="80" cy="132" r="3" fill="#f59e0b"/>
          <circle cx="164" cy="136" r="3" fill="#f59e0b"/>
          <circle cx="248" cy="132" r="3" fill="#f59e0b"/>
          <circle cx="332" cy="128" r="3" fill="#f59e0b"/>
          <circle cx="416" cy="120" r="3" fill="#f59e0b"/>
          <circle cx="490" cy="116" r="4" fill="#f59e0b" stroke="#fff" stroke-width="2"/>
          <text x="498" y="112" fill="#f59e0b" font-size="11" font-weight="600" font-family="Inter">+8</text>

          <!-- Annotation arrow for inflection -->
          <line x1="332" y1="50" x2="332" y2="68" stroke="#4f46e5" stroke-width="1" stroke-dasharray="2,2" opacity="0.5"/>
          <text x="332" y="46" text-anchor="middle" fill="#4f46e5" font-size="9" font-family="Inter" opacity="0.7">Perf release</text>
        </svg>

        <div class="nps-source-tag">
          <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M12 2L2 7l10 5 10-5-10-5z"/><path d="M2 17l10 5 10-5"/></svg>
          Source: Delighted NPS Survey · 2,847 responses (Feb 1-7) · 34% response rate · Continuous collection
        </div>
      </div>
    </div>

    <div class="detail-section">
      <h3>Segment Breakdown</h3>
      <div class="detail-meta">
        <div class="detail-meta-item">
          <div class="label">Enterprise</div>
          <div class="value" style="color: var(--green);">+22 <span style="font-size: 11px; font-weight: 400; color: var(--green);">↑ 5pts</span></div>
        </div>
        <div class="detail-meta-item">
          <div class="label">Mid-Market</div>
          <div class="value" style="color: var(--green);">+18 <span style="font-size: 11px; font-weight: 400; color: var(--green);">↑ 3pts</span></div>
        </div>
        <div class="detail-meta-item">
          <div class="label">SMB / Teams</div>
          <div class="value" style="color: var(--yellow);">+8 <span style="font-size: 11px; font-weight: 400; color: var(--green);">↑ 2pts</span></div>
        </div>
        <div class="detail-meta-item">
          <div class="label">Free / Individual</div>
          <div class="value" style="color: var(--red);">-2 <span style="font-size: 11px; font-weight: 400; color: var(--red);">↓ 1pt</span></div>
        </div>
      </div>
    </div>

    <div class="detail-section">
      <h3>Hypotheses — Why NPS Increased +3pts</h3>
      <p style="font-size: 12px; color: var(--text-muted); margin-bottom: 14px;">AI-generated analysis from survey verbatims, support tickets, and product usage data.</p>

      <div class="hypothesis-card strong">
        <span class="hypothesis-confidence strong">High confidence</span>
        <h4>Performance improvements landing with users</h4>
        <p>The Dec 2025 performance release (WebGL renderer + virtual viewport culling) reduced average board load time by 42% for boards with 1K+ objects. Enterprise users on large boards are the primary beneficiary — this segment saw the largest NPS jump (+5pts).</p>
        <div class="hypothesis-evidence">Evidence: 156 promoter verbatims mention "faster" or "performance" (up from 41 in Nov). Canvas render P50 dropped from 3.2s → 1.8s.</div>
      </div>

      <div class="hypothesis-card strong">
        <span class="hypothesis-confidence strong">High confidence</span>
        <h4>New template library driving activation quality</h4>
        <p>The expanded template library (launched Jan 15) increased first-session template usage from 23% to 41%. Users who start with a template have 2.3x higher 30-day retention. Mid-market teams are the biggest adopters — their NPS rose +3pts.</p>
        <div class="hypothesis-evidence">Evidence: 89 promoter comments reference "templates" or "getting started faster." Activation rate for new teams up 18%.</div>
      </div>

      <div class="hypothesis-card moderate">
        <span class="hypothesis-confidence moderate">Moderate confidence</span>
        <h4>CSM-led enterprise health program showing results</h4>
        <p>The Q4 CSM health initiative — proactive QBRs with all accounts scoring &lt;7 on relationship health — may be driving the enterprise NPS lift. 34 at-risk accounts received intervention; 21 moved to "healthy" status by January.</p>
        <div class="hypothesis-evidence">Evidence: Enterprise promoter count up 12%. Detractor rate down from 18% → 14%. Correlates with CSM intervention cohort timing.</div>
      </div>

      <div class="hypothesis-card emerging">
        <span class="hypothesis-confidence emerging">Emerging signal</span>
        <h4>Mobile app beta creating positive sentiment</h4>
        <p>The iOS redesign beta (5% rollout Feb 1) is generating positive word-of-mouth. While the sample is small, beta users are rating 4.5/5 vs 3.8/5 for the current app. This may be creating a halo effect on NPS responses from iOS-heavy teams.</p>
        <div class="hypothesis-evidence">Evidence: 12 verbatims mention "mobile" positively (up from 2 in Jan). Small sample but directionally strong.</div>
      </div>
    </div>

    <div class="detail-section">
      <h3>Top Detractor Themes (drag on NPS)</h3>
      <ul class="detail-risks">
        <li class="high">
          <div class="risk-title">"Board loading still too slow with 5K+ objects" — 34 mentions</div>
          <div class="risk-desc">Performance project has Chrome/Firefox at 60fps but Safari still at 45fps. Power users on Safari still impacted.</div>
        </li>
        <li class="medium">
          <div class="risk-title">"Mobile app feels outdated vs Figma" — 28 mentions</div>
          <div class="risk-desc">Mobile redesign shipping. Early cohort shows +28% engagement. Full rollout by Apr.</div>
        </li>
        <li class="medium">
          <div class="risk-title">"Need better Jira/GitHub/Linear integrations" — 22 mentions</div>
          <div class="risk-desc">Developer platform + API v3 targeting this. 14 launch partners committed including Atlassian.</div>
        </li>
        <li class="low">
          <div class="risk-title">"Free plan too limited for individual use" — 18 mentions</div>
          <div class="risk-desc">Driving negative NPS in Free segment (-2). Growth team evaluating free tier expansion for Q2.</div>
        </li>
      </ul>
    </div>
  `;

  openDetail();
}

// ── Budget Detail ──
function openBudgetDetail() {
  document.getElementById('detailTitle').textContent = '💰 Q1 2026 Budget Status';
  document.getElementById('detailSubtitle').textContent = '81% utilized · $2.1M remaining · Last synced 2 hours ago';

  document.getElementById('detailBody').innerHTML = `
    <div class="detail-section">
      <h3>Budget Summary</h3>
      <div class="detail-meta">
        <div class="detail-meta-item">
          <div class="label">Total Q1 Budget</div>
          <div class="value">$11.2M</div>
        </div>
        <div class="detail-meta-item">
          <div class="label">Spent to Date</div>
          <div class="value">$9.1M</div>
        </div>
        <div class="detail-meta-item">
          <div class="label">Remaining</div>
          <div class="value" style="color: var(--green);">$2.1M</div>
        </div>
        <div class="detail-meta-item">
          <div class="label">Forecasted Overrun</div>
          <div class="value" style="color: var(--yellow);">$340K</div>
        </div>
      </div>
    </div>

    <div class="detail-section">
      <h3>Spend by Project</h3>
      <div style="display: flex; flex-direction: column; gap: 14px;">
        <div class="budget-bar-container">
          <div class="budget-bar-label">
            <span class="bb-name">🤖 AI Canvas Generation</span>
            <span class="bb-amount">$1.8M / $2.2M <span style="color: var(--yellow);">(82%)</span></span>
          </div>
          <div class="budget-bar"><div class="budget-bar-fill" style="width: 82%; background: var(--yellow);"></div></div>
        </div>
        <div class="budget-bar-container">
          <div class="budget-bar-label">
            <span class="bb-name">👥 Collab Engine v3</span>
            <span class="bb-amount">$1.4M / $1.6M <span style="color: var(--yellow);">(88%)</span></span>
          </div>
          <div class="budget-bar"><div class="budget-bar-fill" style="width: 88%; background: var(--yellow);"></div></div>
        </div>
        <div class="budget-bar-container">
          <div class="budget-bar-label">
            <span class="bb-name">📱 Mobile Redesign</span>
            <span class="bb-amount">$1.2M / $1.5M <span style="color: var(--green);">(80%)</span></span>
          </div>
          <div class="budget-bar"><div class="budget-bar-fill" style="width: 80%; background: var(--green);"></div></div>
        </div>
        <div class="budget-bar-container">
          <div class="budget-bar-label">
            <span class="bb-name">🔐 Enterprise SSO</span>
            <span class="bb-amount">$920K / $1.1M <span style="color: var(--yellow);">(84%)</span></span>
          </div>
          <div class="budget-bar"><div class="budget-bar-fill" style="width: 84%; background: var(--yellow);"></div></div>
        </div>
        <div class="budget-bar-container">
          <div class="budget-bar-label">
            <span class="bb-name">🧩 Developer Platform</span>
            <span class="bb-amount">$2.8M / $3.5M <span style="color: var(--green);">(80%)</span></span>
          </div>
          <div class="budget-bar"><div class="budget-bar-fill" style="width: 80%; background: var(--green);"></div></div>
        </div>
        <div class="budget-bar-container">
          <div class="budget-bar-label">
            <span class="bb-name">📐 Templates Marketplace</span>
            <span class="bb-amount">$750K / $950K <span style="color: var(--green);">(79%)</span></span>
          </div>
          <div class="budget-bar"><div class="budget-bar-fill" style="width: 79%; background: var(--green);"></div></div>
        </div>
        <div class="budget-bar-container">
          <div class="budget-bar-label">
            <span class="bb-name">🎥 Video & Loom Integration</span>
            <span class="bb-amount">$680K / $900K <span style="color: var(--green);">(76%)</span></span>
          </div>
          <div class="budget-bar"><div class="budget-bar-fill" style="width: 76%; background: var(--green);"></div></div>
        </div>
        <div class="budget-bar-container">
          <div class="budget-bar-label">
            <span class="bb-name">⚡ Performance & 60fps</span>
            <span class="bb-amount">$580K / $700K <span style="color: var(--yellow);">(83%)</span></span>
          </div>
          <div class="budget-bar"><div class="budget-bar-fill" style="width: 83%; background: var(--yellow);"></div></div>
        </div>
        <div class="budget-bar-container">
          <div class="budget-bar-label">
            <span class="bb-name">🔌 API v3 & GraphQL</span>
            <span class="bb-amount">$620K / $800K <span style="color: var(--green);">(78%)</span></span>
          </div>
          <div class="budget-bar"><div class="budget-bar-fill" style="width: 78%; background: var(--green);"></div></div>
        </div>
      </div>
    </div>

    <div class="detail-section">
      <h3>Budget Pressure Points</h3>
      <ul class="detail-risks">
        <li class="high">
          <div class="risk-title">AI Canvas — LLM inference cost trajectory</div>
          <div class="risk-desc">Current cost $0.08/generation, target $0.03. At projected GA usage (50K gen/day), monthly cost = $120K vs budgeted $45K. Model distillation or provider switch needed.</div>
        </li>
        <li class="medium">
          <div class="risk-title">Collab Engine — CRDT infrastructure scaling</div>
          <div class="risk-desc">WebSocket connection pooling saved 34%, but 500-cursor target requires additional infra spend (~$60K) not in original budget.</div>
        </li>
        <li class="low">
          <div class="risk-title">Enterprise SSO — additional pen test round</div>
          <div class="risk-desc">NCC Group rescheduling adds ~$45K for extended engagement. Pre-approved by VP Eng.</div>
        </li>
      </ul>
    </div>

    <div class="detail-section">
      <h3>Data Sources</h3>
      <p style="font-size: 12px; color: var(--text-muted); margin-bottom: 14px;">Budget data is aggregated from the following systems. Click to open the source.</p>

      <div class="data-source-card">
        <div class="data-source-icon" style="background: #e8f5e9;">📊</div>
        <div class="data-source-info">
          <div class="ds-name">Adaptive Planning (Workday)</div>
          <div class="ds-detail">Primary financial planning system. Q1 budget allocation, actuals, and forecasts. Synced every 4 hours.</div>
        </div>
        <span class="data-source-status live">Live sync</span>
      </div>

      <div class="data-source-card">
        <div class="data-source-icon" style="background: #e3f2fd;">💳</div>
        <div class="data-source-info">
          <div class="ds-name">Netsuite GL</div>
          <div class="ds-detail">General ledger actuals — vendor payments, contractor costs, cloud infrastructure spend. Daily reconciliation.</div>
        </div>
        <span class="data-source-status synced">Synced 2h ago</span>
      </div>

      <div class="data-source-card">
        <div class="data-source-icon" style="background: #fff3e0;">☁️</div>
        <div class="data-source-info">
          <div class="ds-name">AWS Cost Explorer + GCP Billing</div>
          <div class="ds-detail">Cloud infrastructure costs by project tag. Includes compute, LLM API costs (Anthropic, OpenAI), and data transfer.</div>
        </div>
        <span class="data-source-status live">Live sync</span>
      </div>

      <div class="data-source-card">
        <div class="data-source-icon" style="background: #fce4ec;">👥</div>
        <div class="data-source-info">
          <div class="ds-name">Workday HCM</div>
          <div class="ds-detail">Headcount costs — fully-loaded engineer costs allocated by project based on time tracking in Jira.</div>
        </div>
        <span class="data-source-status synced">Synced daily</span>
      </div>

      <div class="data-source-card">
        <div class="data-source-icon" style="background: #f3e5f5;">📋</div>
        <div class="data-source-info">
          <div class="ds-name">Jira Time Tracking</div>
          <div class="ds-detail">Engineer hours by project and epic. Used to allocate headcount costs from Workday HCM to specific projects.</div>
        </div>
        <span class="data-source-status synced">Synced 6h ago</span>
      </div>

      <div class="data-source-card">
        <div class="data-source-icon" style="background: #e8eaf6;">🔒</div>
        <div class="data-source-info">
          <div class="ds-name">Coupa Procurement</div>
          <div class="ds-detail">Vendor contracts and POs — external pen testing (NCC Group), ML model licensing, design tool subscriptions.</div>
        </div>
        <span class="data-source-status manual">Manual upload</span>
      </div>

      <div style="margin-top: 16px; padding: 12px 16px; background: var(--bg); border-radius: var(--radius-sm); font-size: 12px; color: var(--text-muted);">
        <strong style="color: var(--text-secondary);">Last full reconciliation:</strong> Feb 6, 2026 at 11:00 PM UTC · Next scheduled: Feb 7, 2026 at 11:00 PM UTC<br>
        <strong style="color: var(--text-secondary);">Data owner:</strong> Finance Operations (Diana Reeves) · <strong style="color: var(--text-secondary);">Refresh cadence:</strong> Automated daily, manual override available
      </div>
    </div>
  `;

  openDetail();
}

// ── Decision Detail ──
function openDecisionDetail(decisionId) {
  const decisions = {
    'ai-diagramming': {
      title: 'AI Diagramming Response: Build vs. Partner',
      subtitle: 'Decision needed by Feb 10, 2026 · $8.2M ARR at risk',
      content: `
        <div class="detail-section">
          <p style="font-size: 13px; color: var(--text-secondary); line-height: 1.7; margin-bottom: 16px;">
            Figma's Auto-Diagram launch at Config 2026 requires an immediate competitive response. The engineering team has proposed two options for delivering AI-powered diagramming in Miro.
          </p>
          <h3>Option A: Fast-Follow Build (Recommended by Eng)</h3>
          <div style="padding: 14px; background: var(--bg); border-radius: var(--radius-sm); margin-bottom: 16px;">
            <p style="font-size: 13px; line-height: 1.6; margin-bottom: 8px;"><strong>Timeline:</strong> 8 weeks to public beta (Apr 4, 2026)</p>
            <p style="font-size: 13px; line-height: 1.6; margin-bottom: 8px;"><strong>Cost:</strong> $420K incremental (accelerated hiring + LLM costs)</p>
            <p style="font-size: 13px; line-height: 1.6; margin-bottom: 8px;"><strong>Scope:</strong> Flowcharts, mind maps, org charts. ERDs and architecture diagrams in v2.</p>
            <p style="font-size: 13px; line-height: 1.6;"><strong>Risk:</strong> Latency may not be competitive at launch. Need model optimization sprint.</p>
          </div>
          <h3>Option B: Partner with AI Startup (Explored by BD)</h3>
          <div style="padding: 14px; background: var(--bg); border-radius: var(--radius-sm); margin-bottom: 16px;">
            <p style="font-size: 13px; line-height: 1.6; margin-bottom: 8px;"><strong>Timeline:</strong> 4 weeks to integration beta (Mar 7, 2026)</p>
            <p style="font-size: 13px; line-height: 1.6; margin-bottom: 8px;"><strong>Cost:</strong> $180K/yr licensing + revenue share</p>
            <p style="font-size: 13px; line-height: 1.6; margin-bottom: 8px;"><strong>Scope:</strong> Full diagram type coverage from day one via partner's existing model.</p>
            <p style="font-size: 13px; line-height: 1.6;"><strong>Risk:</strong> Dependency on third-party. Quality/UX control limited. Long-term cost higher.</p>
          </div>
        </div>
        <div class="detail-section">
          <h3>Stakeholder Input</h3>
          <ul class="detail-updates">
            <li><span class="update-dot blue"></span><div class="update-content"><div class="update-text"><strong>VP Engineering:</strong> "Recommends Option A. We need to own this capability long-term."</div><div class="update-date">Feb 6</div></div></li>
            <li><span class="update-dot yellow"></span><div class="update-content"><div class="update-text"><strong>VP Sales:</strong> "Speed matters. 14 pipeline deals asking about AI diagramming. Option B gets us there faster."</div><div class="update-date">Feb 5</div></div></li>
            <li><span class="update-dot green"></span><div class="update-content"><div class="update-text"><strong>CFO:</strong> "Option A preferred from unit economics perspective. Option B gets expensive at scale."</div><div class="update-date">Feb 5</div></div></li>
          </ul>
        </div>
      `
    },
    'enterprise-sso': {
      title: 'Enterprise SSO: SAML vs. OIDC Priority',
      subtitle: 'Decision needed by Feb 12, 2026 · $3.4M ARR blocked',
      content: `
        <div class="detail-section">
          <p style="font-size: 13px; color: var(--text-secondary); line-height: 1.7; margin-bottom: 16px;">
            6 enterprise deals ($3.4M combined ARR) are blocked on advanced SSO capabilities. The team can ship one protocol first. Which should take priority?
          </p>
          <h3>Deal Breakdown by Protocol Need</h3>
          <div class="detail-meta" style="margin-bottom: 16px;">
            <div class="detail-meta-item">
              <div class="label">SAML Required</div>
              <div class="value">4 deals · $2.1M</div>
            </div>
            <div class="detail-meta-item">
              <div class="label">OIDC Required</div>
              <div class="value">2 deals · $1.3M</div>
            </div>
          </div>
          <h3>Blocked Accounts</h3>
          <ul class="detail-risks">
            <li class="high"><div class="risk-title">BMW Group — $510K (SAML)</div><div class="risk-desc">Expansion deal paused. Evaluating Lucidspark.</div></li>
            <li class="high"><div class="risk-title">JPMorgan Chase — $680K (SAML)</div><div class="risk-desc">Security team won't approve without IdP-initiated SAML.</div></li>
            <li class="medium"><div class="risk-title">Stripe — $420K (OIDC)</div><div class="risk-desc">Preferred OIDC with PKCE. Will accept SAML as interim.</div></li>
            <li class="medium"><div class="risk-title">Goldman Sachs — $890K (OIDC)</div><div class="risk-desc">New deal. OIDC preferred but not blocking initial contract.</div></li>
          </ul>
        </div>
      `
    },
    'pricing-tier': {
      title: 'New "Teams+" Pricing Tier Approval',
      subtitle: 'Decision needed by Feb 14, 2026 · +$4.8M ARR potential',
      content: `
        <div class="detail-section">
          <p style="font-size: 13px; color: var(--text-secondary); line-height: 1.7; margin-bottom: 16px;">
            Pricing committee recommends introducing a "Teams+" tier at $16/user/mo, positioned between Business ($12.50) and Enterprise ($22.50). Targets mid-market teams wanting advanced features without enterprise procurement complexity.
          </p>
          <h3>Proposed Tier Features</h3>
          <div style="padding: 14px; background: var(--bg); border-radius: var(--radius-sm); margin-bottom: 16px;">
            <p style="font-size: 13px; line-height: 1.8;">✓ Everything in Business</p>
            <p style="font-size: 13px; line-height: 1.8;">✓ Advanced guest access controls</p>
            <p style="font-size: 13px; line-height: 1.8;">✓ SSO (basic SAML)</p>
            <p style="font-size: 13px; line-height: 1.8;">✓ Priority support (4hr SLA)</p>
            <p style="font-size: 13px; line-height: 1.8;">✓ AI features (100 generations/mo)</p>
            <p style="font-size: 13px; line-height: 1.8;">✗ SCIM provisioning (Enterprise only)</p>
            <p style="font-size: 13px; line-height: 1.8;">✗ Custom data residency (Enterprise only)</p>
          </div>
          <h3>Financial Model</h3>
          <div class="detail-meta">
            <div class="detail-meta-item"><div class="label">Incremental ARR (Year 1)</div><div class="value" style="color: var(--green);">+$4.8M</div></div>
            <div class="detail-meta-item"><div class="label">Cannibalization Risk</div><div class="value" style="color: var(--yellow); font-size: 13px;">~$1.2M from Enterprise downgrades</div></div>
            <div class="detail-meta-item"><div class="label">Net New ARR</div><div class="value" style="color: var(--green);">+$3.6M</div></div>
            <div class="detail-meta-item"><div class="label">Break-even</div><div class="value" style="font-size: 13px;">Month 4</div></div>
          </div>
        </div>
      `
    }
  };

  const d = decisionId ? decisions[decisionId] : null;
  if (!d) {
    // Default to first decision
    openDecisionDetail('ai-diagramming');
    return;
  }

  document.getElementById('detailTitle').textContent = d.title;
  document.getElementById('detailSubtitle').textContent = d.subtitle;
  document.getElementById('detailBody').innerHTML = d.content;
  openDetail();
}

// ── Keyboard shortcut to close ──
document.addEventListener('keydown', e => {
  if (e.key === 'Escape') closeDetail();
});

// ── Daily Pulse Timestamp (6am GMT auto-refresh) ──
function updatePulseTimestamp() {
  const now = new Date();
  const utcH = now.getUTCHours();
  const utcM = now.getUTCMinutes();
  // Compute last 6am GMT
  let last6am = new Date(now);
  last6am.setUTCHours(6, 0, 0, 0);
  if (utcH < 6) last6am.setUTCDate(last6am.getUTCDate() - 1);
  const diffMs = now - last6am;
  const diffMins = Math.floor(diffMs / 60000);
  let agoStr;
  if (diffMins < 60) agoStr = diffMins + ' min ago';
  else if (diffMins < 1440) agoStr = Math.floor(diffMins / 60) + 'h ago';
  else agoStr = Math.floor(diffMins / 1440) + 'd ago';
  const days = ['Sun','Mon','Tue','Wed','Thu','Fri','Sat'];
  const months = ['Jan','Feb','Mar','Apr','May','Jun','Jul','Aug','Sep','Oct','Nov','Dec'];
  const dayName = days[last6am.getUTCDay()];
  const d = last6am.getUTCDate();
  const mon = months[last6am.getUTCMonth()];
  const yr = last6am.getUTCFullYear();
  const el = document.getElementById('pulseTimestamp');
  if (el) el.textContent = 'Auto-refreshed ' + agoStr + ' · ' + dayName + ' ' + d + ' ' + mon + ' ' + yr + ' at 06:00 GMT';
}
updatePulseTimestamp();
setInterval(updatePulseTimestamp, 60000);

// ── Navigation ──
function navigateTo(view, link, e) {
  if (e) e.preventDefault();
  document.querySelectorAll('.sidebar-item').forEach(i => i.classList.remove('active'));
  if (link) link.classList.add('active');
  const home = document.getElementById('homeView');
  const pa = document.getElementById('pulseAnalyticsView');
  const ms = document.getElementById('marketSignalsView');
  home.classList.remove('active');
  pa.classList.remove('active');
  ms.classList.remove('active');
  if (view === 'pulse-analytics') {
    pa.classList.add('active');
    initCharts();
  } else if (view === 'market-signals') {
    ms.classList.add('active');
    initMarketSignals();
  } else {
    home.classList.add('active');
  }
  document.querySelector('.main').scrollTop = 0;
}

// ── Charts ──
let chartsInitialized = false;
function initCharts() {
  if (chartsInitialized) return;
  chartsInitialized = true;

  const weeks = ['Nov 16','Nov 23','Nov 30','Dec 7','Dec 14','Dec 21','Dec 28','Jan 4','Jan 11','Jan 18','Jan 25','Feb 1'];
  const chartOpts = (title) => ({
    responsive: true, maintainAspectRatio: false,
    interaction: { mode: 'index', intersect: false },
    plugins: {
      legend: { position: 'bottom', labels: { boxWidth: 12, padding: 12, font: { size: 11 } } },
      tooltip: { backgroundColor: '#1a1a2e', titleFont: { size: 12 }, bodyFont: { size: 11 }, padding: 10, cornerRadius: 8,
        callbacks: { label: ctx => ctx.dataset.label + ': ' + ctx.parsed.y.toLocaleString() }
      }
    },
    scales: {
      x: { grid: { display: false }, ticks: { font: { size: 10 }, maxRotation: 45 } },
      y: { grid: { color: '#f0f0f5' }, ticks: { font: { size: 10 }, callback: v => v >= 1000 ? (v/1000).toFixed(0) + 'K' : v }, beginAtZero: true }
    }
  });

  // Tables Chart
  new Chart(document.getElementById('chartTables'), {
    type: 'line',
    data: {
      labels: weeks,
      datasets: [
        { label: 'Non-Enterprise', data: [62907,64674,64033,58375,50408,27378,22066,49627,58605,68881,68001,69971], borderColor: '#6C5CE7', backgroundColor: 'rgba(108,92,231,0.08)', fill: true, tension: 0.35, pointRadius: 3, borderWidth: 2 },
        { label: 'Enterprise', data: [47653,45816,51089,44592,39500,12484,8213,40596,48566,51705,52293,53050], borderColor: '#00b894', backgroundColor: 'rgba(0,184,148,0.08)', fill: true, tension: 0.35, pointRadius: 3, borderWidth: 2 }
      ]
    },
    options: chartOpts()
  });

  // Kanban Chart (combined legacy + new)
  new Chart(document.getElementById('chartKanban'), {
    type: 'line',
    data: {
      labels: weeks,
      datasets: [
        { label: 'Non-Enterprise', data: [42212+12268,39241+11934,38191+13239,34829+14294,30936+13432,16672+7724,13533+7011,29982+14747,34160+16389,33610+17380,33078+17815,33273+18152], borderColor: '#6C5CE7', backgroundColor: 'rgba(108,92,231,0.08)', fill: true, tension: 0.35, pointRadius: 3, borderWidth: 2 },
        { label: 'Enterprise', data: [33039+8971,29209+8282,31208+9846,29086+9876,25576+9312,8391+3055,5204+2161,26473+10733,29583+12759,28776+13188,27969+13538,28014+13988], borderColor: '#00b894', backgroundColor: 'rgba(0,184,148,0.08)', fill: true, tension: 0.35, pointRadius: 3, borderWidth: 2 }
      ]
    },
    options: chartOpts()
  });

  // Timeline Chart
  new Chart(document.getElementById('chartTimeline'), {
    type: 'line',
    data: {
      labels: weeks,
      datasets: [
        { label: 'Non-Enterprise', data: [18689,17780,18103,18688,17660,9622,8392,18847,20502,21654,21949,22026], borderColor: '#6C5CE7', backgroundColor: 'rgba(108,92,231,0.08)', fill: true, tension: 0.35, pointRadius: 3, borderWidth: 2 },
        { label: 'Enterprise', data: [15733,14453,15761,15601,14294,4590,3045,15471,17776,18047,18020,18349], borderColor: '#00b894', backgroundColor: 'rgba(0,184,148,0.08)', fill: true, tension: 0.35, pointRadius: 3, borderWidth: 2 }
      ]
    },
    options: chartOpts()
  });

  // Kanban Migration Chart
  new Chart(document.getElementById('chartKanbanMigration'), {
    type: 'line',
    data: {
      labels: weeks,
      datasets: [
        { label: 'Kanban (New)', data: [12268+8971,11934+8282,13239+9846,14294+9876,13432+9312,7724+3055,7011+2161,14747+10733,16389+12759,17380+13188,17815+13538,18152+13988], borderColor: '#6C5CE7', backgroundColor: 'rgba(108,92,231,0.08)', fill: true, tension: 0.35, pointRadius: 3, borderWidth: 2 },
        { label: 'Kanban (Legacy)', data: [42212+33039,39241+29209,38191+31208,34829+29086,30936+25576,16672+8391,13533+5204,29982+26473,34160+29583,33610+28776,33078+27969,33273+28014], borderColor: '#fdcb6e', backgroundColor: 'rgba(253,203,110,0.08)', fill: true, tension: 0.35, pointRadius: 3, borderWidth: 2 }
      ]
    },
    options: chartOpts()
  });
}

// ── Market Signals Data ──
// Competitor data sourced from Miro internal Glean:
// - FY26 Compete Board (miro.com/app/board/uXjVL63U-C4=)
// - Compete pricing reports (miro.com/app/board/uXjVGUnJM-k=)
// - Miro for Product Acceleration Marketing Toolkit (miro.com/app/board/uXjVJG0hXX0=)
// - FY27 Insights Vision & Strategy (miro.com/app/board/uXjVGWUm_Jc=)
const competitors = [
  {
    name: 'Figma / FigJam',
    useCases: ['diagramming', 'whiteboard', 'prototyping'],
    ai: 'ChatGPT integration, AI-generated diagrams in FigJam, AI auto-layout, AI component suggestions, Make Designs AI. FigJam AI sorts stickies, generates summaries, and creates boards from prompts.',
    love: 'Best-in-class design tool, real-time collaboration, FigJam for brainstorming, developer handoff, extensive plugin ecosystem. March 2025 packaging restructure bundled FigJam + Slides into single seat — perceived as better value.',
    complaints: '"Basic whiteboarding needs are covered by FigJam, but not much else" (Miro FY26 Compete Board). Users need additional 3rd-party apps for complete workflows. No native PI planning, estimation, or dependency mapping. Limited enterprise security vs Miro.',
    coverage: [
      { label: 'FigJam pricing restructure (Mar 2025)', url: 'https://www.figma.com/pricing/', type: 'article' },
      { label: 'FigJam AI — boards, diagrams & more', url: 'https://www.figma.com/blog/introducing-ai-to-figjam/', type: 'blog' },
      { label: 'Figma Slides announcement', url: 'https://www.figma.com/blog/introducing-figma-slides/', type: 'blog' }
    ],
    sources: [
      { label: 'FY26 Compete Board', url: 'https://miro.com/app/board/uXjVL63U-C4=' },
      { label: 'Compete pricing reports', url: 'https://miro.com/app/board/uXjVGUnJM-k=' },
      { label: 'G2 Reviews', url: 'https://www.g2.com/products/figma/reviews' }
    ]
  },
  {
    name: 'Lucid (Lucidspark / Lucidchart)',
    useCases: ['diagramming', 'whiteboard'],
    ai: 'AI diagram generation from text, AI-powered flowcharts, smart containers, AI clustering for brainstorms. AI in Whiteboards generates ideas and organises themes. Voting System for collaborative decision-making.',
    love: 'Strong technical diagramming (Visio alternative). Lucid claims "Work Acceleration Platform" with stream-specific accelerators (Agile, Cloud, Process). LUMA Elevate training programs launched March 2025. Enterprise-grade security.',
    complaints: 'Whiteboard feels secondary to diagrams. "Lucid claims Work Acceleration Platform — direct positioning overlap but tool-centric, not cross-stack" (Miro competitive brief). All paid plans require annual billing — no month-to-month option.',
    coverage: [
      { label: 'Lucid AI features launch', url: 'https://lucid.co/blog/lucid-ai', type: 'blog' },
      { label: 'LUMA Elevate training launch (Mar 2025)', url: 'https://www.lucidspark.com/luma', type: 'article' }
    ],
    sources: [
      { label: 'Compete pricing reports', url: 'https://miro.com/app/board/uXjVGUnJM-k=' },
      { label: 'FY26 Compete Board', url: 'https://miro.com/app/board/uXjVL63U-C4=' },
      { label: 'G2 Reviews', url: 'https://www.g2.com/products/lucidspark/reviews' }
    ]
  },
  {
    name: 'Monday.com',
    useCases: ['project_management', 'roadmaps'],
    ai: 'monday magic, monday vibe, monday sidekick (Jul 2025) — natural language workflows, no-code app building, personalised AI. monday agents (Sep 2025) — autonomous AI agents for end-to-end task execution, competing with Microsoft Copilot Studio.',
    love: 'Projected 2025 revenue $1.2B with 23.5% growth across 245K customers. Highly visual PM. Standalone Whiteboard add-on ($2.49/mo). monday campaigns (Sep 2025) expands into marketing automation.',
    complaints: 'Strategic shift from low-cost to premium AI pricing. July 2024 eliminated bundled pricing — Work Management, CRM, Dev now sold separately. Forecast: separate AI tier or credit system within 6-9 months at 15-25% premium. Pricing complexity increasing.',
    coverage: [
      { label: 'monday agents launch (Sep 2025)', url: 'https://monday.com/blog/product/monday-agents/', type: 'blog' },
      { label: 'monday campaigns launch', url: 'https://monday.com/blog/product/monday-campaigns/', type: 'blog' },
      { label: 'Individual product pricing (Jul 2024)', url: 'https://monday.com/pricing', type: 'article' }
    ],
    sources: [
      { label: 'Compete pricing reports', url: 'https://miro.com/app/board/uXjVGUnJM-k=' },
      { label: 'Monday.com Product Intel Report', url: 'https://miro.com/app/board/uXjVGUnJM-k=' },
      { label: 'G2 Reviews', url: 'https://www.g2.com/products/monday-com/reviews' }
    ]
  },
  {
    name: 'Notion',
    useCases: ['project_management', 'roadmaps'],
    ai: 'Notion Brain AI add-on ($7/user/month). AI autofill for databases, AI Q&A across workspace, AI-generated summaries. Bulk import functionality and Smart Links consolidate platform to reduce tool sprawl.',
    love: 'All-in-one workspace, flexible databases, clean UI, strong community. "Notion = flexible, clean" (Miro internal competitive analysis). Team+ pricing at $9.99/mo or $12 monthly billing. Smart Links reduce context-switching.',
    complaints: 'No real whiteboard or diagramming capability. Slow with large workspaces. Brain AI add-on at $7/user/month represents 70%+ premium over base pricing. Permissions complexity frustrates admins.',
    coverage: [
      { label: 'Notion AI product page', url: 'https://www.notion.so/product/ai', type: 'blog' },
      { label: 'Notion Smart Links', url: 'https://www.notion.so/blog', type: 'blog' }
    ],
    sources: [
      { label: 'Compete pricing reports', url: 'https://miro.com/app/board/uXjVGUnJM-k=' },
      { label: 'Dynamic roadmapping research', url: 'https://miro.com/app/board/uXjVGK1Sk-U=' },
      { label: 'G2 Reviews', url: 'https://www.g2.com/products/notion/reviews' }
    ]
  },
  {
    name: 'ClickUp',
    useCases: ['project_management', 'roadmaps', 'whiteboard'],
    ai: 'ClickUp Brain AI ($7/user/month add-on, 100% premium over base). AI code generation via Super Agents — autonomously generates software and creates pull requests from tasks. Positioning as single AI workspace.',
    love: 'Positioning as "everything app for work". Free tier generous (unlimited tasks/users). $7/user/month for Unlimited plan. Dev tools: GitLab integration, VS Code extension, Capacity Planner (Oct 2025).',
    complaints: 'Cumulative bill shock: compound pricing across base + AI + guest seats pushing teams "into five-figure territory very quickly". Business Plus tier eliminated May 2025. Guest-to-paid seat algorithmic conversion adds 15-30% to contract value. User backlash over "unethical business practices".',
    coverage: [
      { label: 'ClickUp Brain AI launch', url: 'https://clickup.com/ai', type: 'blog' },
      { label: '10 Best Miro Alternatives (ClickUp)', url: 'https://clickup.com/blog/miro-alternatives/', type: 'article' }
    ],
    sources: [
      { label: 'Compete pricing reports', url: 'https://miro.com/app/board/uXjVGUnJM-k=' },
      { label: 'ClickUp Pricing Intel', url: 'https://miro.com/app/board/uXjVGUnJM-k=' },
      { label: 'G2 Reviews', url: 'https://www.g2.com/products/clickup/reviews' }
    ]
  },
  {
    name: 'Canva',
    useCases: ['whiteboard', 'prototyping'],
    ai: 'Magic Design AI, AI image generation, AI presentations, Magic Write, AI-powered Whiteboards. Targeting non-designer knowledge workers — same "everyone is a creator" audience Miro targets.',
    love: 'Extremely easy to use, beautiful templates, Whiteboards + Docs in one, affordable. Strong brand with SMB and education markets.',
    complaints: 'Whiteboard features basic vs Miro. Limited real-time collaboration depth. Not suited for complex diagrams or enterprise workflows. No advanced security or compliance features.',
    coverage: [
      { label: 'Canva Create 2025', url: 'https://www.canva.com/designevent/', type: 'video' },
      { label: 'Canva Whiteboards', url: 'https://www.canva.com/online-whiteboard/', type: 'article' }
    ],
    sources: [
      { label: 'FY26 Compete Board', url: 'https://miro.com/app/board/uXjVL63U-C4=' },
      { label: 'G2 Reviews', url: 'https://www.g2.com/products/canva/reviews' }
    ]
  },
  {
    name: 'Linear',
    useCases: ['project_management', 'roadmaps'],
    ai: 'AI issue creation, AI project updates, AI triage, auto-assign, AI-generated changelogs. 2-way sync with GitHub, Notion, Slack. AI features available on all tiers.',
    love: 'Blazing fast UI, keyboard-first design, excellent developer experience. "Linear-Style Modern PM Tools: focused, opinionated, narrow" (Miro internal analysis). Great GitHub integration. Clean roadmap views.',
    complaints: 'Narrow focus (dev teams only). Limited non-engineering use cases. No whiteboard, diagram, or visual collaboration. Fewer integrations. Steep learning curve for PMs.',
    coverage: [
      { label: 'Linear Asks launch', url: 'https://linear.app/blog/linear-asks', type: 'blog' },
      { label: "Lenny's Podcast: Linear", url: 'https://www.lennyspodcast.com/karri-saarinen-linear/', type: 'podcast' }
    ],
    sources: [
      { label: 'Dynamic roadmapping research', url: 'https://miro.com/app/board/uXjVGK1Sk-U=' },
      { label: 'G2 Reviews', url: 'https://www.g2.com/products/linear/reviews' }
    ]
  },
  {
    name: 'Productboard',
    useCases: ['roadmaps', 'project_management'],
    ai: 'AI-powered feature prioritisation, AI insight extraction from feedback, AI roadmap suggestions. Contextual recommendations rather than just collected feedback.',
    love: 'Best-in-class product management. "Productboard does not support marketing and strategic roadmaps effectively" — opening for Miro (Miro internal research). Maintains 25% premium market positioning with $189M ARR across 1,200 enterprise customers.',
    complaints: '"Executives and teams request many different roadmap cuts, forcing product directors to manually create separate PowerPoint versions for each audience" (Miro customer research). Expensive. Complex setup. No visual collaboration layer.',
    coverage: [
      { label: 'Productboard AI features', url: 'https://www.productboard.com/blog/ai-prioritization/', type: 'blog' },
      { label: 'Product Excellence Summit', url: 'https://www.productboard.com/product-excellence/', type: 'video' }
    ],
    sources: [
      { label: 'Insights-Driven Roadmapping kickoff', url: 'https://miro.com/app/board/uXjVGKHY_h0=' },
      { label: 'G2 Reviews', url: 'https://www.g2.com/products/productboard/reviews' }
    ]
  },
  {
    name: 'Atlassian (Jira / Confluence)',
    useCases: ['project_management', 'roadmaps', 'whiteboard'],
    ai: 'Atlassian Intelligence (AI across Jira/Confluence) reserved exclusively for Premium and Enterprise tiers. AI issue summaries, AI search, AI-generated JQL, virtual agent. Confluence Whiteboards going GA — direct competition with Miro.',
    love: 'Industry standard for dev teams. Claims "System of Work" with Collections + Rovo AI. Qatalog acquisition ($25.4M) brings permission-aware enterprise AI search across 100+ integrations. Loom acquisition for async video. Site capacity tripled to 150,000 users.',
    complaints: '"Atlassian claims System of Work — same problem statement, but bottom-up/EPD-rooted. Both automate existing work patterns; neither designs new ones" (Miro competitive brief). Confluence pricing increased 5-10% (Oct 2025). Bloated UI.',
    coverage: [
      { label: 'Atlassian Intelligence', url: 'https://www.atlassian.com/blog/announcements/atlassian-intelligence', type: 'blog' },
      { label: 'Confluence Whiteboards GA', url: 'https://www.atlassian.com/software/confluence/whiteboards', type: 'article' },
      { label: 'Rovo AI launch', url: 'https://www.atlassian.com/rovo', type: 'blog' }
    ],
    sources: [
      { label: 'FY26 Compete Board', url: 'https://miro.com/app/board/uXjVL63U-C4=' },
      { label: 'Compete pricing reports', url: 'https://miro.com/app/board/uXjVGUnJM-k=' },
      { label: 'Business Acceleration positioning', url: 'https://miro.com/app/board/uXjVGYysvW4=' }
    ]
  },
  {
    name: 'Asana',
    useCases: ['project_management', 'roadmaps'],
    ai: 'Asana AI Studio — smart status, smart goals, smart workflows. AI project risk detection, AI task assignments. "Asana\'s AI attempts are surface-level" (Miro internal analysis).',
    love: 'Clean task management. Great for cross-functional teams. Timeline/board/list views. Goal tracking. Forms & intake. Strong brand with non-technical PMs.',
    complaints: 'Customers "actively reconsidering tools because of cost pressure" (FAKTOR 3 AG via Miro research). High cost cited by multiple Miro enterprise customers. "City of Hope use Asana purely because of pricing, not fit" (Miro research). No whiteboarding. Limited customisation.',
    coverage: [
      { label: 'Asana AI Studio', url: 'https://asana.com/blog/ai-studio', type: 'blog' },
      { label: 'Work Innovation Summit', url: 'https://asana.com/work-innovation-summit', type: 'video' }
    ],
    sources: [
      { label: 'Dynamic roadmapping research', url: 'https://miro.com/app/board/uXjVGK1Sk-U=' },
      { label: 'Insights-Driven Roadmapping', url: 'https://miro.com/app/board/uXjVGKHY_h0=' },
      { label: 'G2 Reviews', url: 'https://www.g2.com/products/asana/reviews' }
    ]
  },
  {
    name: 'Microsoft (Whiteboard / Loop)',
    useCases: ['whiteboard', 'project_management'],
    ai: 'Copilot in Whiteboard, AI-generated diagrams, Copilot in Loop, AI meeting summaries, AI task extraction. Osmos acquisition (Jan 2026) accelerates agentic AI data engineering in Fabric.',
    love: 'Free with M365 — "strategic ecosystem tool, not standalone revenue product" (Miro pricing intel). Teams integration. Miro is Early Access partner for MS Copilot — "transformational in removing siloes that block teamwork".',
    complaints: '"Visio and MS Whiteboard are single point solutions forcing teams to toggle between different tools" (Miro FY26 Compete Board). "MS LACKS THE TOOLS to support most use cases from Discovery to Delivery". Planner integration removed Jan 2026. Suite-level price increases planned Jul 2026.',
    coverage: [
      { label: 'Microsoft Copilot APIs — Miro featured', url: 'https://devblogs.microsoft.com/microsoft365dev/', type: 'blog' },
      { label: 'Miro Agent for MS Copilot @ Ignite 2025', url: 'https://www.microsoft.com/en-us/microsoft-365/blog/', type: 'video' },
      { label: 'Osmos acquisition (Jan 2026)', url: 'https://blogs.microsoft.com/blog/2026/01/05/microsoft-announces-acquisition-of-osmos-to-accelerate-autonomous-data-engineering-in-fabric/', type: 'article' }
    ],
    sources: [
      { label: 'FY26 Compete Board', url: 'https://miro.com/app/board/uXjVL63U-C4=' },
      { label: 'Compete pricing reports', url: 'https://miro.com/app/board/uXjVGUnJM-k=' },
      { label: 'Enablement Hub: Miro for MSFT', url: 'https://miro.com/app/board/uXjVOyQEfeA=' }
    ]
  },
  {
    name: 'Smaply',
    useCases: ['customer_journey'],
    ai: 'AI journey map generation, AI persona creation, AI stakeholder maps.',
    love: 'Purpose-built for CX. Beautiful journey maps. Persona tools. Stakeholder mapping. Great for service design. Miro evaluated against Smaply in Forrester Wave CJM evaluation.',
    complaints: 'Niche tool with limited broader use. Expensive per-user pricing. Small team / slow updates. Limited integrations.',
    coverage: [
      { label: 'Smaply AI features', url: 'https://www.smaply.com/blog/ai-journey-mapping', type: 'blog' }
    ],
    sources: [
      { label: 'CJMP Forrester Wave Evaluation', url: 'https://miro.com/app/board/uXjVIphJMLo=' },
      { label: 'G2 Reviews', url: 'https://www.g2.com/products/smaply/reviews' }
    ]
  },
  {
    name: 'UXPressia',
    useCases: ['customer_journey'],
    ai: 'AI-assisted CJM, AI persona builder, AI impact maps.',
    love: 'Focused CX toolkit, collaborative journey mapping, real-time editing, export options, template library.',
    complaints: 'Very niche. Limited to CX use case. Free tier very restricted. Smaller community. Slower innovation.',
    coverage: [
      { label: 'UXPressia AI CJM', url: 'https://uxpressia.com/blog/ai-customer-journey-mapping', type: 'blog' }
    ],
    sources: [
      { label: 'CJMP Forrester Wave Evaluation', url: 'https://miro.com/app/board/uXjVIphJMLo=' },
      { label: 'G2 Reviews', url: 'https://www.g2.com/products/uxpressia/reviews' }
    ]
  },
  {
    name: 'Framer',
    useCases: ['prototyping'],
    ai: 'AI website generation from prompts, AI component creation, AI layout suggestions, AI copy generation.',
    love: 'Stunning prototypes. AI-generated websites. Great animations. Publish directly to web. Modern design tool.',
    complaints: 'Not a collaboration tool. No whiteboard. Complex for beginners. Limited team features. Niche use case.',
    coverage: [
      { label: 'Framer AI Sites', url: 'https://www.framer.com/ai', type: 'article' },
      { label: 'Framer updates', url: 'https://www.framer.com/updates/', type: 'blog' }
    ],
    sources: [
      { label: 'G2 Reviews', url: 'https://www.g2.com/products/framer/reviews' },
      { label: 'Framer Blog', url: 'https://www.framer.com/blog/' }
    ]
  },
  {
    name: 'Mural',
    useCases: ['whiteboard'],
    ai: 'AI Companion transitioning from included to selectively billed premium features. AI in brainstorm facilitation.',
    love: 'Strong in facilitation and workshops. LUMA acquisition for collaboration training. Revenue $210M (Jun 2024), 3x growth since 2020.',
    complaints: 'Revenue growth from free/low-cost alternatives (Miro, Figma) intensifying competition. AI Companion moving to premium billing. Pricing sits 60% above comparable services. User feedback cites navigation and pricing complexity as friction points.',
    coverage: [
      { label: 'Mural overview', url: 'https://www.mural.co/', type: 'article' }
    ],
    sources: [
      { label: 'Compete pricing reports', url: 'https://miro.com/app/board/uXjVGUnJM-k=' },
      { label: 'FY26 Compete Board', url: 'https://miro.com/app/board/uXjVL63U-C4=' }
    ]
  }
];

const categoryLabelsMs = {
  diagramming: 'Diagramming',
  roadmaps: 'Roadmaps',
  whiteboard: 'Whiteboard',
  prototyping: 'Prototyping',
  project_management: 'Project Mgmt',
  customer_journey: 'CX Mapping'
};

let msActiveFilter = 'all';
let msInitialized = false;

function initMarketSignals() {
  if (msInitialized) return;
  msInitialized = true;
  renderMsPage();
}

function toggleMsFilter(chip) {
  const uc = chip.dataset.uc;
  msActiveFilter = uc;
  document.querySelectorAll('#msFilterBar .ms-filter-chip').forEach(c => c.classList.remove('active'));
  chip.classList.add('active');
  renderMsPage();
}

function renderMsPage() {
  // Filter threats and competitors
  const filteredThreats = msActiveFilter === 'all' ? threats : threats.filter(t => t.categories && t.categories.some(c => c === msActiveFilter));
  const filteredCompetitors = msActiveFilter === 'all' ? competitors : competitors.filter(c => c.useCases.includes(msActiveFilter));

  // Render threats grid
  const grid = document.getElementById('msThreatsGrid');
  grid.innerHTML = filteredThreats.map(t => `
    <div class="ms-threat-card" onclick="openSingleThreatDetail('${t.id}')">
      <h4>${t.title}</h4>
      <p>${t.desc}</p>
      <div style="display:flex;gap:6px;flex-wrap:wrap;margin-top:4px;">
        ${t.categories.map(c => `<span class="threat-category-tag">${categoryLabels[c].icon} ${categoryLabels[c].label}</span>`).join('')}
        <span class="threat-impact ${t.impact}" style="margin-left:auto;">${t.impactLabel}</span>
      </div>
    </div>
  `).join('');
  if (filteredThreats.length === 0) grid.innerHTML = '<div style="color:var(--text-muted);font-size:13px;padding:20px;">No competitive threats match the selected use case filter.</div>';

  // Render comparison table
  const tbody = document.getElementById('msComparisonBody');
  tbody.innerHTML = filteredCompetitors.map(c => `
    <tr>
      <td class="comp-name">${c.name}</td>
      <td>${c.useCases.map(u => `<span style="display:inline-block;padding:1px 6px;border-radius:8px;background:#f3f4f6;color:#6b7280;font-size:10px;margin:1px 2px;">${categoryLabelsMs[u] || u}</span>`).join('')}</td>
      <td>${c.ai}</td>
      <td>${c.love}</td>
      <td>${c.complaints}</td>
      <td>${c.coverage.map(l => `<a class="ms-link-pill" href="${l.url}" target="_blank">${l.type === 'podcast' ? '🎙️' : l.type === 'video' ? '🎬' : '📄'} ${l.label}</a>`).join('')}</td>
      <td>${c.sources.map(s => `<a class="ms-link-pill" href="${s.url}" target="_blank">🔗 ${s.label}</a>`).join('')}</td>
    </tr>
  `).join('');

  // Update TLDR based on filter
  updateMsTldr();
}

function updateMsTldr() {
  const body = document.getElementById('msTldrBody');
  if (msActiveFilter === 'all') {
    body.innerHTML = `
      <div class="pa-tldr-item"><span class="pa-icon">🔴</span><span><strong>Confluence Whiteboards going GA — direct whiteboard competition.</strong> Combined with Rovo AI and Qatalog acquisition, Atlassian builds "System of Work" overlapping Miro. <a href="https://miro.com/app/board/uXjVL63U-C4=" target="_blank" style="color:var(--accent);font-size:10px;">Source: FY26 Compete Board</a></span></div>
      <div class="pa-tldr-item"><span class="pa-icon">🔴</span><span><strong>Monday.com launches autonomous AI agents.</strong> Orchestrate end-to-end processes. Projected $1.2B revenue 2025. AI tier expected within 6-9 months. <a href="https://miro.com/app/board/uXjVGUnJM-k=" target="_blank" style="color:var(--accent);font-size:10px;">Source: Compete pricing reports</a></span></div>
      <div class="pa-tldr-item"><span class="pa-icon">🟡</span><span><strong>Lucid claims "Work Acceleration Platform" with direct positioning overlap.</strong> LUMA Elevate training programs create revenue moat. <a href="https://miro.com/app/board/uXjVGYysvW4=" target="_blank" style="color:var(--accent);font-size:10px;">Source: Business Acceleration positioning</a></span></div>
      <div class="pa-tldr-item"><span class="pa-icon">🟢</span><span><strong>Miro's primary competitor is inaction, not another platform.</strong> Only workspace covering diagramming + whiteboard + roadmaps + CX mapping end-to-end. <a href="https://miro.com/app/board/uXjVGYysvW4=" target="_blank" style="color:var(--accent);font-size:10px;">Source</a></span></div>
    `;
    return;
  }
  const filterTldrs = {
    diagramming: `
      <div class="pa-tldr-item"><span class="pa-icon">🔴</span><span><strong>Lucidspark leading AI diagram generation</strong> — Auto-generating flowcharts, ERDs, and org charts from natural language. This is the #1 threat to Miro's diagramming use case.</span></div>
      <div class="pa-tldr-item"><span class="pa-icon">🟡</span><span><strong>Figma adding diagram capabilities in FigJam</strong> — Not yet as powerful as Lucid, but Figma's existing user base could shift quickly with improvements.</span></div>
      <div class="pa-tldr-item"><span class="pa-icon">💡</span><span><strong>Recommendation:</strong> Prioritise AI-powered diagram generation. Miro's current diagramming is manual — adding text-to-diagram AI would directly counter Lucid and Figma.</span></div>
    `,
    roadmaps: `
      <div class="pa-tldr-item"><span class="pa-icon">🔴</span><span><strong>Productboard and Linear excelling at roadmap management</strong> — Purpose-built roadmap tools with AI prioritisation are winning teams that previously used Miro boards for roadmapping.</span></div>
      <div class="pa-tldr-item"><span class="pa-icon">🟡</span><span><strong>Monday.com and Asana adding AI-powered roadmap views</strong> — Their existing PM user bases get roadmap features for free, reducing need for a separate tool.</span></div>
      <div class="pa-tldr-item"><span class="pa-icon">💡</span><span><strong>Recommendation:</strong> Build native prioritisation frameworks and stakeholder roadmap views. Leverage Miro's visual canvas as a differentiator over list-based tools.</span></div>
    `,
    whiteboard: `
      <div class="pa-tldr-item"><span class="pa-icon">🟡</span><span><strong>Microsoft Whiteboard + Copilot gaining enterprise traction</strong> — Free with M365, integrated in Teams. AI features via Copilot make it "good enough" for many enterprise users.</span></div>
      <div class="pa-tldr-item"><span class="pa-icon">🟡</span><span><strong>Canva Whiteboards targeting non-designer knowledge workers</strong> — Beautiful templates and ease of use attract the same "everyone is a creator" audience Miro targets.</span></div>
      <div class="pa-tldr-item"><span class="pa-icon">💡</span><span><strong>Recommendation:</strong> Emphasise Miro's depth — infinite canvas, 100+ integrations, and multi-use-case boards. Competitors have surface-level whiteboarding without the ecosystem.</span></div>
    `,
    prototyping: `
      <div class="pa-tldr-item"><span class="pa-icon">🔴</span><span><strong>Figma remains the prototyping gold standard</strong> — Auto Layout, variables, and AI component suggestions make it the default for design teams.</span></div>
      <div class="pa-tldr-item"><span class="pa-icon">🟡</span><span><strong>Framer's AI website generation is disruptive</strong> — Generating full websites from prompts appeals to teams who previously prototyped in Miro then built elsewhere.</span></div>
      <div class="pa-tldr-item"><span class="pa-icon">💡</span><span><strong>Recommendation:</strong> Miro should not compete on high-fidelity prototyping. Instead, own the "concept-to-handoff" flow where teams brainstorm and wireframe in Miro, then export to Figma.</span></div>
    `,
    project_management: `
      <div class="pa-tldr-item"><span class="pa-icon">🔴</span><span><strong>Linear winning developer-centric PM with speed</strong> — Keyboard-first, AI triage, and GitHub-native integration. Teams that try Linear rarely switch back.</span></div>
      <div class="pa-tldr-item"><span class="pa-icon">🟡</span><span><strong>Monday.com, Asana, and Notion competing for non-dev PM</strong> — Each has AI features that automate status updates, risk detection, and task assignment.</span></div>
      <div class="pa-tldr-item"><span class="pa-icon">💡</span><span><strong>Recommendation:</strong> Build deeper 2-way integrations with Jira and Linear. Position Miro as the planning layer, not a replacement PM tool.</span></div>
    `,
    customer_journey: `
      <div class="pa-tldr-item"><span class="pa-icon">🟡</span><span><strong>Smaply and UXPressia adding AI journey map generation</strong> — Both can auto-create CJMs from descriptions. Purpose-built tools offer templates and analytics Miro lacks.</span></div>
      <div class="pa-tldr-item"><span class="pa-icon">🟢</span><span><strong>Miro still preferred for collaborative CJM workshops</strong> — The real-time collaboration + infinite canvas combination remains unmatched for team-based journey mapping.</span></div>
      <div class="pa-tldr-item"><span class="pa-icon">💡</span><span><strong>Recommendation:</strong> Add CJM-specific analytics (e.g. emotion curves, pain point scoring) and AI-generated persona suggestions to close the gap with specialist tools.</span></div>
    `
  };
  body.innerHTML = filterTldrs[msActiveFilter] || '';
}

// ── Feedback Drill-Down ──
const feedbackData = {
  tables: {
    liked: {
      'Easy to use & intuitive': [
        { score: 5, text: 'Tables are super easy to create and manage. Love the column types!', date: '2026-02-04', email: 'user_a@company.com' },
        { score: 4, text: 'Very intuitive interface for building tables. Format options are powerful.', date: '2026-02-03', email: 'user_b@company.com' },
        { score: 5, text: 'Creating tables is straightforward — drag columns, set types, done.', date: '2026-02-01', email: 'user_c@company.com' },
        { score: 4, text: 'Great tool for organising project data. Simple and powerful.', date: '2026-01-30', email: null }
      ],
      'Versatile viewing options': [
        { score: 5, text: 'Love that I can switch between table, kanban, and timeline views of the same data!', date: '2026-02-05', email: 'user_d@company.com' },
        { score: 4, text: 'Multiple views are the killer feature. Kanban + table sync is amazing.', date: '2026-02-02', email: null },
        { score: 5, text: 'The different view modes make data organisation so flexible.', date: '2026-01-29', email: 'user_e@company.com' }
      ],
      'AI-assisted generation': [
        { score: 5, text: 'AI generated a perfect project tracker table from my prompt. Mind blown!', date: '2026-02-06', email: 'user_f@company.com' },
        { score: 4, text: 'AI table generation saved me 30 minutes. Great for getting started quickly.', date: '2026-01-28', email: null },
        { score: 5, text: 'Prompted "create a sprint planning table" and got exactly what I needed.', date: '2026-01-25', email: 'user_g@company.com' }
      ]
    },
    lacked: {
      'Limited text formatting': [
        { score: 2, text: 'No font colour, no cell colour, no bold headers. Trying to be Excel but not there yet.', date: '2026-02-06', email: 'user_h@company.com' },
        { score: 1, text: 'I can\'t even bold a column header? This is a basic feature. Very frustrating.', date: '2026-02-05', email: 'user_i@company.com' },
        { score: 2, text: 'Need cell background colours to highlight important rows. Without it, large tables are unreadable.', date: '2026-02-03', email: null },
        { score: 3, text: 'Formatting is too limited. At minimum need bold, italic, font colour.', date: '2026-01-31', email: 'user_j@company.com' }
      ],
      'Accidental sync/duplication': [
        { score: 1, text: 'Duplicated a frame with a table and it SYNCED my data. Lost hours of work!!!', date: '2026-02-04', email: 'user_k@company.com' },
        { score: 1, text: 'Tables sync when duplicated. This is a data loss nightmare. Please fix.', date: '2026-02-01', email: null },
        { score: 2, text: 'Copied a board and all tables were linked. Changed one, changed all. Terrible.', date: '2026-01-29', email: 'user_l@company.com' }
      ],
      'Clunky cell editing': [
        { score: 2, text: 'Have to double-click every cell to edit. So slow for data entry.', date: '2026-02-05', email: null },
        { score: 3, text: 'Date fields blocking text entry. Can\'t just type — have to use the picker.', date: '2026-02-02', email: 'user_m@company.com' },
        { score: 2, text: 'Resizing columns is painful. Text gets cut off and there\'s no auto-fit.', date: '2026-01-30', email: 'user_n@company.com' }
      ],
      'Overwhelming default templates': [
        { score: 3, text: 'Just want a blank table. Stop suggesting column names I don\'t need.', date: '2026-02-04', email: null },
        { score: 2, text: 'Default templates are confusing. Give me an empty table option first.', date: '2026-02-01', email: 'user_o@company.com' },
        { score: 3, text: 'Too many suggested columns when I create a new table. Just let me start blank.', date: '2026-01-28', email: 'user_p@company.com' }
      ]
    }
  },
  kanban_old: {
    liked: {
      'Intuitive drag-and-drop': [
        { score: 5, text: 'Such the greatest thing that i ever used, loved it!', date: '2026-02-06', email: null },
        { score: 4, text: 'Easier to navigate compared to Trello.', date: '2026-02-03', email: null },
        { score: 5, text: 'love it', date: '2026-02-04', email: null },
        { score: 4, text: 'Mit Kanban arbeiten macht Spass und ist zielführend', date: '2026-02-02', email: null }
      ],
      'Good for task tracking': [
        { score: 5, text: 'Love the idea and use it daily', date: '2026-02-03', email: null },
        { score: 4, text: 'Easy to move things around. Lots of transitioning between table view and kanban view.', date: '2026-02-05', email: null }
      ]
    },
    lacked: {
      'Card content disappearing': [
        { score: 1, text: 'the tickets disappear out of no where', date: '2026-02-07', email: null },
        { score: 1, text: 'Losing card data is a real issue, please look into it. Neither refresh, resync or whatever helped.', date: '2026-02-06', email: null },
        { score: 1, text: 'Opened this file and half of my Kanban items are now blank!', date: '2026-02-04', email: null },
        { score: 2, text: 'I return to my board often to find that certain cards are now empty. Makes the whole tool unreliable.', date: '2026-02-04', email: null },
        { score: 1, text: 'content in tickets get deleted randomly. no way of recovering them', date: '2026-02-03', email: null },
        { score: 1, text: 'Random pieces of content disappeared from the kanban records. Cannot use Miro if this continues.', date: '2026-02-03', email: null },
        { score: 2, text: 'Cards I have populated are sometimes blank when i reload the board', date: '2026-02-03', email: null },
        { score: 3, text: 'It seems to lose the title of my cards - not all of them, but the last set of changes sometimes.', date: '2026-02-04', email: null }
      ],
      'No Jira 2-way sync': [
        { score: 4, text: 'Its great but I need to be able to link it to the Jira kanban better. Currently duplication.', date: '2026-02-05', email: null },
        { score: 4, text: 'unfortunately, this template does not integrate with jira!', date: '2026-02-06', email: null }
      ],
      'Limited card customisation': [
        { score: 3, text: 'Functional, but I would love to be able to add custom fields to cards as well as images.', date: '2026-02-05', email: null },
        { score: 4, text: 'I would like sub totals of values of swim-lanes and the board level', date: '2026-02-05', email: null },
        { score: 1, text: 'Please add the option to use estimates for the counter in columns', date: '2026-02-04', email: null },
        { score: 2, text: 'Frustrating that you will not let me choose the colors of the tags', date: '2026-02-03', email: null }
      ]
    }
  },
  kanban_new: {
    liked: {
      'Cross-view sync': [
        { score: 5, text: 'The ability to switch between kanban, table, and timeline views of the same data is amazing.', date: '2026-02-05', email: null },
        { score: 4, text: 'Cross-view sync is the killer feature for our team.', date: '2026-02-03', email: null }
      ],
      'Modern UI and layout': [
        { score: 5, text: 'The new kanban looks so much cleaner. Love the updated design.', date: '2026-02-04', email: null },
        { score: 4, text: 'Improved card layout makes it easier to scan boards quickly.', date: '2026-02-02', email: null }
      ]
    },
    lacked: {
      'Missing features from old kanban': [
        { score: 1, text: 'Could you make the old version available as an option? New one has constraints the old one didn\'t.', date: '2026-02-03', email: null },
        { score: 3, text: 'Still exploring functionality, but seems to be lacking certain features for Kanban board', date: '2026-02-04', email: null }
      ],
      'Card data persistence': [
        { score: 2, text: 'I add a record and it doesn\'t always SAVE. Next time there\'s an empty box.', date: '2026-02-02', email: null },
        { score: 2, text: 'Again some data is lost (instead of seeing the actual written content, I can see "type something")', date: '2026-02-04', email: null }
      ],
      'Colour and tag limitations': [
        { score: 2, text: 'Frustrating that you will not let me choose the colors of the tags', date: '2026-02-03', email: null },
        { score: 3, text: 'Farben verändern sich mit verschieben in andere Liste -> kein Farbcode möglich', date: '2026-02-06', email: null },
        { score: 4, text: 'Die Spalten der Kanban Ansicht könnten noch farblich unterschiedlich sein', date: '2026-02-05', email: null }
      ]
    }
  },
  timeline: {
    liked: {
      'Great for visual planning': [
        { score: 5, text: 'Best tool for roadmap visualisation. Teams love estimating in weeks.', date: '2026-02-04', email: null },
        { score: 4, text: 'The visual layout helps communicate roadmaps to stakeholders effectively.', date: '2026-02-02', email: null }
      ],
      'General functionality': [
        { score: 4, text: 'Drag-to-schedule and resize is intuitive. Good core concept.', date: '2026-02-03', email: null },
        { score: 5, text: 'Great for planning sprints and releases visually.', date: '2026-01-31', email: null }
      ]
    },
    lacked: {
      'Glitchy text editing': [
        { score: 2, text: 'Text overlaps, doesn\'t match what\'s typed. Items delete unexpectedly.', date: '2026-02-05', email: null },
        { score: 1, text: 'Editing text in timeline bars is a nightmare. It jumps and overlaps.', date: '2026-02-03', email: null },
        { score: 3, text: 'Sometimes the text I write overlaps with the default text.', date: '2026-02-06', email: null }
      ],
      'No weekend hiding': [
        { score: 3, text: 'Wish I could hide weekends. Show only Mon-Fri.', date: '2026-02-04', email: null },
        { score: 2, text: 'For project planning, we need business days only. This is table stakes for Gantt tools.', date: '2026-02-01', email: null }
      ],
      'Missing custom fields': [
        { score: 2, text: 'Can\'t add team or owner fields in timeline view. Blocking our multi-team use case.', date: '2026-02-05', email: null },
        { score: 3, text: 'Wish timeline view had custom fields like the table view does.', date: '2026-02-02', email: null },
        { score: 3, text: 'Wish that the timeline view could be organized based on other fields I configured.', date: '2026-02-05', email: null }
      ],
      'Poor zoom/scroll UX': [
        { score: 2, text: 'Zoom doesn\'t work intuitively. Dragging items out of timeline can\'t be undone.', date: '2026-02-03', email: null },
        { score: 1, text: 'Navigation is frustrating. Scroll + zoom behaviour is unpredictable.', date: '2026-01-30', email: null }
      ]
    }
  }
};

function openFeedbackDrillDown(feature, theme, sentiment) {
  const featureData = feedbackData[feature];
  if (!featureData) return;
  const sentimentData = featureData[sentiment];
  if (!sentimentData) return;
  const items = sentimentData[theme];
  if (!items || items.length === 0) return;

  const featureNames = { tables: 'Tables', kanban_old: 'Kanban (Old)', kanban_new: 'Kanban (New)', timeline: 'Timeline' };
  const panel = document.getElementById('detailPanel');
  const overlay = document.getElementById('detailOverlay');

  panel.innerHTML = `
    <div class="detail-panel-header">
      <h2>${featureNames[feature]} — "${theme}"</h2>
      <button class="detail-close" onclick="closeDetail()">✕</button>
    </div>
    <div style="padding:0 24px 8px;">
      <span style="display:inline-block;padding:3px 10px;border-radius:12px;font-size:11px;font-weight:600;${sentiment === 'liked' ? 'background:#d1fae5;color:#065f46;' : 'background:#fee2e2;color:#991b1b;'}">${sentiment === 'liked' ? '👍 Positive Feedback (4-5★)' : '👎 Negative Feedback (1-3★)'}</span>
      <span style="font-size:11px;color:var(--text-muted);margin-left:8px;">${items.length} responses referenced</span>
    </div>
    <div style="padding:0 24px 24px;">
      ${items.map(item => `
        <div class="fb-drill-item ${parseFloat(item.score) >= 4 ? 'positive' : 'negative'}">
          <div class="fb-drill-meta">
            <span class="fb-drill-score ${parseFloat(item.score) >= 4 ? 'high' : 'low'}">${item.score}★</span>
            <span class="fb-drill-date">${item.date}</span>
            ${item.email ? `<span style="font-size:10px;color:var(--accent);">${item.email}</span>` : '<span style="font-size:10px;color:var(--text-muted);">Anonymous</span>'}
          </div>
          <div class="fb-drill-text">${item.text}"</div>
        </div>
      `).join('')}
    </div>
  `;

  panel.classList.add('active');
  overlay.classList.add('active');
}

// ── Init ──
renderThreats();
renderProjects();
</script>

</body>
</html>
